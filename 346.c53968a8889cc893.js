"use strict";(self.webpackChunkbluerays_alpha=self.webpackChunkbluerays_alpha||[]).push([[346],{8346:(Jp,$i,y)=>{y.r($i),y.d($i,{ListingsModule:()=>Hp});var A=y(9808),e=y(5e3),_e=y(7556),ue=y(832);function Fo(i,n){1&i&&e._UZ(0,"div")}function Qo(i,n){}function Ho(i,n){1&i&&e._UZ(0,"div")}const Xi=function(){return["/listings/submit"]};function Vo(i,n){1&i&&(e.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"h2",7),e._uU(5," List your apartment hotel holiday home guest house bed and breakfast on bluerays.co.ke "),e.qZA(),e.TgZ(6,"h5",8),e._uU(7,"Registration is free and can take as little as 15 minutes to complete \u2013 get started today"),e.qZA()(),e.TgZ(8,"div",6)(9,"div",9)(10,"h5"),e._uU(11,"Create a partner account to get started:"),e.qZA(),e.TgZ(12,"p")(13,"small"),e._uU(14,"By continuing, you agree to let Booking.com email you regarding your property registration."),e.qZA()(),e.TgZ(15,"button",10),e._uU(16,"Get Started"),e.qZA()()()()()(),e.TgZ(17,"div",11)(18,"div",12)(19,"div",5)(20,"div",6)(21,"h3"),e._uU(22,"Your peace of mind is our top priority"),e.qZA(),e.TgZ(23,"p")(24,"small"),e._uU(25,"Here\u2019s how we\u2019re helping you feel confident welcoming guests: "),e.qZA()(),e.TgZ(26,"ul")(27,"li",13)(28,"span",14),e.O4$(),e.TgZ(29,"svg",15),e._UZ(30,"path",16),e.qZA(),e._uU(31," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(32,"div",17)(33,"p"),e._uU(34,"Set "),e.TgZ(35,"strong"),e._uU(36,"house rules"),e.qZA(),e._uU(37," guest must agree to before they stay"),e.qZA()()(),e.TgZ(38,"li",13)(39,"span",14),e.O4$(),e.TgZ(40,"svg",15),e._UZ(41,"path",16),e.qZA(),e._uU(42," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(43,"div",17)(44,"p"),e._uU(45,"Request "),e.TgZ(46,"strong"),e._uU(47,"damage deposits"),e.qZA(),e._uU(48," for extra security"),e.qZA()()(),e.TgZ(49,"li",13)(50,"span",14),e.O4$(),e.TgZ(51,"svg",15),e._UZ(52,"path",16),e.qZA(),e._uU(53," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(54,"div",17)(55,"p")(56,"strong"),e._uU(57,"Report guest misconduct"),e.qZA(),e._uU(58," if something goes wrong"),e.qZA()()(),e.TgZ(59,"li",13)(60,"span",14),e.O4$(),e.TgZ(61,"svg",15),e._UZ(62,"path",16),e.qZA(),e._uU(63," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(64,"div",17)(65,"p"),e._uU(66,"Set "),e.TgZ(67,"strong"),e._uU(68,"house rules"),e.qZA(),e._uU(69," guest must agree to before they stay"),e.qZA()()(),e.TgZ(70,"li",13)(71,"span",14),e.O4$(),e.TgZ(72,"svg",15),e._UZ(73,"path",16),e.qZA(),e._uU(74," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(75,"div",17)(76,"p"),e._uU(77,"Access "),e.TgZ(78,"strong"),e._uU(79,"24/7 support"),e.qZA()()()()()(),e.TgZ(80,"div",6),e._UZ(81,"img",18),e.qZA()()()(),e.TgZ(82,"div",19)(83,"div",12)(84,"h4"),e._uU(85,"Which best describes you?"),e.qZA(),e.TgZ(86,"p"),e._uU(87,"Select one of the options to see customised information "),e.qZA(),e.TgZ(88,"div",20)(89,"div",6)(90,"div",21)(91,"div",22)(92,"div",23)(93,"div",24)(94,"div",22),e._uU(95,"I have a property that I rent out occasionally"),e.qZA()(),e.TgZ(96,"ul",25)(97,"li",13)(98,"span",26),e.O4$(),e.TgZ(99,"svg",15),e._UZ(100,"path",27),e.qZA(),e._uU(101," \xa0 "),e.qZA(),e.kcU(),e.TgZ(102,"div",17)(103,"div",28),e._uU(104,"This property is where I keep my personal belongings"),e.qZA()()(),e.TgZ(105,"li",13)(106,"span",26),e.O4$(),e.TgZ(107,"svg",15),e._UZ(108,"path",27),e.qZA(),e._uU(109," \xa0 "),e.qZA(),e.kcU(),e.TgZ(110,"div",17)(111,"div",28),e._uU(112,"I have limited experience working in the hospitality industry"),e.qZA()()()(),e.TgZ(113,"div",22)(114,"button",29),e._uU(115," Learn more "),e.qZA()()()()()(),e.TgZ(116,"div",6)(117,"div",21)(118,"div",22)(119,"div",23)(120,"div",24)(121,"div",22),e._uU(122,"I have multiple properties that I rent out year-round"),e.qZA()(),e.TgZ(123,"ul",25)(124,"li",13)(125,"span",26),e.O4$(),e.TgZ(126,"svg",15),e._UZ(127,"path",27),e.qZA(),e._uU(128," \xa0 "),e.qZA(),e.kcU(),e.TgZ(129,"div",17)(130,"div",28),e._uU(131,"These properties are primarily used for guests"),e.qZA()()(),e.TgZ(132,"li",13)(133,"span",26),e.O4$(),e.TgZ(134,"svg",15),e._UZ(135,"path",27),e.qZA(),e._uU(136," \xa0 "),e.qZA(),e.kcU(),e.TgZ(137,"div",17)(138,"div",28),e._uU(139,"I have experience working in the hospitality industry"),e.qZA()()()(),e.TgZ(140,"div",22)(141,"button",29),e._uU(142," Learn more "),e.qZA()()()()()()()()(),e.TgZ(143,"div",30)(144,"h3"),e._uU(145,"Benefits of working with us"),e.qZA(),e.TgZ(146,"div",31)(147,"div",6)(148,"div",32)(149,"div")(150,"div"),e.O4$(),e.TgZ(151,"svg",33),e._UZ(152,"path",34)(153,"path",35)(154,"path",36)(155,"path",37)(156,"path",38)(157,"path",39)(158,"path",40)(159,"path",41),e.qZA()(),e.kcU(),e._UZ(160,"div",42),e.TgZ(161,"div",43)(162,"h5"),e._uU(163,"List any type of property"),e.qZA()(),e._UZ(164,"div",44),e.TgZ(165,"div",45),e._uU(166,"Apartments to villas and everything in between can be listed for free."),e.qZA()()()(),e.TgZ(167,"div",6)(168,"div",43)(169,"div")(170,"div",46),e.O4$(),e.TgZ(171,"svg",47)(172,"g",48),e._UZ(173,"path",49)(174,"path",50)(175,"path",51)(176,"path",52)(177,"path",53),e.qZA(),e.TgZ(178,"defs")(179,"clipPath",54),e._UZ(180,"rect",55),e.qZA()()()(),e.kcU(),e._UZ(181,"div",42),e.TgZ(182,"div",43)(183,"h5"),e._uU(184,"Easily import details"),e.qZA()(),e._UZ(185,"div",44),e.TgZ(186,"div",45),e._uU(187,"To save you time, many of the details from your existing listings can be imported."),e.qZA()()()(),e.TgZ(188,"div",6)(189,"div",32)(190,"div")(191,"div",46),e.O4$(),e.TgZ(192,"svg",56),e._UZ(193,"path",57)(194,"path",58)(195,"path",59)(196,"path",60)(197,"path",61)(198,"path",62),e.qZA()(),e.kcU(),e._UZ(199,"div",42),e.TgZ(200,"div",43)(201,"h5"),e._uU(202,"Step-by-step guidance"),e.qZA()(),e._UZ(203,"div",44),e.TgZ(204,"div",45),e._uU(205,"You\u2019ll learn how our platform works, best practices, and things to watch out for."),e.qZA()()()(),e.TgZ(206,"div",6)(207,"div",32)(208,"div")(209,"div",46),e.O4$(),e.TgZ(210,"svg",63),e._UZ(211,"path",64)(212,"path",65)(213,"path",66)(214,"path",67)(215,"path",68)(216,"path",69)(217,"path",70)(218,"path",71),e.qZA()(),e.kcU(),e._UZ(219,"div",42),e.TgZ(220,"div",43)(221,"h5"),e._uU(222,"Exclusive discounts"),e.qZA()(),e._UZ(223,"div",44),e.TgZ(224,"div",45),e._uU(225,"Discounts on products and services that save time and improve guests experience."),e.qZA()()()()()()),2&i&&(e.xp6(15),e.Q6J("routerLink",e.DdM(1,Xi)))}function Jo(i,n){if(1&i&&(e.TgZ(0,"div")(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h2",7),e._uU(6),e.qZA(),e.TgZ(7,"h5",8),e._uU(8,"It can take as little as 15 minutes to finish your listing \u2013 click continue to start where you left off"),e.qZA()(),e.TgZ(9,"div",6)(10,"div",9)(11,"h5"),e._uU(12,"Continue your registration"),e.qZA(),e.TgZ(13,"p")(14,"small"),e._uU(15),e.qZA()(),e.TgZ(16,"button",10),e._uU(17,"Create new listing"),e.qZA()()()()()(),e.TgZ(18,"div",11)(19,"div",12)(20,"div",5)(21,"div",6)(22,"h3"),e._uU(23,"Your peace of mind is our top priority"),e.qZA(),e.TgZ(24,"p")(25,"small"),e._uU(26,"Here\u2019s how we\u2019re helping you feel confident welcoming guests: "),e.qZA()(),e.TgZ(27,"ul")(28,"li",13)(29,"span",14),e.O4$(),e.TgZ(30,"svg",15),e._UZ(31,"path",16),e.qZA(),e._uU(32," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(33,"div",17)(34,"p"),e._uU(35,"Set "),e.TgZ(36,"strong"),e._uU(37,"house rules"),e.qZA(),e._uU(38," guest must agree to before they stay"),e.qZA()()(),e.TgZ(39,"li",13)(40,"span",14),e.O4$(),e.TgZ(41,"svg",15),e._UZ(42,"path",16),e.qZA(),e._uU(43," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(44,"div",17)(45,"p"),e._uU(46,"Request "),e.TgZ(47,"strong"),e._uU(48,"damage deposits"),e.qZA(),e._uU(49," for extra security"),e.qZA()()(),e.TgZ(50,"li",13)(51,"span",14),e.O4$(),e.TgZ(52,"svg",15),e._UZ(53,"path",16),e.qZA(),e._uU(54," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(55,"div",17)(56,"p")(57,"strong"),e._uU(58,"Report guest misconduct"),e.qZA(),e._uU(59," if something goes wrong"),e.qZA()()(),e.TgZ(60,"li",13)(61,"span",14),e.O4$(),e.TgZ(62,"svg",15),e._UZ(63,"path",16),e.qZA(),e._uU(64," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(65,"div",17)(66,"p"),e._uU(67,"Set "),e.TgZ(68,"strong"),e._uU(69,"house rules"),e.qZA(),e._uU(70," guest must agree to before they stay"),e.qZA()()(),e.TgZ(71,"li",13)(72,"span",14),e.O4$(),e.TgZ(73,"svg",15),e._UZ(74,"path",16),e.qZA(),e._uU(75," \xa0\xa0 "),e.qZA(),e.kcU(),e.TgZ(76,"div",17)(77,"p"),e._uU(78,"Access "),e.TgZ(79,"strong"),e._uU(80,"24/7 support"),e.qZA()()()()()(),e.TgZ(81,"div",6),e._UZ(82,"img",18),e.qZA()()()(),e.TgZ(83,"div",19)(84,"div",12)(85,"h4"),e._uU(86,"Which best describes you?"),e.qZA(),e.TgZ(87,"p"),e._uU(88,"Select one of the options to see customised information "),e.qZA(),e.TgZ(89,"div",20)(90,"div",6)(91,"div",21)(92,"div",22)(93,"div",23)(94,"div",24)(95,"div",22),e._uU(96,"I have a property that I rent out occasionally"),e.qZA()(),e.TgZ(97,"ul",25)(98,"li",13)(99,"span",26),e.O4$(),e.TgZ(100,"svg",15),e._UZ(101,"path",27),e.qZA(),e._uU(102," \xa0 "),e.qZA(),e.kcU(),e.TgZ(103,"div",17)(104,"div",28),e._uU(105,"This property is where I keep my personal belongings"),e.qZA()()(),e.TgZ(106,"li",13)(107,"span",26),e.O4$(),e.TgZ(108,"svg",15),e._UZ(109,"path",27),e.qZA(),e._uU(110," \xa0 "),e.qZA(),e.kcU(),e.TgZ(111,"div",17)(112,"div",28),e._uU(113,"I have limited experience working in the hospitality industry"),e.qZA()()()(),e.TgZ(114,"div",22)(115,"button",29),e._uU(116," Learn more "),e.qZA()()()()()(),e.TgZ(117,"div",6)(118,"div",21)(119,"div",22)(120,"div",23)(121,"div",24)(122,"div",22),e._uU(123,"I have multiple properties that I rent out year-round"),e.qZA()(),e.TgZ(124,"ul",25)(125,"li",13)(126,"span",26),e.O4$(),e.TgZ(127,"svg",15),e._UZ(128,"path",27),e.qZA(),e._uU(129," \xa0 "),e.qZA(),e.kcU(),e.TgZ(130,"div",17)(131,"div",28),e._uU(132,"These properties are primarily used for guests"),e.qZA()()(),e.TgZ(133,"li",13)(134,"span",26),e.O4$(),e.TgZ(135,"svg",15),e._UZ(136,"path",27),e.qZA(),e._uU(137," \xa0 "),e.qZA(),e.kcU(),e.TgZ(138,"div",17)(139,"div",28),e._uU(140,"I have experience working in the hospitality industry"),e.qZA()()()(),e.TgZ(141,"div",22)(142,"button",29),e._uU(143," Learn more "),e.qZA()()()()()()()()(),e.TgZ(144,"div",30)(145,"h3"),e._uU(146,"Benefits of working with us"),e.qZA(),e.TgZ(147,"div",31)(148,"div",6)(149,"div",32)(150,"div")(151,"div"),e.O4$(),e.TgZ(152,"svg",33),e._UZ(153,"path",34)(154,"path",35)(155,"path",36)(156,"path",37)(157,"path",38)(158,"path",39)(159,"path",40)(160,"path",41),e.qZA()(),e.kcU(),e._UZ(161,"div",42),e.TgZ(162,"div",43)(163,"h5"),e._uU(164,"List any type of property"),e.qZA()(),e._UZ(165,"div",44),e.TgZ(166,"div",45),e._uU(167,"Apartments to villas and everything in between can be listed for free."),e.qZA()()()(),e.TgZ(168,"div",6)(169,"div",43)(170,"div")(171,"div",46),e.O4$(),e.TgZ(172,"svg",47)(173,"g",48),e._UZ(174,"path",49)(175,"path",50)(176,"path",51)(177,"path",52)(178,"path",53),e.qZA(),e.TgZ(179,"defs")(180,"clipPath",54),e._UZ(181,"rect",55),e.qZA()()()(),e.kcU(),e._UZ(182,"div",42),e.TgZ(183,"div",43)(184,"h5"),e._uU(185,"Easily import details"),e.qZA()(),e._UZ(186,"div",44),e.TgZ(187,"div",45),e._uU(188,"To save you time, many of the details from your existing listings can be imported."),e.qZA()()()(),e.TgZ(189,"div",6)(190,"div",32)(191,"div")(192,"div",46),e.O4$(),e.TgZ(193,"svg",56),e._UZ(194,"path",57)(195,"path",58)(196,"path",59)(197,"path",60)(198,"path",61)(199,"path",62),e.qZA()(),e.kcU(),e._UZ(200,"div",42),e.TgZ(201,"div",43)(202,"h5"),e._uU(203,"Step-by-step guidance"),e.qZA()(),e._UZ(204,"div",44),e.TgZ(205,"div",45),e._uU(206,"You\u2019ll learn how our platform works, best practices, and things to watch out for."),e.qZA()()()(),e.TgZ(207,"div",6)(208,"div",32)(209,"div")(210,"div",46),e.O4$(),e.TgZ(211,"svg",63),e._UZ(212,"path",64)(213,"path",65)(214,"path",66)(215,"path",67)(216,"path",68)(217,"path",69)(218,"path",70)(219,"path",71),e.qZA()(),e.kcU(),e._UZ(220,"div",42),e.TgZ(221,"div",43)(222,"h5"),e._uU(223,"Exclusive discounts"),e.qZA()(),e._UZ(224,"div",44),e.TgZ(225,"div",45),e._uU(226,"Discounts on products and services that save time and improve guests experience."),e.qZA()()()()()()()),2&i){const t=n.ngIf;e.xp6(6),e.hij("Welcome back, ",t.displayName?t.displayName:"User","!"),e.xp6(9),e.hij("Welcome back, ",t.displayName?t.displayName:"User","!"),e.xp6(1),e.Q6J("routerLink",e.DdM(3,Xi))}}function Bo(i,n){if(1&i&&e.YNc(0,Jo,227,4,"div",72),2&i){const t=e.oxw(2);e.Q6J("ngIf",t.auth.userData)}}function Yo(i,n){if(1&i&&(e.YNc(0,Ho,1,0,"div",0),e.YNc(1,Vo,226,2,"ng-template",null,1,e.W1O),e.YNc(3,Bo,1,1,"ng-template",null,2,e.W1O)),2&i){const t=e.MAs(2),s=e.MAs(4),r=e.oxw();e.Q6J("ngIf",r.auth.userData)("ngIfThen",s)("ngIfElse",t)}}let Wo=(()=>{class i{constructor(t){this.auth=t}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-submit-page"]],decls:5,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["guest",""],["authenticated",""],[1,"container-fluid",2,"background-color","var(--primary-color)","padding","4%"],[1,"container",2,"margin-top","6%"],[1,"row"],[1,"col-sm-6"],[1,"text-white"],[2,"color","rgba(255, 255, 255, 0.7)"],[1,"container",2,"padding","8%","background-color","white"],[1,"btn-custom","secondary","btn-block",3,"routerLink"],[1,"container-fluid",2,"padding","4%"],[1,"container",2,"margin-top","4%","margin-bottom","4%"],[1,"c48582237a"],["aria-hidden","true",1,"_5de06ae076","_41041a1325","_6a88ad9f58",2,"float","left"],["viewBox","0 0 128 128","width","2em","height","2em"],["d","M94.8 41.2a4 4 0 0 1 0 5.6l-40 40a4 4 0 0 1-5.6 0l-16-16a4 4 0 0 1 5.6-5.6L52 78.3l37.2-37.1a4 4 0 0 1 5.6 0zM120 64A56 56 0 1 1 64 8a56 56 0 0 1 56 56zm-8 0a48 48 0 1 0-48 48 48 48 0 0 0 48-48z"],[1,"_28b5d9e97b"],["src","./../../../../assets/peace-of-mind.73a348df.svg","alt","","srcset",""],[1,"container-fluid",2,"padding","4%","background-color","rgb(245, 245, 245)"],[1,"row",2,"margin-top","4%","margin-bottom","4%"],[1,"_9c4f0c55c0","_46df920f8a","b67d85f9d5"],[1,""],[1,"b777be90c1","cc4895f9bf","a4967e82ff"],[1,"a7803fddf7"],[1,"_0a1c57676b","dd1b8734ed"],["aria-hidden","true",1,"_5de06ae076","_41041a1325","b357992faa","_76f2580457",2,"float","left"],["d","M52 96a4 4 0 0 1-2.8-1.2l-24-24a4 4 0 0 1 5.6-5.6L52 86.3l45.2-45.1a4 4 0 1 1 5.6 5.6l-48 48A4 4 0 0 1 52 96z"],[1,"_6b55668b2c"],["target","_blank",1,"btn-sm","btn-custom"],[1,"container",2,"margin-top","6%","margin-bottom","6%"],[1,"row",2,"margin-top","2%","margin-bottom","2%"],[2,"margin-top","12%"],["width","150","height","50","viewBox","0 0 150 50","fill","none","xmlns","http://www.w3.org/2000/svg","aria-hidden","true","focusable","false"],["d","M24.25 40.4C32.0703 40.4 38.41 34.0603 38.41 26.24C38.41 18.4196 32.0703 12.08 24.25 12.08C16.4296 12.08 10.09 18.4196 10.09 26.24C10.09 34.0603 16.4296 40.4 24.25 40.4Z","fill","#031E55"],["d","M7.53999 42.44C4.89247 39.7015 2.95769 36.3549 1.90547 32.6941C0.853258 29.0333 0.715791 25.1701 1.50514 21.4437C2.29448 17.7174 3.98651 14.2418 6.43268 11.322C8.87885 8.40221 12.0044 6.12756 15.5349 4.69771C19.0653 3.26786 22.8929 2.72654 26.6814 3.12126C30.4699 3.51598 34.1037 4.83467 37.2636 6.96158C40.4235 9.08849 43.013 11.9586 44.8048 15.3199C46.5965 18.6812 47.5357 22.431 47.54 26.24","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M24.25 49.5C20.413 49.512 16.6331 48.5705 13.25 46.76","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M88.36 12.09H60.04V40.41H88.36V12.09Z","fill","#FF870A"],["d","M123.3 12.09L106.96 40.41H139.65L123.3 12.09Z","fill","#BED1F8"],["d","M141.54 8.93997L144.75 5.83997","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M144.59 16.91L149.04 16.99","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M133.76 5.46L133.83 1","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],[1,"bui-spacer--large"],[2,"margin-top","5%"],[1,"bui-spacer--medium"],[1,"_6250f4fee8"],[1,"_0b9da112f9"],["width","95","height","88","viewBox","0 0 95 88","fill","none","xmlns","http://www.w3.org/2000/svg","aria-hidden","true","focusable","false"],["clip-path","url(#clip-svg-alongside-other-ota)"],["d","M43.34 1.91003C41.9752 2.38443 40.6396 2.93872 39.34 3.57003","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M44.2599 48.21C40.34 48.38 37.5099 50.11 36.8499 54.3C36.6236 55.5344 36.7612 56.8081 37.2459 57.9657C37.7306 59.1234 38.5416 60.1151 39.58 60.82C42.7 63.11 45.8299 62.82 48.6899 60.45L53.83 74.59H54.2299C53.9199 74.74 53.6199 74.91 53.2999 75.03L19.2999 87.59C18.0099 88.06 17.2999 87.72 16.7999 86.39C15.4 82.63 14.01 78.8666 12.63 75.1C12.5062 74.6589 12.4061 74.2116 12.33 73.76C8.87995 76.42 5.50995 77 2.26995 74C1.27403 73.1196 0.559764 71.9651 0.216487 70.6809C-0.12679 69.3968 -0.0838456 68.0399 0.339951 66.78C1.33995 63.2 4.09995 61.92 7.69995 61.78C7.55995 61.36 7.45995 61 7.32995 60.64L3.15995 49.38C2.60995 47.88 2.91995 47.22 4.39995 46.67L14.22 43C14.58 42.87 14.93 42.71 15.42 42.5C13.42 39.84 12.68 37.04 14.22 34.04C14.6764 33.168 15.3156 32.4049 16.0939 31.8025C16.8722 31.2002 17.7714 30.773 18.7299 30.55C22.1299 29.64 27.52 31.65 27.59 38.05L39 33.92L44.2599 48.21Z","fill","#BED1F8"],["d","M82.16 64.52C84.79 67.83 85.0699 71.15 82.4299 74.35C81.5745 75.4438 80.3968 76.2409 79.0634 76.6286C77.73 77.0162 76.3085 76.9747 74.9999 76.51C71.4499 75.51 69.9999 72.82 69.9999 69.11C69.5799 69.24 69.2399 69.32 68.9199 69.44L59.5499 73C57.9699 73.58 58.2299 73.6 57.6999 72.19C55.8999 67.3967 54.1066 62.5967 52.3199 57.79C52.2381 57.5378 52.1412 57.2907 52.0299 57.05C51.9426 56.8166 51.7984 56.6087 51.6105 56.445C51.4226 56.2812 51.1969 56.1669 50.9537 56.1123C50.7105 56.0578 50.4576 56.0646 50.2178 56.1323C49.9779 56.2 49.7587 56.3264 49.5799 56.5C48.9299 57.01 48.3299 57.57 47.6999 58.09C47.029 58.6936 46.1856 59.0714 45.2885 59.1701C44.3914 59.2688 43.486 59.0834 42.6999 58.64C41.821 58.0955 41.1619 57.2589 40.8382 56.277C40.5146 55.295 40.547 54.2304 40.9299 53.27C41.2237 52.5629 41.7185 51.9575 42.3532 51.5291C42.9878 51.1007 43.7343 50.868 44.4999 50.86C45.3199 50.78 46.1399 50.78 46.9599 50.75C48.8399 50.67 49.3899 49.84 48.7199 48.04L44.3499 36.46C43.9299 35.35 43.5499 34.23 43.0899 33.13C42.8299 32.52 42.9199 32.21 43.5899 31.96C55.1033 27.6734 66.6133 23.3534 78.1199 19C78.3412 18.8794 78.5873 18.8117 78.8391 18.8022C79.0909 18.7927 79.3415 18.8417 79.5711 18.9454C79.8008 19.0491 80.0033 19.2046 80.1627 19.3997C80.3221 19.5949 80.4341 19.8243 80.4899 20.07C82.3099 24.87 84.1066 29.6834 85.8799 34.51C86.3899 35.9 85.7499 36.76 84.2699 36.84C83.3499 36.84 82.4299 36.9 81.5099 36.97C80.6613 36.978 79.8389 37.2654 79.1701 37.7878C78.5012 38.3103 78.0232 39.0386 77.8099 39.86C77.5786 40.655 77.5892 41.5008 77.8403 42.2898C78.0914 43.0787 78.5717 43.775 79.2199 44.29C79.8683 44.838 80.6715 45.1701 81.5176 45.24C82.3636 45.3099 83.2104 45.1142 83.9399 44.68C84.804 44.0826 85.6321 43.4348 86.4199 42.74C87.6499 41.74 88.6599 41.96 89.2099 43.4C91.0433 48.2134 92.8433 53.0267 94.6099 57.84C94.7245 58.0635 94.786 58.3104 94.7894 58.5615C94.7929 58.8126 94.7382 59.0611 94.6298 59.2876C94.5214 59.5141 94.3621 59.7125 94.1644 59.8673C93.9667 60.0221 93.7359 60.1291 93.4899 60.18C90.0999 61.51 86.6999 62.77 83.3099 64L82.16 64.52Z","fill","#FF870A"],["d","M88.45 23.46C94.41 18 93.84 7 86.59 3.12C79.34 -0.760004 69.29 0.709997 64.05 7.17C62.801 8.56817 62.0764 10.3567 62 12.23C62 14.1 63.39 16.03 65.25 16.18C67.71 16.37 70.01 9.66 65.25 5.92C61.16 2.78 56 -0.200003 48.75 0.649997","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M50.5099 65.46C49.882 65.9156 49.2124 66.3107 48.5099 66.64C45.6162 67.8887 42.3494 67.9591 39.4046 66.8361C36.4598 65.7132 34.0693 63.4856 32.7417 60.6271C31.4141 57.7687 31.2542 54.5051 32.296 51.5306C33.3378 48.5561 35.499 46.1054 38.3199 44.7C39.6472 44.0774 41.0777 43.7045 42.5399 43.6","stroke","#91B0F2","stroke-linecap","round","stroke-linejoin","round"],["id","clip-svg-alongside-other-ota"],["width","94.78","height","87.77","fill","white"],["width","126","height","52","viewBox","0 0 126 52","fill","none","xmlns","http://www.w3.org/2000/svg","aria-hidden","true","focusable","false"],["d","M33.66 34.6135H2C0.89543 34.6135 0 35.509 0 36.6135V49.3235C0 50.4281 0.89543 51.3235 2 51.3235H33.66C34.7646 51.3235 35.66 50.4281 35.66 49.3235V36.6135C35.66 35.509 34.7646 34.6135 33.66 34.6135Z","fill","#BED1F8"],["d","M78.37 34.6135H46.71C45.6054 34.6135 44.71 35.509 44.71 36.6135V49.3235C44.71 50.4281 45.6054 51.3235 46.71 51.3235H78.37C79.4745 51.3235 80.37 50.4281 80.37 49.3235V36.6135C80.37 35.509 79.4745 34.6135 78.37 34.6135Z","fill","#031E55"],["d","M123.19 34.6135H91.53C90.4255 34.6135 89.53 35.509 89.53 36.6135V49.3235C89.53 50.4281 90.4255 51.3235 91.53 51.3235H123.19C124.295 51.3235 125.19 50.4281 125.19 49.3235V36.6135C125.19 35.509 124.295 34.6135 123.19 34.6135Z","fill","#FF870A"],["d","M93.15 4.67358C97.83 7.67358 101.09 11.8836 102.05 16.6736","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M20.62 15.8636C32.06 -4.37636 55.74 2.11364 58.58 3.48364C62.28 5.23364 65.79 7.77364 67.15 11.6236C67.58 12.8436 67.76 14.3636 66.82 15.2536C65.54 16.4736 63.19 15.2536 62.82 13.4736C62.45 11.6936 63.45 10.0236 64.57 8.64364C67.599 5.07651 71.7014 2.58577 76.2636 1.5439C80.8258 0.50203 85.6028 0.965024 89.88 2.86364","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["d","M104.29 10.0137L102.05 16.6837L96.16 12.8337","stroke","#031E55","stroke-linecap","round","stroke-linejoin","round"],["width","90","height","77","viewBox","0 0 90 77","fill","none","xmlns","http://www.w3.org/2000/svg","aria-hidden","true","focusable","false"],["d","M1.81013 54C0.894162 53.3486 0.2743 52.3602 0.0867848 51.252C-0.10073 50.1438 0.159448 49.0064 0.810134 48.09L29.5001 7.08998C29.8676 6.5655 30.3492 6.13108 30.9086 5.81933C31.468 5.50758 32.0908 5.3266 32.7301 5.28998L57.3801 3.83998C58.3191 3.78952 59.2474 4.05863 60.0137 4.60344C60.7801 5.14824 61.3393 5.93661 61.6001 6.83998L68.6601 30.5C68.8423 31.1136 68.8839 31.7604 68.7818 32.3923C68.6796 33.0242 68.4364 33.625 68.0701 34.15L39.3801 75.15C38.7269 76.0666 37.7368 76.6867 36.6269 76.8742C35.5171 77.0616 34.3782 76.8012 33.4601 76.15L1.81013 54Z","fill","#C4D1F4"],["d","M52.0901 19.6301C54.1612 19.6301 55.8401 17.9512 55.8401 15.8801C55.8401 13.8091 54.1612 12.1301 52.0901 12.1301C50.019 12.1301 48.3401 13.8091 48.3401 15.8801C48.3401 17.9512 50.019 19.6301 52.0901 19.6301Z","fill","white"],["d","M54.2602 12.8C48.2202 10 62.5302 0.230048 74.7702 0.510048C84.1602 0.720048 87.7702 7.44005 88.3802 9.06005C89.6502 12.19 86.8002 17.35 73.0502 11.24C65.3302 7.80005 62.8902 10.24 62.8902 10.24","stroke","#042D81","stroke-linecap","round","stroke-linejoin","round"],["d","M34.8801 40.4601C31.2697 37.9279 27.181 36.1581 22.8638 35.2589C18.5465 34.3597 14.0913 34.3499 9.77009 35.2301L0.770095 48.0801C0.119409 48.9966 -0.140769 50.1339 0.0467458 51.2421C0.23426 52.3503 0.854123 53.3387 1.77009 53.9901L33.4601 76.1601C34.3781 76.8113 35.517 77.0718 36.6269 76.8843C37.7367 76.6968 38.7269 76.0767 39.3801 75.1601L48.3801 62.3001C47.7339 57.9328 46.2033 53.7434 43.882 49.9881C41.5608 46.2328 38.4976 42.9907 34.8801 40.4601Z","fill","#FF870A"],["d","M49.2701 45.0891C50.1737 36.0537 43.5994 27.9984 34.5861 27.0971C25.5729 26.1957 17.5337 32.7897 16.6301 41.8251C15.7266 50.8604 22.3009 58.9157 31.3141 59.8171C40.3274 60.7184 48.3666 54.1244 49.2701 45.0891Z","fill","white"],["d","M22.3701 46.3801C22.2209 46.2769 22.0936 46.1451 21.9958 45.9923C21.8979 45.8395 21.8314 45.6688 21.8001 45.4901C21.7388 45.1324 21.821 44.7649 22.0287 44.4673C22.2365 44.1697 22.5531 43.9659 22.9101 43.9001L42.0001 40.5401C42.3494 40.4782 42.709 40.5573 43.0001 40.7601C43.2961 40.972 43.4971 41.2916 43.5601 41.6501C43.6158 42.0007 43.5334 42.3592 43.3301 42.6501C43.1224 42.9477 42.8066 43.1523 42.4501 43.2201L23.3901 46.6001C23.2141 46.6353 23.0327 46.6339 22.8572 46.5961C22.6818 46.5582 22.5159 46.4847 22.3701 46.3801Z","fill","#031E55"],["d","M28.0001 33.5699C27.5333 34.2351 27.2742 35.0238 27.2555 35.8362C27.2368 36.6486 27.4593 37.4483 27.895 38.1343C28.3307 38.8203 28.9599 39.3617 29.7032 39.6901C30.4465 40.0186 31.2705 40.1193 32.071 39.9796C32.8715 39.8399 33.6127 39.466 34.2008 38.9052C34.7889 38.3444 35.1975 37.6219 35.3751 36.8289C35.5526 36.0359 35.4911 35.208 35.1984 34.45C34.9056 33.6919 34.3946 33.0377 33.7301 32.5699C32.8362 31.9472 31.7324 31.7028 30.6592 31.8901C29.586 32.0774 28.6302 32.6812 28.0001 33.5699ZM30.2501 35.1499C30.4054 34.9281 30.6229 34.7572 30.8752 34.6589C31.1276 34.5605 31.4034 34.5392 31.6678 34.5976C31.9323 34.6559 32.1735 34.7913 32.361 34.9867C32.5485 35.1821 32.6739 35.4287 32.7214 35.6953C32.7689 35.9619 32.7362 36.2366 32.6277 36.4847C32.5191 36.7328 32.3394 36.9431 32.1113 37.0891C31.8833 37.2352 31.6171 37.3103 31.3463 37.3051C31.0755 37.2999 30.8124 37.2146 30.5901 37.0599C30.2903 36.8534 30.0843 36.5368 30.0168 36.1791C29.9494 35.8213 30.0261 35.4514 30.2301 35.1499H30.2501Z","fill","#031E55","fill-rule","evenodd","clip-rule","evenodd"],["d","M30.68 48.85C30.2133 49.5151 29.9541 50.3038 29.9354 51.1162C29.9167 51.9286 30.1392 52.7283 30.5749 53.4143C31.0106 54.1003 31.6398 54.6417 32.3831 54.9702C33.1264 55.2986 33.9504 55.3993 34.7509 55.2596C35.5515 55.1199 36.2926 54.746 36.8807 54.1852C37.4688 53.6244 37.8775 52.9019 38.055 52.1089C38.2326 51.3159 38.1711 50.488 37.8783 49.73C37.5855 48.9719 37.0746 48.3177 36.41 47.85C35.517 47.2246 34.4125 46.9787 33.3384 47.1661C32.2644 47.3535 31.3085 47.959 30.68 48.85ZM32.92 50.42C33.0753 50.1981 33.2928 50.0272 33.5452 49.9289C33.7975 49.8306 34.0733 49.8092 34.3378 49.8676C34.6022 49.9259 34.8434 50.0614 35.0309 50.2567C35.2185 50.4521 35.3439 50.6987 35.3913 50.9653C35.4388 51.2319 35.4062 51.5066 35.2976 51.7547C35.189 52.0028 35.0093 52.2131 34.7813 52.3592C34.5532 52.5052 34.287 52.5803 34.0162 52.5752C33.7455 52.57 33.4823 52.4846 33.26 52.33C33.1121 52.227 32.986 52.0959 32.8888 51.9442C32.7916 51.7924 32.7253 51.6229 32.6937 51.4455C32.6622 51.2681 32.6659 51.0862 32.7047 50.9102C32.7436 50.7342 32.8167 50.5676 32.92 50.42Z","fill","#031E55","fill-rule","evenodd","clip-rule","evenodd"],[4,"ngIf"]],template:function(t,s){if(1&t&&(e.YNc(0,Fo,1,0,"div",0),e.YNc(1,Qo,0,0,"ng-template",null,1,e.W1O),e.YNc(3,Yo,5,3,"ng-template",null,2,e.W1O)),2&t){const r=e.MAs(2),o=e.MAs(4);e.Q6J("ngIf",s.auth.userData)("ngIfThen",o)("ngIfElse",r)}},directives:[A.O5,ue.rH],styles:[""]}),i})();var st=y(5240),zo=y(3577),xn=y.n(zo),E=y(6955),h=y(2382),Sn=y(3009),es=y(6180);function Go(i,n){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&i){const t=e.oxw().results;e.xp6(1),e.hij(" No results have been found for ",null==t?null:t.query,". ")}}function jo(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(r){return e.CHM(t),e.oxw().showPrevious(r)}),e._uU(1," Show previous "),e.qZA()}}const En=function(i){return["/listings/details",i]};function Ko(i,n){if(1&i&&(e.TgZ(0,"div",48)(1,"div",49)(2,"div",50)(3,"a",51),e._UZ(4,"img",52),e.qZA(),e.TgZ(5,"div",53)(6,"span",54),e._UZ(7,"i",55),e.qZA(),e.TgZ(8,"span",56),e._uU(9," Pending"),e.qZA()(),e.TgZ(10,"div",57)(11,"a",58),e._UZ(12,"i",59),e.qZA(),e.TgZ(13,"a",60),e._UZ(14,"i",61),e.qZA()()(),e.TgZ(15,"div",62)(16,"div",63),e._UZ(17,"img",64),e.TgZ(18,"div",65)(19,"p")(20,"a",7),e._UZ(21,"ais-highlight",66),e.qZA()(),e.TgZ(22,"span",67),e._uU(23),e.ALo(24,"date"),e.qZA()(),e._uU(25," \xa0 "),e.TgZ(26,"div",68)(27,"a",69),e._UZ(28,"i",70),e.qZA(),e.TgZ(29,"div",71)(30,"ul")(31,"li")(32,"a",72),e._UZ(33,"i",73),e._uU(34," Call Agent"),e.qZA()(),e.TgZ(35,"li")(36,"a",72),e._UZ(37,"i",74),e._uU(38," Send Message"),e.qZA()(),e.TgZ(39,"li")(40,"a",75),e._UZ(41,"i",76),e._uU(42," Book Tour"),e.qZA()()()()()(),e.TgZ(43,"h5",77)(44,"a",78),e._UZ(45,"ais-highlight",79),e.qZA()(),e.TgZ(46,"span",80),e._uU(47),e.ALo(48,"currency"),e.qZA(),e.TgZ(49,"p",81),e._UZ(50,"ais-highlight",82),e.qZA(),e.TgZ(51,"div",83)(52,"div",84),e._UZ(53,"i",85),e.TgZ(54,"span",86),e._uU(55),e.qZA()(),e.TgZ(56,"div",87),e._UZ(57,"i",88),e.TgZ(58,"span",86),e._uU(59),e.qZA()(),e.TgZ(60,"div",89),e._UZ(61,"i",90),e.TgZ(62,"span",86),e._uU(63),e.ALo(64,"number"),e.qZA()()(),e.TgZ(65,"div",91)(66,"a",92),e._uU(67,"View Details"),e.qZA(),e.TgZ(68,"a",93),e._UZ(69,"i",94),e.qZA()()()()()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("routerLink",e.VKq(23,En,t.objectID)),e.xp6(1),e.Q6J("src",null==t.gallery[0]?null:t.gallery[0].url,e.LSH),e.xp6(13),e.Q6J("src",t.uploader_photoURL,e.LSH),e.xp6(4),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(24,15,1e3*t.uploaded._seconds,"medium")),e.xp6(9),e.s9C("href","tel:"+t.phone,e.LSH),e.xp6(4),e.s9C("href","mailto:"+t.email,e.LSH),e.xp6(8),e.Q6J("routerLink",e.VKq(25,En,t.objectID)),e.xp6(1),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(48,18,t.price,"KES ")),e.xp6(3),e.Q6J("hit",t),e.xp6(5),e.Oqu(t.beds),e.xp6(4),e.Oqu(t.bathrooms),e.xp6(4),e.hij("",e.lcZ(64,21,t.size)," Sqft"),e.xp6(3),e.Q6J("routerLink",e.VKq(27,En,t.objectID))}}const $o=function(){return{label:"All"}},Xo=function(){return{end:1e6,label:"less than 1m"}},ea=function(){return{start:1e6,end:5e6,label:"Kes. 1m - Kes. 5m"}},ta=function(){return{start:5e6,end:2e7,label:"Kes.  5m - Kes. 20m"}},na=function(){return{start:2e7,end:4e7,label:"Kes. 20m - Kes. 40m"}},ia=function(){return{start:4e7,end:6e7,label:"Kes. 40m - Kes. 60m"}},sa=function(){return{start:6e7,end:8e7,label:"Kes. 60m - Kes. 80m"}},ra=function(){return{start:8e7,end:1e8,label:"Kes. 80m - Kes. 100m"}},oa=function(){return{start:1e8,label:"more than Kes. 100"}},aa=function(i,n,t,s,r,o,a,l,c){return[i,n,t,s,r,o,a,l,c]},la=function(){return["/listings"]},ca=function(){return["/listings/list"]},ua=function(){return["/listings/map"]};function da(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16),e._UZ(2,"ais-stats"),e.qZA(),e.YNc(3,Go,2,1,"div",17),e.TgZ(4,"div",18)(5,"div",19)(6,"div",20)(7,"div",21)(8,"div",22)(9,"h4",23),e._uU(10,"Filter Listings"),e.qZA()(),e.TgZ(11,"div",24)(12,"div",25)(13,"form")(14,"div",26)(15,"div",27)(16,"h6",23),e._uU(17,"County"),e.qZA(),e._UZ(18,"hr",28)(19,"ais-refinement-list",29),e.qZA()(),e.TgZ(20,"div",15)(21,"h6",23),e._uU(22,"Price Range"),e.qZA(),e._UZ(23,"hr",28)(24,"ais-numeric-menu",30),e.qZA(),e.TgZ(25,"div",26)(26,"div",31)(27,"h6",23),e._uU(28,"Neighbourhood"),e.qZA(),e._UZ(29,"hr",28)(30,"ais-menu",32),e.qZA(),e.TgZ(31,"div",31)(32,"h6",23),e._uU(33,"Type of house"),e.qZA(),e._UZ(34,"hr",28)(35,"ais-menu",33),e.qZA()()()()()(),e.TgZ(36,"div",21)(37,"div",22)(38,"h5"),e._uU(39,"Recent Listing"),e.qZA(),e.TgZ(40,"div",34),e._UZ(41,"span")(42,"span"),e.qZA()(),e.TgZ(43,"div",24),e._UZ(44,"app-recent-listings-sm"),e.qZA()(),e.TgZ(45,"div",21)(46,"div",22)(47,"h5"),e._uU(48,"Mortgage Calculator"),e.qZA()(),e.TgZ(49,"div",24),e._UZ(50,"app-mortgage"),e.qZA()()()(),e.TgZ(51,"div",35)(52,"div",36)(53,"div",37),e._UZ(54,"ais-current-refinements"),e.qZA(),e.TgZ(55,"div",38)(56,"a",39),e._UZ(57,"i",40),e.qZA(),e.TgZ(58,"a",41),e._UZ(59,"i",42),e.qZA(),e.TgZ(60,"a",43),e._UZ(61,"i",44),e.qZA()()(),e.YNc(62,jo,2,0,"button",45),e.TgZ(63,"div",26),e.YNc(64,Ko,70,29,"div",46),e.qZA(),e.TgZ(65,"button",47),e.NdJ("click",function(r){return e.CHM(t).showNext(r)}),e._uU(66," Show more "),e.qZA()()()()}if(2&i){const t=n.hits;e.xp6(3),e.Q6J("ngIf",0===t.length),e.xp6(16),e.Q6J("limit",7)("showMoreLimit",10)("searchable",!1)("autoHideContainer",!0),e.xp6(5),e.Q6J("items",e.rFY(23,aa,[e.DdM(14,$o),e.DdM(15,Xo),e.DdM(16,ea),e.DdM(17,ta),e.DdM(18,na),e.DdM(19,ia),e.DdM(20,sa),e.DdM(21,ra),e.DdM(22,oa)]))("autoHideContainer",!0),e.xp6(6),e.Q6J("autoHideContainer",!0),e.xp6(5),e.Q6J("autoHideContainer",!0),e.xp6(21),e.Q6J("routerLink",e.DdM(33,la)),e.xp6(2),e.Q6J("routerLink",e.DdM(34,ca)),e.xp6(2),e.Q6J("routerLink",e.DdM(35,ua)),e.xp6(2),e.Q6J("ngIf",t.length>8),e.xp6(2),e.Q6J("ngForOf",t)}}const ha=function(){return{hitsPerPage:10}};let fa=(()=>{class i{constructor(){this.config={indexName:"listings",searchClient:xn()("MS0SDRBX0K","d7d2fa3a66a52e49a90150f5f632ebf2")}}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-grid"]],decls:20,vars:3,consts:[[1,"subheader","bg-cover","bg-center","dark-overlay",2,"background-image","url('./../../../../assets/img/pexels-terje-sollie-298842.jpg')"],[1,"container"],[1,"subheader-inner"],[1,"text-white"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"fas","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"section"],[3,"config"],["placeholder","Enter an address, neighbourhood, city or any property details"],["showPreviousLabel","Show previous results","showMoreLabel","Show more results"],[3,"searchParameters"],[2,"margin-top","4%"],[2,"margin-bottom","2%"],[4,"ngIf"],[1,"row"],[1,"col-lg-4"],[1,"sidebar","sidebar-left"],[1,"sidebar-widget"],[1,"acr-collapse-trigger","acr-custom-chevron-wrapper"],[2,"margin-bottom","0%"],[1,"acr-collapsable"],[1,"acr-filter-form"],[1,"row",2,"margin-top","4%"],[1,"col-12"],[2,"margin","0%","height","1px","width","100%"],["attribute","county","operator","and","showMoreLabel","show more","showLessLabel","show less","searchPlaceholder","County",3,"limit","showMoreLimit","searchable","autoHideContainer"],["attribute","price",3,"items","autoHideContainer"],[1,"col-6"],["attribute","neighbourhood",3,"autoHideContainer"],["attribute","type",3,"autoHideContainer"],[1,"acr-custom-chevron"],[1,"col-lg-8"],[1,"acr-global-listing-controls"],[1,"acr-listing-active-filters"],[1,"acr-toggle-views"],["data-toggle","tooltip","title","Grid",1,"active",3,"routerLink"],[1,"fas","fa-th-large"],["data-toggle","tooltip","title","List",3,"routerLink"],[1,"fas","fa-th-list"],["data-toggle","tooltip","title","Map",3,"routerLink"],[1,"fas","fa-map"],["class","btn-sm btn-custom",3,"click",4,"ngIf"],["class","col-md-6",4,"ngFor","ngForOf"],[1,"btn-sm","btn-custom",3,"click"],[1,"col-md-6"],[1,"listing"],[1,"listing-thumbnail"],[3,"routerLink"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","listing",3,"src"],[1,"listing-badges"],[1,"listing-badge","featured"],[1,"fas","fa-star"],[1,"listing-badge","pending"],[1,"listing-controls"],["href","#",1,"favorite"],[1,"far","fa-heart"],["href","#",1,"compare"],[1,"fas","fa-sync-alt"],[1,"listing-body"],[1,"listing-author"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","author",3,"src"],[1,"listing-author-body"],["attribute","uploader_displayName",3,"hit"],[1,"listing-date"],[1,"dropdown","options-dropdown"],["href","#","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-menu","dropdown-menu-right"],[3,"href"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],["href","listing-details-v1.html"],[1,"fas","fa-bookmark"],[1,"listing-title"],["title","hit.name",3,"routerLink"],["attribute","name",3,"hit"],[1,"listing-price"],[1,"listing-text","ellipsis3"],["attribute","description",3,"hit"],[1,"acr-listing-icons"],["data-toggle","tooltip","title","Beds",1,"acr-listing-icon"],[1,"flaticon-bedroom"],[1,"acr-listing-icon-value"],["data-toggle","tooltip","title","Bathrooms",1,"acr-listing-icon"],[1,"flaticon-bathroom"],["data-toggle","tooltip","title","Square Feet",1,"acr-listing-icon"],[1,"flaticon-ruler"],[1,"listing-gallery-wrapper"],[1,"btn-custom","btn-sm","secondary",3,"routerLink"],["href","#","data-toggle","tooltip","title","Gallery",1,"listing-gallery"],[1,"fas","fa-camera"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Our Listings"),e.qZA(),e.TgZ(5,"nav",4)(6,"ol",5)(7,"li",6)(8,"a",7),e._UZ(9,"i",8),e.qZA()(),e.TgZ(10,"li",9)(11,"a",7),e._uU(12,"Listings"),e.qZA()()()()()()(),e.TgZ(13,"div",10)(14,"div",1)(15,"ais-instantsearch",11),e._UZ(16,"ais-search-box",12),e.TgZ(17,"ais-infinite-hits",13),e._UZ(18,"ais-configure",14),e.YNc(19,da,67,36,"ng-template"),e.qZA()()()()),2&t&&(e.xp6(15),e.Q6J("config",s.config),e.xp6(3),e.Q6J("searchParameters",e.DdM(2,ha)))},directives:[E.Lc,E.Ut,E.A3,E.rX,E.ab,A.O5,h._Y,h.JL,E.N6,E.vM,E.x0,Sn.e,es.x,E.ye,ue.yS,A.sg,E.Yi],pipes:[A.uU,A.H9,A.JJ],styles:[""]}),i})();function pa(i,n){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&i){const t=e.oxw().results;e.xp6(1),e.hij(" No results have been found for ",null==t?null:t.query,". ")}}function ga(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(r){return e.CHM(t),e.oxw().showPrevious(r)}),e._uU(1," Show previous "),e.qZA()}}const In=function(i){return["/listings/details",i]};function _a(i,n){if(1&i&&(e.TgZ(0,"div")(1,"div",48)(2,"div",11)(3,"div",49)(4,"div",50)(5,"a",51),e._UZ(6,"img",52),e.qZA(),e.TgZ(7,"div",53)(8,"span",54),e._UZ(9,"i",55),e.qZA(),e.TgZ(10,"span",56),e._uU(11," Pending"),e.qZA()(),e.TgZ(12,"div",57)(13,"a",58),e._UZ(14,"i",59),e.qZA(),e.TgZ(15,"a",60),e._UZ(16,"i",61),e.qZA()()()(),e.TgZ(17,"div",49)(18,"div",62)(19,"div",63),e._UZ(20,"img",64),e.TgZ(21,"div",65)(22,"p")(23,"a",7),e._UZ(24,"ais-highlight",66),e.qZA()(),e.TgZ(25,"span",67),e._uU(26),e.ALo(27,"date"),e.qZA()(),e._uU(28," \xa0 "),e.TgZ(29,"div",68)(30,"a",69),e._UZ(31,"i",70),e.qZA(),e.TgZ(32,"div",71)(33,"ul")(34,"li")(35,"a",72),e._UZ(36,"i",73),e._uU(37," Call Agent"),e.qZA()(),e.TgZ(38,"li")(39,"a",72),e._UZ(40,"i",74),e._uU(41," Send Message"),e.qZA()(),e.TgZ(42,"li")(43,"a",75),e._UZ(44,"i",76),e._uU(45," Book Tour"),e.qZA()()()()()(),e.TgZ(46,"h5",77)(47,"a",78),e._UZ(48,"ais-highlight",79),e.qZA()(),e.TgZ(49,"span",80),e._uU(50),e.ALo(51,"currency"),e.qZA(),e.TgZ(52,"p",81),e._UZ(53,"ais-highlight",82),e.qZA(),e.TgZ(54,"div",83)(55,"div",84),e._UZ(56,"i",85),e.TgZ(57,"span",86),e._uU(58),e.qZA()(),e.TgZ(59,"div",87),e._UZ(60,"i",88),e.TgZ(61,"span",86),e._uU(62),e.qZA()(),e.TgZ(63,"div",89),e._UZ(64,"i",90),e.TgZ(65,"span",86),e._uU(66),e.ALo(67,"number"),e.qZA()()(),e.TgZ(68,"div",91)(69,"a",92),e._uU(70,"View Details"),e.qZA(),e.TgZ(71,"a",93),e._UZ(72,"i",94),e.qZA()()()()()()()),2&i){const t=n.$implicit;e.xp6(5),e.Q6J("routerLink",e.VKq(23,In,t.objectID)),e.xp6(1),e.Q6J("src",null==t.gallery[0]?null:t.gallery[0].url,e.LSH),e.xp6(14),e.Q6J("src",t.uploader_photoURL,e.LSH),e.xp6(4),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(27,15,1e3*t.uploaded._seconds,"medium")),e.xp6(9),e.s9C("href","tel:"+t.phone,e.LSH),e.xp6(4),e.s9C("href","mailto:"+t.email,e.LSH),e.xp6(8),e.Q6J("routerLink",e.VKq(25,In,t.objectID)),e.xp6(1),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(51,18,t.price,"KES ")),e.xp6(3),e.Q6J("hit",t),e.xp6(5),e.Oqu(t.beds),e.xp6(4),e.Oqu(t.bathrooms),e.xp6(4),e.hij("",e.lcZ(67,21,t.size)," Sqft"),e.xp6(3),e.Q6J("routerLink",e.VKq(27,In,t.objectID))}}const ma=function(){return{label:"All"}},va=function(){return{end:1e6,label:"less than 1m"}},ya=function(){return{start:1e6,end:5e6,label:"Kes. 1m - Kes. 5m"}},ba=function(){return{start:5e6,end:2e7,label:"Kes.  5m - Kes. 20m"}},Ca=function(){return{start:2e7,end:4e7,label:"Kes. 20m - Kes. 40m"}},Ta=function(){return{start:4e7,end:6e7,label:"Kes. 40m - Kes. 60m"}},Za=function(){return{start:6e7,end:8e7,label:"Kes. 60m - Kes. 80m"}},Aa=function(){return{start:8e7,end:1e8,label:"Kes. 80m - Kes. 100m"}},wa=function(){return{start:1e8,label:"more than Kes. 100"}},xa=function(i,n,t,s,r,o,a,l,c){return[i,n,t,s,r,o,a,l,c]},Sa=function(){return["/listings"]},Ea=function(){return["/listings/list"]},Ia=function(){return["/listings/map"]};function Na(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",16)(1,"div",17),e._UZ(2,"ais-stats"),e.qZA(),e.YNc(3,pa,2,1,"div",18),e.TgZ(4,"div",11)(5,"div",19)(6,"div",20)(7,"div",21)(8,"div",22)(9,"h4",23),e._uU(10,"Filter Listings"),e.qZA()(),e.TgZ(11,"div",24)(12,"div",25)(13,"form")(14,"div",26)(15,"div",27)(16,"h6",23),e._uU(17,"County"),e.qZA(),e._UZ(18,"hr",28)(19,"ais-refinement-list",29),e.qZA()(),e.TgZ(20,"div",16)(21,"h6",23),e._uU(22,"Price Range"),e.qZA(),e._UZ(23,"hr",28)(24,"ais-numeric-menu",30),e.qZA(),e.TgZ(25,"div",26)(26,"div",31)(27,"h6",23),e._uU(28,"Neighbourhood"),e.qZA(),e._UZ(29,"hr",28)(30,"ais-menu",32),e.qZA(),e.TgZ(31,"div",31)(32,"h6",23),e._uU(33,"Type of house"),e.qZA(),e._UZ(34,"hr",28)(35,"ais-menu",33),e.qZA()()()()()(),e.TgZ(36,"div",21)(37,"div",22)(38,"h5"),e._uU(39,"Recent Listing"),e.qZA(),e.TgZ(40,"div",34),e._UZ(41,"span")(42,"span"),e.qZA()(),e.TgZ(43,"div",24),e._UZ(44,"app-recent-listings-sm"),e.qZA()(),e.TgZ(45,"div",21)(46,"div",22)(47,"h5"),e._uU(48,"Mortgage Calculator"),e.qZA()(),e.TgZ(49,"div",24),e._UZ(50,"app-mortgage"),e.qZA()()()(),e.TgZ(51,"div",35)(52,"div",36)(53,"div",37),e._UZ(54,"ais-current-refinements"),e.qZA(),e.TgZ(55,"div",38)(56,"a",39),e._UZ(57,"i",40),e.qZA(),e.TgZ(58,"a",41),e._UZ(59,"i",42),e.qZA(),e.TgZ(60,"a",43),e._UZ(61,"i",44),e.qZA()()(),e.YNc(62,ga,2,0,"button",45),e.TgZ(63,"div",16),e.YNc(64,_a,73,29,"div",46),e.qZA(),e.TgZ(65,"button",47),e.NdJ("click",function(r){return e.CHM(t).showNext(r)}),e._uU(66," Show more "),e.qZA()()()()}if(2&i){const t=n.hits;e.xp6(3),e.Q6J("ngIf",0===t.length),e.xp6(16),e.Q6J("limit",7)("showMoreLimit",10)("searchable",!1)("autoHideContainer",!0),e.xp6(5),e.Q6J("items",e.rFY(23,xa,[e.DdM(14,ma),e.DdM(15,va),e.DdM(16,ya),e.DdM(17,ba),e.DdM(18,Ca),e.DdM(19,Ta),e.DdM(20,Za),e.DdM(21,Aa),e.DdM(22,wa)]))("autoHideContainer",!0),e.xp6(6),e.Q6J("autoHideContainer",!0),e.xp6(5),e.Q6J("autoHideContainer",!0),e.xp6(21),e.Q6J("routerLink",e.DdM(33,Sa)),e.xp6(2),e.Q6J("routerLink",e.DdM(34,Ea)),e.xp6(2),e.Q6J("routerLink",e.DdM(35,Ia)),e.xp6(2),e.Q6J("ngIf",t.length>8),e.xp6(2),e.Q6J("ngForOf",t)}}const Ua=function(){return{hitsPerPage:10}};let ka=(()=>{class i{constructor(){this.config={indexName:"listings",searchClient:xn()("MS0SDRBX0K","d7d2fa3a66a52e49a90150f5f632ebf2")}}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-list"]],decls:23,vars:3,consts:[[1,"subheader","bg-cover","bg-center","dark-overlay",2,"background-image","url('https://via.placeholder.com/1920x1280')"],[1,"container"],[1,"subheader-inner"],[1,"text-white"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#"],[1,"fas","fa-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"section"],[1,"row"],[3,"config"],["placeholder","Enter an address, neighbourhood, city or any property details"],["showPreviousLabel","Show previous results","showMoreLabel","Show more results"],[3,"searchParameters"],[2,"margin-top","4%"],[2,"margin-bottom","2%"],[4,"ngIf"],[1,"col-lg-4"],[1,"sidebar","sidebar-left"],[1,"sidebar-widget"],[1,"acr-collapse-trigger","acr-custom-chevron-wrapper"],[2,"margin-bottom","0%"],[1,"acr-collapsable"],[1,"acr-filter-form"],[1,"row",2,"margin-top","4%"],[1,"col-12"],[2,"margin","0%","height","1px","width","100%"],["attribute","county","operator","and","showMoreLabel","show more","showLessLabel","show less","searchPlaceholder","County",3,"limit","showMoreLimit","searchable","autoHideContainer"],["attribute","price",3,"items","autoHideContainer"],[1,"col-6"],["attribute","neighbourhood",3,"autoHideContainer"],["attribute","type",3,"autoHideContainer"],[1,"acr-custom-chevron"],[1,"col-lg-8"],[1,"acr-global-listing-controls"],[1,"acr-listing-active-filters"],[1,"acr-toggle-views"],["data-toggle","tooltip","title","Grid",3,"routerLink"],[1,"fas","fa-th-large"],["data-toggle","tooltip","title","List",1,"active",3,"routerLink"],[1,"fas","fa-th-list"],["data-toggle","tooltip","title","Map",3,"routerLink"],[1,"fas","fa-map"],["class","btn-sm btn-custom",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn-sm","btn-custom",3,"click"],[1,"listing","listing-list"],[1,"col-sm-6"],[1,"listing-thumbnail"],[3,"routerLink"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","listing",2,"object-fit","cover","height","300px",3,"src"],[1,"listing-badges"],[1,"listing-badge","featured"],[1,"fas","fa-star"],[1,"listing-badge","pending"],[1,"listing-controls"],["href","#",1,"favorite"],[1,"far","fa-heart"],["href","#",1,"compare"],[1,"fas","fa-sync-alt"],[1,"listing-body"],[1,"listing-author"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","author",3,"src"],[1,"listing-author-body"],["attribute","uploader_displayName",3,"hit"],[1,"listing-date"],[1,"dropdown","options-dropdown"],["href","#","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-menu","dropdown-menu-right"],[3,"href"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],["href","listing-details-v1.html"],[1,"fas","fa-bookmark"],[1,"listing-title"],["title","hit.name",3,"routerLink"],["attribute","name",3,"hit"],[1,"listing-price"],[1,"listing-text","ellipsis3"],["attribute","description",3,"hit"],[1,"acr-listing-icons"],["data-toggle","tooltip","title","Beds",1,"acr-listing-icon"],[1,"flaticon-bedroom"],[1,"acr-listing-icon-value"],["data-toggle","tooltip","title","Bathrooms",1,"acr-listing-icon"],[1,"flaticon-bathroom"],["data-toggle","tooltip","title","Square Feet",1,"acr-listing-icon"],[1,"flaticon-ruler"],[1,"listing-gallery-wrapper"],[1,"btn-custom","btn-sm","secondary",3,"routerLink"],["href","#","data-toggle","tooltip","title","Gallery",1,"listing-gallery"],[1,"fas","fa-camera"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Listings List"),e.qZA(),e.TgZ(5,"nav",4)(6,"ol",5)(7,"li",6)(8,"a",7),e._UZ(9,"i",8),e.qZA()(),e.TgZ(10,"li",6)(11,"a",7),e._uU(12,"Listings"),e.qZA()(),e.TgZ(13,"li",9),e._uU(14,"Listings List"),e.qZA()()()()()(),e.TgZ(15,"div",10)(16,"div",1)(17,"div",11)(18,"ais-instantsearch",12),e._UZ(19,"ais-search-box",13),e.TgZ(20,"ais-infinite-hits",14),e._UZ(21,"ais-configure",15),e.YNc(22,Na,67,36,"ng-template"),e.qZA()()()()()),2&t&&(e.xp6(18),e.Q6J("config",s.config),e.xp6(3),e.Q6J("searchParameters",e.DdM(2,Ua)))},directives:[E.Lc,E.Ut,E.A3,E.rX,E.ab,A.O5,h._Y,h.JL,E.N6,E.vM,E.x0,Sn.e,es.x,E.ye,ue.yS,A.sg,E.Yi],pipes:[A.uU,A.H9,A.JJ],styles:[""]}),i})();function qa(i,n){if(1&i&&(e.TgZ(0,"div",98),e._UZ(1,"input",99)(2,"img",100),e.TgZ(3,"div")(4,"label",101),e._UZ(5,"img",102),e.qZA()()()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("id",t.id),e.xp6(1),e.Q6J("src",t.url,e.LSH),e.xp6(2),e.Q6J("for",t.id),e.xp6(1),e.Q6J("src",t.url,e.LSH)}}function La(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"Yes"),e.qZA())}function Pa(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"No"),e.qZA())}function Ra(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"Yes"),e.qZA())}function Oa(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"No"),e.qZA())}function Da(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"Yes"),e.qZA())}function Ma(i,n){1&i&&(e.TgZ(0,"span",44),e._uU(1,"No"),e.qZA())}const Nn=function(i){return["/listings/details",i]};function Fa(i,n){if(1&i&&(e.TgZ(0,"div",103)(1,"div",104)(2,"div",105)(3,"a",106),e._UZ(4,"img",107),e.qZA(),e.TgZ(5,"div",108)(6,"span",109),e._UZ(7,"i",84),e.qZA(),e.TgZ(8,"span",110),e._uU(9," Pending"),e.qZA()(),e.TgZ(10,"div",111)(11,"a",112),e._UZ(12,"i",113),e.qZA(),e.TgZ(13,"a",114),e._UZ(14,"i",115),e.qZA()()(),e.TgZ(15,"div",116)(16,"div",117),e._UZ(17,"img",118),e.TgZ(18,"div",119)(19,"p")(20,"a",72),e._uU(21),e.qZA()(),e.TgZ(22,"span",120),e._uU(23),e.ALo(24,"date"),e.qZA()(),e.TgZ(25,"div",76)(26,"a",121),e._UZ(27,"i",78),e.qZA(),e.TgZ(28,"div",79)(29,"ul")(30,"li")(31,"a",122),e._UZ(32,"i",81),e._uU(33," Call Agent"),e.qZA()(),e.TgZ(34,"li")(35,"a",122),e._UZ(36,"i",123),e._uU(37," Send Message"),e.qZA()(),e.TgZ(38,"li")(39,"a",124),e._UZ(40,"i",125),e._uU(41," Book Tour"),e.qZA()()()()()(),e.TgZ(42,"h5",126)(43,"a",127),e._uU(44),e.qZA()(),e.TgZ(45,"span",128),e._uU(46),e.ALo(47,"currency"),e.qZA(),e.TgZ(48,"p",129),e._uU(49),e.qZA(),e.TgZ(50,"div",7)(51,"div",130),e._UZ(52,"i",9),e.TgZ(53,"span",10),e._uU(54),e.qZA()(),e.TgZ(55,"div",131),e._UZ(56,"i",11),e.TgZ(57,"span",10),e._uU(58),e.qZA()(),e.TgZ(59,"div",132),e._UZ(60,"i",12),e.TgZ(61,"span",10),e._uU(62),e.qZA()()(),e.TgZ(63,"div",133)(64,"a",134),e._uU(65,"View Details"),e.qZA()()()()()),2&i){const t=n.$implicit;e.xp6(3),e.Q6J("routerLink",e.VKq(22,Nn,t.id)),e.xp6(1),e.Q6J("src",null==t.gallery[0]?null:t.gallery[0].url,e.LSH),e.xp6(13),e.Q6J("src",t.uploader_photoURL,e.LSH),e.xp6(4),e.Oqu(t.uploader_displayName),e.xp6(2),e.Oqu(e.xi3(24,16,t.uploaded.toDate(),"medium")),e.xp6(8),e.s9C("href","tel:"+t.phone,e.LSH),e.xp6(4),e.s9C("href","mailto:"+t.email,e.LSH),e.xp6(8),e.Q6J("routerLink",e.VKq(24,Nn,t.id))("title",t.name),e.xp6(1),e.Oqu(t.name),e.xp6(2),e.Oqu(e.xi3(47,19,t.price,"Kes. ")),e.xp6(3),e.Oqu(t.description),e.xp6(5),e.Oqu(t.beds),e.xp6(4),e.Oqu(t.bathrooms),e.xp6(4),e.Oqu(t.size),e.xp6(2),e.Q6J("routerLink",e.VKq(26,Nn,t.id))}}function Qa(i,n){if(1&i&&(e.TgZ(0,"a",72),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("",e.lcZ(2,1,null==t.listing?null:t.listing.uploader_displayName)," ")}}function Ha(i,n){if(1&i&&(e.TgZ(0,"a",72),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("",e.lcZ(2,1,null==t.listing?null:t.listing.uploader_id)," ")}}let Va=(()=>{class i{constructor(t,s){this.auth=t,this.route=s,this.routeSub=this.route.params.subscribe(r=>{this.auth.getListing(r.id).subscribe(o=>{this.listing=o})}),this.auth.getRecentListings().subscribe(r=>{this.recent=r})}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(ue.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-listings-details"]],decls:290,vars:35,consts:[[1,"subheader","subheader-2","bg-cover","bg-center"],[1,"acr-listing-details"],[1,"acr-listing-section"],[1,"acr-listing-nav"],["href","#",1,"btn-custom","secondary"],[1,"acr-listing-section-body"],[1,"acr-listing-section-price"],[1,"acr-listing-icons"],[1,"acr-listing-icon"],[1,"flaticon-bedroom"],[1,"acr-listing-icon-value"],[1,"flaticon-bathroom"],[1,"flaticon-ruler"],[1,"ellipsis2"],[1,"acr-listing-controls"],["href","#",1,"acr-listing-control"],[1,"flaticon-share"],[1,"flaticon-star"],["href","#",1,"acr-schedule-tour","acr-listing-control"],[1,"flaticon-event"],[1,"acr-listing-meta"],[1,"row"],[1,"col-lg-6","col-md-3","col-sm-3"],[1,"acr-listing-meta-item"],[1,"section","listing-wrapper"],[1,"container"],[1,"col-lg-8"],[1,"listing-content"],[1,"gallery",2,"margin-top","6%"],["class","gallery__item",4,"ngFor","ngForOf"],[1,"section"],[1,"acr-area-price"],[2,"left","30%"],[1,"progress"],["role","progressbar","aria-valuenow","50","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",2,"width","50%"],[1,"acr-area-price-wrapper"],[1,"acr-area-price-min"],[1,"acr-area-price-max"],[1,"section","section-padding","pt-0","acr-listing-features"],[1,"col-lg-6","col-md-6"],[1,"listing-feature-wrapper"],[1,"listing-feature"],[1,"flaticon-picture"],[1,"listing-feature-label"],[1,"listing-feature-value"],[1,"flaticon-bone"],["class","listing-feature-value",4,"ngIf"],[1,"flaticon-chair"],[1,"flaticon-fan"],[1,"flaticon-pillow"],[1,"flaticon-mailbox"],[1,"listing-features"],[1,"flaticon-eye"],[1,"flaticon-garage"],[1,"flaticon-history"],[1,"flaticon-new"],[1,"section","pt-0"],["method","post"],[1,"col-md-6","form-group"],["type","text","placeholder","Full Name","name","fname","value","",1,"form-control"],["type","email","placeholder","Email Address","name","email","value","",1,"form-control"],["type","text","placeholder","Phone Number","name","phone","value","",1,"form-control"],["type","text","placeholder","Date","name","date","value","",1,"form-control"],[1,"col-md-12","form-group"],["placeholder","Type your comment...","name","comment","rows","7",1,"form-control"],["type","submit","name","button",1,"btn-custom","primary"],[1,"section","section-padding"],["class","col-md-6",4,"ngFor","ngForOf"],[1,"col-lg-4"],[1,"sidebar","sticky-sidebar"],[1,"sidebar-widget"],[1,"media","sidebar-author","listing-agent"],["href","#"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","agent",3,"src"],[1,"media-body"],["href","#",4,"ngIf"],[1,"dropdown","options-dropdown"],["href","#","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-menu","dropdown-menu-right"],["href","tel:+123456789"],[1,"fas","fa-phone"],["href","listing-grid.html"],[1,"fas","fa-th-list"],[1,"fas","fa-star"],[1,"form-group"],["type","text","placeholder","Email Address","name","email","value","",1,"form-control"],["name","message","rows","3","placeholder","Enter your message",1,"form-control"],["href","#",1,"btn-custom","primary","light","btn-block"],["type","text","placeholder","Total Amount","name","total","value","",1,"form-control"],["type","text","placeholder","Down Payment","name","down-p","value","",1,"form-control"],["type","text","placeholder","Interest Rate","name","interest","value","",1,"form-control"],["type","text","placeholder","Loan Term","name","loan-term","value","",1,"form-control"],["name","cycle",1,"form-control"],["value","Daily"],["value","Monthly"],["value","Yearly"],["type","submit","name","button",1,"btn-custom","btn-block"],[1,"gallery__item"],["type","radio","checked","","name","gallery",1,"gallery__selector",2,"border-radius","8px!important",3,"id"],["alt","",1,"gallery__img",3,"src"],[1,"gallery__thumb",3,"for"],["alt","",2,"border-radius","8px!important","max-height","100px",3,"src"],[1,"col-md-6"],[1,"listing"],[1,"listing-thumbnail"],[3,"routerLink"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","listing",3,"src"],[1,"listing-badges"],[1,"listing-badge","featured"],[1,"listing-badge","pending"],[1,"listing-controls"],["href","#",1,"favorite"],[1,"far","fa-heart"],["href","#",1,"compare"],[1,"fas","fa-sync-alt"],[1,"listing-body"],[1,"listing-author"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?';","alt","author",3,"src"],[1,"listing-author-body"],[1,"listing-date"],["data-toggle","dropdown","aria-haspopup","true","aria-expanded","false"],[3,"href"],[1,"fas","fa-envelope"],["href","listing-details-v1.html"],[1,"fas","fa-bookmark"],[1,"listing-title"],[3,"routerLink","title"],[1,"listing-price"],[1,"listing-text","ellipsis2"],["data-toggle","tooltip","title","","data-original-title","Beds",1,"acr-listing-icon"],["data-toggle","tooltip","title","","data-original-title","Bathrooms",1,"acr-listing-icon"],["data-toggle","tooltip","title","","data-original-title","Square Feet",1,"acr-listing-icon"],[1,"listing-gallery-wrapper"],[1,"btn-custom","btn-sm","secondary",3,"routerLink"]],template:function(t,s){1&t&&(e._UZ(0,"div",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4),e._uU(5,"Print Listing"),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"span"),e._uU(9,"For Sale"),e.qZA(),e.TgZ(10,"h4"),e._uU(11),e.ALo(12,"currency"),e.qZA(),e.TgZ(13,"span"),e._uU(14,"Est. Mortgage"),e.qZA(),e.TgZ(15,"p"),e._uU(16,"$1,300/mo"),e.qZA()()()(),e.TgZ(17,"div",2)(18,"div",5)(19,"h4"),e._uU(20),e.qZA(),e.TgZ(21,"div",7)(22,"div",8),e._UZ(23,"i",9),e.TgZ(24,"span"),e._uU(25,"Beds"),e.qZA(),e.TgZ(26,"span",10),e._uU(27),e.qZA()(),e.TgZ(28,"div",8),e._UZ(29,"i",11),e.TgZ(30,"span"),e._uU(31,"Baths"),e.qZA(),e.TgZ(32,"span",10),e._uU(33),e.qZA()(),e.TgZ(34,"div",8),e._UZ(35,"i",12),e.TgZ(36,"span"),e._uU(37,"Sqft"),e.qZA(),e.TgZ(38,"span",10),e._uU(39),e.qZA()()(),e.TgZ(40,"p",13),e._uU(41),e.qZA()()(),e.TgZ(42,"div",2)(43,"div",14)(44,"a",15),e._UZ(45,"i",16),e.qZA(),e.TgZ(46,"a",15),e._UZ(47,"i",17),e.qZA(),e.TgZ(48,"a",18),e._UZ(49,"i",19),e.TgZ(50,"span"),e._uU(51,"Schedule a Tour"),e.qZA()()(),e.TgZ(52,"div",5)(53,"div",20)(54,"div",21)(55,"div",22)(56,"div",23)(57,"span"),e._uU(58,"Type"),e.qZA(),e.TgZ(59,"p"),e._uU(60),e.qZA()()(),e.TgZ(61,"div",22)(62,"div",23)(63,"span"),e._uU(64,"View"),e.qZA(),e.TgZ(65,"p"),e._uU(66,"City View"),e.qZA()()(),e.TgZ(67,"div",22)(68,"div",23)(69,"span"),e._uU(70,"Lot Size"),e.qZA(),e.TgZ(71,"p"),e._uU(72,"89 Acres"),e.qZA()()(),e.TgZ(73,"div",22)(74,"div",23)(75,"span"),e._uU(76,"Condition"),e.qZA(),e.TgZ(77,"p"),e._uU(78),e.qZA()()()()()()()(),e.TgZ(79,"div",24)(80,"div",25)(81,"div",21)(82,"div",26)(83,"div",27)(84,"h4"),e._uU(85,"Property Overview"),e.qZA(),e.TgZ(86,"p"),e._uU(87),e.qZA()(),e.TgZ(88,"section",28),e.YNc(89,qa,6,4,"div",29),e.qZA(),e.TgZ(90,"div",30)(91,"div",31)(92,"span",32),e._uU(93),e.ALo(94,"currency"),e.qZA(),e.TgZ(95,"div",33),e._UZ(96,"div",34),e.qZA(),e.TgZ(97,"div",35)(98,"div",36)(99,"h5"),e._uU(100,"562,000$"),e.qZA(),e.TgZ(101,"span"),e._uU(102,"Lowest"),e.qZA()(),e.TgZ(103,"h5"),e._uU(104,"Price range in the area"),e.qZA(),e.TgZ(105,"div",37)(106,"h5"),e._uU(107,"1,280,000$"),e.qZA(),e.TgZ(108,"span"),e._uU(109,"Highest"),e.qZA()()()()(),e.TgZ(110,"div",38)(111,"h4"),e._uU(112,"Features"),e.qZA(),e.TgZ(113,"div",21)(114,"div",39)(115,"div",40)(116,"div",41),e._UZ(117,"i",42),e.TgZ(118,"h6",43),e._uU(119,"Propery Type"),e.qZA(),e.TgZ(120,"span",44),e._uU(121),e.qZA()(),e.TgZ(122,"div",41),e._UZ(123,"i",45),e.TgZ(124,"h6",43),e._uU(125,"Pet Friendly"),e.qZA(),e.YNc(126,La,2,0,"span",46),e.YNc(127,Pa,2,0,"span",46),e.qZA(),e.TgZ(128,"div",41),e._UZ(129,"i",47),e.TgZ(130,"h6",43),e._uU(131,"Furnished"),e.qZA(),e.YNc(132,Ra,2,0,"span",46),e.YNc(133,Oa,2,0,"span",46),e.qZA(),e.TgZ(134,"div",41),e._UZ(135,"i",48),e.TgZ(136,"h6",43),e._uU(137,"Cooling"),e.qZA(),e.YNc(138,Da,2,0,"span",46),e.YNc(139,Ma,2,0,"span",46),e.qZA()()(),e.TgZ(140,"div",39)(141,"div",40)(142,"div",41),e._UZ(143,"i",11),e.TgZ(144,"h6",43),e._uU(145,"Bathrooms"),e.qZA(),e.TgZ(146,"span",44),e._uU(147),e.qZA()(),e.TgZ(148,"div",41),e._UZ(149,"i",49),e.TgZ(150,"h6",43),e._uU(151,"Bed Rooms"),e.qZA(),e.TgZ(152,"span",44),e._uU(153),e.qZA()(),e.TgZ(154,"div",41),e._UZ(155,"i",50),e.TgZ(156,"h6",43),e._uU(157,"Mail box"),e.qZA(),e.TgZ(158,"span",44),e._uU(159,"Yes"),e.qZA()(),e.TgZ(160,"div",41),e._UZ(161,"i",12),e.TgZ(162,"h6",43),e._uU(163,"Property Size"),e.qZA(),e.TgZ(164,"span",44),e._uU(165),e.ALo(166,"number"),e.qZA()()()()(),e.TgZ(167,"div",51)(168,"div",21)(169,"div",39)(170,"div",41),e._UZ(171,"i",52),e.TgZ(172,"h6",43),e._uU(173,"View"),e.qZA(),e.TgZ(174,"span",44),e._uU(175,"City View"),e.qZA()(),e.TgZ(176,"div",41),e._UZ(177,"i",53),e.TgZ(178,"h6",43),e._uU(179,"Parking"),e.qZA(),e.TgZ(180,"span",44),e._uU(181,"Yes"),e.qZA()(),e.TgZ(182,"div",41),e._UZ(183,"i",54),e.TgZ(184,"h6",43),e._uU(185,"Year Built"),e.qZA(),e.TgZ(186,"span",44),e._uU(187,"1979"),e.qZA()()(),e.TgZ(188,"div",39)(189,"div",41),e._UZ(190,"i",55),e.TgZ(191,"h6",43),e._uU(192,"Condition"),e.qZA(),e.TgZ(193,"span",44),e._uU(194,"New"),e.qZA()(),e.TgZ(195,"div",41),e._UZ(196,"i",12),e.TgZ(197,"h6",43),e._uU(198,"Lot Size"),e.qZA(),e.TgZ(199,"span",44),e._uU(200,"89 Acres"),e.qZA()()()()()(),e.TgZ(201,"div",56)(202,"h4"),e._uU(203,"Schedule a Tour"),e.qZA(),e.TgZ(204,"form",57)(205,"div",21)(206,"div",58),e._UZ(207,"input",59),e.qZA(),e.TgZ(208,"div",58),e._UZ(209,"input",60),e.qZA(),e.TgZ(210,"div",58),e._UZ(211,"input",61),e.qZA(),e.TgZ(212,"div",58),e._UZ(213,"input",62),e.qZA(),e.TgZ(214,"div",63),e._UZ(215,"textarea",64),e.qZA()(),e.TgZ(216,"button",65),e._uU(217,"Schedule Tour"),e.qZA()()(),e.TgZ(218,"div",66)(219,"h4"),e._uU(220,"Similar Listings"),e.qZA(),e.TgZ(221,"div",21),e.YNc(222,Fa,66,28,"div",67),e.qZA()()(),e.TgZ(223,"div",68)(224,"div",69)(225,"div",70)(226,"h5"),e._uU(227,"Meet The Agent"),e.qZA(),e.TgZ(228,"div",71)(229,"a",72),e._UZ(230,"img",73),e.qZA(),e.TgZ(231,"div",74)(232,"h6"),e.YNc(233,Qa,3,3,"a",75),e.qZA(),e.TgZ(234,"h6"),e.YNc(235,Ha,3,3,"a",75),e.qZA(),e.TgZ(236,"span"),e._uU(237,"Agent"),e.qZA()(),e.TgZ(238,"div",76)(239,"a",77),e._UZ(240,"i",78),e.qZA(),e.TgZ(241,"div",79)(242,"ul")(243,"li")(244,"a",80),e._UZ(245,"i",81),e._uU(246," Call Agent"),e.qZA()(),e.TgZ(247,"li")(248,"a",82),e._UZ(249,"i",83),e._uU(250," View Listings"),e.qZA()(),e.TgZ(251,"li")(252,"a",72),e._UZ(253,"i",84),e._uU(254," Save Agent"),e.qZA()()()()()(),e.TgZ(255,"form",57)(256,"div",85),e._UZ(257,"input",86),e.qZA(),e.TgZ(258,"div",85),e._UZ(259,"input",61),e.qZA(),e.TgZ(260,"div",85),e._UZ(261,"textarea",87),e.qZA(),e.TgZ(262,"a",88),e._uU(263,"Send Message"),e.qZA()()(),e.TgZ(264,"div",70)(265,"h5"),e._uU(266,"Recent Listings"),e.qZA(),e._UZ(267,"app-recent-listings-sm"),e.qZA(),e.TgZ(268,"div",70)(269,"h5"),e._uU(270,"Mortgage Calculator"),e.qZA(),e.TgZ(271,"form",57)(272,"div",85),e._UZ(273,"input",89),e.qZA(),e.TgZ(274,"div",85),e._UZ(275,"input",90),e.qZA(),e.TgZ(276,"div",85),e._UZ(277,"input",91),e.qZA(),e.TgZ(278,"div",85),e._UZ(279,"input",92),e.qZA(),e.TgZ(280,"div",85)(281,"select",93)(282,"option",94),e._uU(283,"Daily"),e.qZA(),e.TgZ(284,"option",95),e._uU(285,"Monthly"),e.qZA(),e.TgZ(286,"option",96),e._uU(287,"Yearly"),e.qZA()()(),e.TgZ(288,"button",97),e._uU(289,"Calculate"),e.qZA()()()()()()()()),2&t&&(e.Udp("background-image","url("+(null==s.listing.gallery[0]?null:s.listing.gallery[0].url)+")"),e.xp6(11),e.Oqu(e.xi3(12,27,s.listing.price,"KES ")),e.xp6(9),e.hij(" ",s.listing.name," "),e.xp6(7),e.Oqu(s.listing.beds),e.xp6(6),e.Oqu(s.listing.bathrooms),e.xp6(6),e.Oqu(s.listing.size),e.xp6(2),e.hij(" ",s.listing.description," "),e.xp6(19),e.Oqu(s.listing.type),e.xp6(18),e.Oqu(s.listing.condition),e.xp6(9),e.hij(" ",s.listing.description," "),e.xp6(2),e.Q6J("ngForOf",s.listing.gallery),e.xp6(4),e.Oqu(e.xi3(94,30,s.listing.price,"KES ")),e.xp6(28),e.Oqu(s.listing.type),e.xp6(5),e.Q6J("ngIf",s.listing.pets),e.xp6(1),e.Q6J("ngIf",!s.listing.pets),e.xp6(5),e.Q6J("ngIf",s.listing.furnished),e.xp6(1),e.Q6J("ngIf",!s.listing.furnished),e.xp6(5),e.Q6J("ngIf",s.listing.cooling),e.xp6(1),e.Q6J("ngIf",!s.listing.cooling),e.xp6(8),e.Oqu(s.listing.bathrooms),e.xp6(6),e.Oqu(s.listing.beds),e.xp6(12),e.hij("",e.lcZ(166,33,s.listing.size)," Sqft"),e.xp6(57),e.Q6J("ngForOf",s.recent),e.xp6(8),e.Q6J("src",null==s.listing?null:s.listing.uploader_photoURL,e.LSH),e.xp6(3),e.Q6J("ngIf",null==s.listing?null:s.listing.uploader_displayName),e.xp6(2),e.Q6J("ngIf",!(null!=s.listing&&s.listing.uploader_displayName)))},directives:[A.sg,A.O5,h._Y,h.JL,ue.yS,Sn.e,h.YN,h.Kr],pipes:[A.H9,A.JJ,A.uU,A.rS],styles:["img[_ngcontent-%COMP%]{max-width:100%;vertical-align:top}.gallery[_ngcontent-%COMP%]{display:flex;margin:10px auto;max-width:600px;position:relative;padding-top:66.6666666667%}@media screen and (min-width: 600px){.gallery[_ngcontent-%COMP%]{padding-top:400px}}.gallery__img[_ngcontent-%COMP%]{position:absolute;border-radius:8px;top:0;height:400px;width:100%;object-fit:contain;left:0;opacity:0;transition:opacity .3s ease-in-out}.gallery__thumb[_ngcontent-%COMP%]{padding-top:6px;margin:6px;display:block;border-radius:8px}.gallery__selector[_ngcontent-%COMP%]{position:absolute;opacity:0;visibility:hidden;border-radius:8px}.gallery__selector[_ngcontent-%COMP%]:checked + .gallery__img[_ngcontent-%COMP%]{opacity:1;border-radius:8px}.gallery__selector[_ngcontent-%COMP%]:checked ~ .gallery__thumb[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{box-shadow:0 0 0 3px #0be2f6;border-radius:8px}"]}),i})();var R=y(9898),Se=y(2340),Ja=y(5698);const Ba=["lat"];function Ya(i,n){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&i){const t=e.oxw().results;e.xp6(1),e.hij(" No results have been found for ",null==t?null:t.query,". ")}}function Wa(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(r){return e.CHM(t),e.oxw().showPrevious(r)}),e._uU(1," Show previous "),e.qZA()}}const Un=function(i){return["/listings/details",i]};function za(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",40)(1,"div",41)(2,"div",42)(3,"a",43),e._UZ(4,"img",44),e.qZA(),e.TgZ(5,"div",45)(6,"span",46),e._UZ(7,"i",47),e.qZA(),e.TgZ(8,"span",48),e._uU(9," Pending"),e.qZA()(),e.TgZ(10,"div",49)(11,"a",50),e._UZ(12,"i",51),e.qZA(),e.TgZ(13,"a",52),e._UZ(14,"i",53),e.qZA()()(),e.TgZ(15,"div",54)(16,"div",55),e._UZ(17,"img",56),e.TgZ(18,"div",57)(19,"p")(20,"a",58),e._UZ(21,"ais-highlight",59),e.qZA()(),e.TgZ(22,"span",60),e._uU(23),e.ALo(24,"date"),e.qZA()(),e._uU(25," \xa0 "),e.TgZ(26,"div",61)(27,"a",62),e._UZ(28,"i",63),e.qZA(),e.TgZ(29,"div",64)(30,"ul")(31,"li")(32,"a",65),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw(2).getUploaderPhone(o.uploader_id)}),e._UZ(33,"i",66),e._uU(34," Call Agent"),e.qZA()(),e.TgZ(35,"li")(36,"a",65),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw(2).getUploaderEmail(o.uploader_id)}),e._UZ(37,"i",67),e._uU(38," Send Message"),e.qZA()(),e.TgZ(39,"li")(40,"a",68),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw(2).flyTo(o.latitude,o.longitude)}),e._UZ(41,"i",69),e._uU(42,"View on map"),e.qZA()()()()()(),e.TgZ(43,"h5",70)(44,"a",71),e._UZ(45,"ais-highlight",72),e.qZA()(),e.TgZ(46,"span",73),e._uU(47),e.ALo(48,"currency"),e.qZA(),e.TgZ(49,"p",74),e._UZ(50,"ais-highlight",75),e.qZA(),e.TgZ(51,"div",76)(52,"div",77),e._UZ(53,"i",78),e.TgZ(54,"span",79),e._uU(55),e.qZA()(),e.TgZ(56,"div",80),e._UZ(57,"i",81),e.TgZ(58,"span",79),e._uU(59),e.qZA()(),e.TgZ(60,"div",82),e._UZ(61,"i",83),e.TgZ(62,"span",79),e._uU(63),e.ALo(64,"number"),e.qZA()()(),e.TgZ(65,"div",84)(66,"a",85),e._uU(67,"View Details"),e.qZA()()()()()}if(2&i){const t=n.$implicit,s=e.oxw(2);e.xp6(3),e.Q6J("routerLink",e.VKq(23,Un,t.objectID)),e.xp6(1),e.Q6J("src",null==t.gallery[0]?null:t.gallery[0].url,e.LSH),e.xp6(13),e.Q6J("src",t.uploader_photoURL,e.LSH),e.xp6(4),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(24,15,1e3*t.uploaded._seconds,"medium")),e.xp6(9),e.s9C("href","tel:"+s.uploaderPhone,e.LSH),e.xp6(4),e.s9C("href","mailto:"+s.uploaderEmail,e.LSH),e.xp6(8),e.Q6J("routerLink",e.VKq(25,Un,t.objectID)),e.xp6(1),e.Q6J("hit",t),e.xp6(2),e.Oqu(e.xi3(48,18,t.price,"KES ")),e.xp6(3),e.Q6J("hit",t),e.xp6(5),e.Oqu(t.beds),e.xp6(4),e.Oqu(t.bathrooms),e.xp6(4),e.hij("",e.lcZ(64,21,t.size)," Sqft"),e.xp6(3),e.Q6J("routerLink",e.VKq(27,Un,t.objectID))}}function Ga(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div",30)(1,"div",31),e._UZ(2,"ais-stats"),e.qZA(),e.YNc(3,Ya,2,1,"div",32),e.TgZ(4,"div",17)(5,"div",33)(6,"div",34)(7,"div",35),e._UZ(8,"ais-current-refinements"),e.qZA()(),e.YNc(9,Wa,2,0,"button",36),e.TgZ(10,"div",10),e.YNc(11,za,68,29,"div",37),e.qZA(),e.TgZ(12,"button",38),e.NdJ("click",function(r){return e.CHM(t).showNext(r)}),e._uU(13," Show more "),e.qZA()()()()}if(2&i){const t=n.hits;e.xp6(3),e.Q6J("ngIf",0===t.length),e.xp6(6),e.Q6J("ngIf",t.length>8),e.xp6(2),e.Q6J("ngForOf",t)}}const ja=function(){return{hitsPerPage:5,distinct:!0,facetFilters:"house"}},Ka=function(){return{label:"All"}},$a=function(){return{end:1e6,label:"less than 1m"}},Xa=function(){return{start:1e6,end:5e6,label:"Kes. 1m - Kes. 5m"}},el=function(){return{start:5e6,end:2e7,label:"Kes.  5m - Kes. 20m"}},tl=function(){return{start:2e7,end:4e7,label:"Kes. 20m - Kes. 40m"}},nl=function(){return{start:4e7,end:6e7,label:"Kes. 40m - Kes. 60m"}},il=function(){return{start:6e7,end:8e7,label:"Kes. 60m - Kes. 80m"}},sl=function(){return{start:8e7,end:1e8,label:"Kes. 80m - Kes. 100m"}},rl=function(){return{start:1e8,label:"more than Kes. 100"}},ol=function(i,n,t,s,r,o,a,l,c){return[i,n,t,s,r,o,a,l,c]},al=function(){return["/listings"]},ll=function(){return["/listings/list"]},cl=function(){return["/listings/map"]},ul=function(){return{hitsPerPage:10}};let ts=(()=>{class i{constructor(t,s){this.auth=t,this.elem=s,this.config={indexName:"listings",searchClient:xn()("MS0SDRBX0K","d7d2fa3a66a52e49a90150f5f632ebf2")}}ngOnInit(){}ngAfterViewInit(){this.auth.getListings().pipe((0,Ja.q)(1)).subscribe(t=>{this.mapData=t,R.accessToken=Se.N.mapbox.accessToken,this.map=new R.Map({style:"mapbox://styles/mapbox/light-v10",center:[36.82,-1.38],zoom:11.5,pitch:45,container:"mapEl",antialias:!0});var s=new R.LngLatBounds;console.log("mapdata",this.mapData),this.mapData.forEach(r=>{var o,a=document.createElement("div");a.className="marker",s.extend([r.latitude,r.longitude]),new R.Marker(a).setLngLat([r.latitude,r.longitude]).setPopup(new R.Popup({offset:25}).setHTML('<img src="'+(null===(o=r.gallery[0])||void 0===o?void 0:o.url)+'"  onerror="this.onerror=null;this.src=\'https://via.placeholder.com/300x210?\' " alt="'+r.name+'" /> <div class="acr-listing-popup-body"><h5><a title="'+r.name+'">'+r.name+'</a></h5> <span class="listing-price"> KES. '+r.price+'</span><p class="ellipsis2"><i class="fas fa-map-signs"></i> '+r.description+'</p> <div class="location-popup-meta"> <span><i class="fas fa-bed"></i>'+r.beds+'</span><span><i class="fas fa-bath"></i>'+r.bathrooms+'</span> <span><i class="fas fa-ruler-combined"></i>'+r.size+"</span>  </div></div>")).addTo(this.map)}),this.map.fitBounds(s,{padding:100}),this.map.on("load",r=>{for(var a,o=this.map.getStyle().layers,l=0;l<o.length;l++)if("symbol"===o[l].type){a=o[l].id;break}this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},a)})})}flyTo(t,s){this.map.flyTo({zoom:18.5,center:[t,s],essential:!0})}showFilter(){let t=document.getElementsByClassName("acr-filter-form");0!=t.length&&(t[0].style.display="block")}lessFilter(){let t=document.getElementsByClassName("acr-filter-form");0!=t.length&&(t[0].style.display="none")}getData(){alert("Image is loaded")}getUploaderEmail(t){this.auth.getUploaderID(t).forEach(s=>{this.uploaderEmail=null==s?void 0:s.email})}getUploaderPhone(t){this.auth.getUploaderID(t).forEach(s=>{this.uploaderPhone=null==s?void 0:s.phoneNumber})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(e.SBq))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-map"]],viewQuery:function(t,s){if(1&t&&e.Gf(Ba,5),2&t){let r;e.iGM(r=e.CRH())&&(s.lat=r.first)}},decls:44,vars:36,consts:[[1,"listing-map-wrapper"],[1,"listing-map"],["id","mapEl"],["mapEl",""],[1,"listing-main-wrapper",2,"overflow-y","auto"],[3,"config"],[3,"searchParameters"],[1,"acr-filter-form"],[1,"acr-filter-form-header"],[1,"close-btn","close-dark","filter-trigger",3,"click"],[1,"row",2,"margin-top","4%"],[1,"col-6"],[2,"margin-bottom","0%"],[2,"margin","0%","height","1px","width","100%"],["attribute","county","operator","and","showMoreLabel","show more","showLessLabel","show less","searchPlaceholder","County",3,"limit","showMoreLimit","searchable","autoHideContainer"],["attribute","price",3,"items","autoHideContainer"],[1,"acr-listing-filter-wrapper"],[1,"row"],[1,"col-sm-6"],["placeholder","Enter an address, neighbourhood, city or any property details"],[1,"col-sm-3"],["type","button","name","button",1,"btn-custom-2","light-grey","filter-trigger",3,"click"],[1,"acr-toggle-views"],["data-toggle","tooltip","title","Grid",3,"routerLink"],[1,"fas","fa-th-large"],["data-toggle","tooltip","title","List",3,"routerLink"],[1,"fas","fa-th-list"],["data-toggle","tooltip","title","Map",1,"active",3,"routerLink"],[1,"fas","fa-map"],["showPreviousLabel","Show previous results","showMoreLabel","Show more results"],[2,"margin-top","4%"],[2,"margin-bottom","2%"],[4,"ngIf"],[1,"col-lg-12"],[1,"acr-global-listing-controls"],[1,"acr-listing-active-filters"],["onload","getData()","class","btn-sm btn-custom",3,"click",4,"ngIf"],["class","col-md-6",4,"ngFor","ngForOf"],[1,"btn-sm","btn-custom",2,"margin-bottom","4%",3,"click"],["onload","getData()",1,"btn-sm","btn-custom",3,"click"],[1,"col-md-6"],[1,"listing"],[1,"listing-thumbnail"],[3,"routerLink"],["onerror","this.onerror=null;this.src='https://via.placeholder.com/300x210?';","alt","listing",3,"src"],[1,"listing-badges"],[1,"listing-badge","featured"],[1,"fas","fa-star"],[1,"listing-badge","pending"],[1,"listing-controls"],["href","#",1,"favorite"],[1,"far","fa-heart"],["href","#",1,"compare"],[1,"fas","fa-sync-alt"],[1,"listing-body"],[1,"listing-author"],["alt","author","onerror","this.onerror=null;this.src='https://via.placeholder.com/292x300?text=User';",3,"src"],[1,"listing-author-body"],["href","#"],["attribute","uploader_displayName",3,"hit"],[1,"listing-date"],[1,"dropdown","options-dropdown"],["href","#","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false"],[1,"fas","fa-ellipsis-v"],[1,"dropdown-menu","dropdown-menu-right"],[3,"href","click"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],[3,"click"],[1,"fas","fa-map-marker"],[1,"listing-title"],["title","hit.name",3,"routerLink"],["attribute","name",3,"hit"],[1,"listing-price"],[1,"listing-text","ellipsis3"],["attribute","description",3,"hit"],[1,"acr-listing-icons"],["data-toggle","tooltip","title","Beds",1,"acr-listing-icon"],[1,"flaticon-bedroom"],[1,"acr-listing-icon-value"],["data-toggle","tooltip","title","Bathrooms",1,"acr-listing-icon"],[1,"flaticon-bathroom"],["data-toggle","tooltip","title","Square Feet",1,"acr-listing-icon"],[1,"flaticon-ruler"],[1,"listing-gallery-wrapper"],[1,"btn-custom","btn-sm","secondary",3,"routerLink"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"div",2,3),e.qZA(),e.TgZ(4,"div",4)(5,"ais-instantsearch",5),e._UZ(6,"ais-configure",6),e.TgZ(7,"div",7)(8,"div",8)(9,"h4"),e._uU(10,"Filter"),e.qZA(),e.TgZ(11,"div",9),e.NdJ("click",function(){return s.lessFilter()}),e._UZ(12,"span")(13,"span"),e.qZA()(),e.TgZ(14,"form")(15,"div",10)(16,"div",11)(17,"h6",12),e._uU(18,"County"),e.qZA(),e._UZ(19,"hr",13)(20,"ais-refinement-list",14),e.qZA(),e.TgZ(21,"div",11)(22,"h6",12),e._uU(23,"Price Range"),e.qZA(),e._UZ(24,"hr",13)(25,"ais-numeric-menu",15),e.qZA()()()(),e.TgZ(26,"div",16)(27,"div",17)(28,"div",18),e._UZ(29,"ais-search-box",19),e.qZA(),e.TgZ(30,"div",20)(31,"button",21),e.NdJ("click",function(){return s.showFilter()}),e._uU(32,"Advanced Search"),e.qZA()(),e.TgZ(33,"div",20)(34,"div",22)(35,"a",23),e._UZ(36,"i",24),e.qZA(),e.TgZ(37,"a",25),e._UZ(38,"i",26),e.qZA(),e.TgZ(39,"a",27),e._UZ(40,"i",28),e.qZA()()()(),e.TgZ(41,"ais-infinite-hits",29),e._UZ(42,"ais-configure",6),e.YNc(43,Ga,14,3,"ng-template"),e.qZA()()()()()),2&t&&(e.xp6(5),e.Q6J("config",s.config),e.xp6(1),e.Q6J("searchParameters",e.DdM(12,ja)),e.xp6(14),e.Q6J("limit",7)("showMoreLimit",10)("searchable",!1)("autoHideContainer",!0),e.xp6(5),e.Q6J("items",e.rFY(22,ol,[e.DdM(13,Ka),e.DdM(14,$a),e.DdM(15,Xa),e.DdM(16,el),e.DdM(17,tl),e.DdM(18,nl),e.DdM(19,il),e.DdM(20,sl),e.DdM(21,rl)]))("autoHideContainer",!0),e.xp6(10),e.Q6J("routerLink",e.DdM(32,al)),e.xp6(2),e.Q6J("routerLink",e.DdM(33,ll)),e.xp6(2),e.Q6J("routerLink",e.DdM(34,cl)),e.xp6(3),e.Q6J("searchParameters",e.DdM(35,ul)))},directives:[E.Lc,E.rX,h._Y,h.JL,E.N6,E.vM,E.Ut,ue.yS,E.A3,E.ab,A.O5,E.ye,A.sg,E.Yi],pipes:[A.uU,A.H9,A.JJ],styles:[""]}),i})();var me=y(4004),dl=y(4986),hl=y(8306),fl=y(9646),ns=y(6451),pl=y(3099),gl=y(3900),is=y(5026),_l=y(1884),ss=y(4482),kn=y(5403),ml=y(8421),vl=y(4671),yl=y(5032),bl=y(3269),Ee=y(7937),Ot=y(2011),Zl=(y(8963),y(8001)),rs=y(5861);const g=function(i,n){if(!i)throw Ve(n)},Ve=function(i){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+i)},os=function(i){const n=[];let t=0;for(let s=0;s<i.length;s++){let r=i.charCodeAt(s);r<128?n[t++]=r:r<2048?(n[t++]=r>>6|192,n[t++]=63&r|128):55296==(64512&r)&&s+1<i.length&&56320==(64512&i.charCodeAt(s+1))?(r=65536+((1023&r)<<10)+(1023&i.charCodeAt(++s)),n[t++]=r>>18|240,n[t++]=r>>12&63|128,n[t++]=r>>6&63|128,n[t++]=63&r|128):(n[t++]=r>>12|224,n[t++]=r>>6&63|128,n[t++]=63&r|128)}return n},Ln={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(i,n){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=n?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<i.length;r+=3){const o=i[r],a=r+1<i.length,l=a?i[r+1]:0,c=r+2<i.length,u=c?i[r+2]:0;let p=(15&l)<<2|u>>6,_=63&u;c||(_=64,a||(p=64)),s.push(t[o>>2],t[(3&o)<<4|l>>4],t[p],t[_])}return s.join("")},encodeString(i,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(i):this.encodeByteArray(os(i),n)},decodeString(i,n){return this.HAS_NATIVE_SUPPORT&&!n?atob(i):function(i){const n=[];let t=0,s=0;for(;t<i.length;){const r=i[t++];if(r<128)n[s++]=String.fromCharCode(r);else if(r>191&&r<224){const o=i[t++];n[s++]=String.fromCharCode((31&r)<<6|63&o)}else if(r>239&&r<365){const c=((7&r)<<18|(63&i[t++])<<12|(63&i[t++])<<6|63&i[t++])-65536;n[s++]=String.fromCharCode(55296+(c>>10)),n[s++]=String.fromCharCode(56320+(1023&c))}else{const o=i[t++],a=i[t++];n[s++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&a)}}return n.join("")}(this.decodeStringToByteArray(i,n))},decodeStringToByteArray(i,n){this.init_();const t=n?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<i.length;){const o=t[i.charAt(r++)],l=r<i.length?t[i.charAt(r)]:0;++r;const u=r<i.length?t[i.charAt(r)]:64;++r;const d=r<i.length?t[i.charAt(r)]:64;if(++r,null==o||null==l||null==u||null==d)throw Error();s.push(o<<2|l>>4),64!==u&&(s.push(l<<4&240|u>>2),64!==d&&s.push(u<<6&192|d))}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},as=function(i){const n=os(i);return Ln.encodeByteArray(n,!0)},ls=function(i){return as(i).replace(/\./g,"")},cs=function(i){try{return Ln.decodeString(i,!0)}catch(n){console.error("base64Decode failed: ",n)}return null};function wl(i){return us(void 0,i)}function us(i,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===i&&(i={});break;case Array:i=[];break;default:return n}for(const t in n)!n.hasOwnProperty(t)||!xl(t)||(i[t]=us(i[t],n[t]));return i}function xl(i){return"__proto__"!==i}class B{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((n,t)=>{this.resolve=n,this.reject=t})}wrapCallback(n){return(t,s)=>{t?this.reject(t):this.resolve(s),"function"==typeof n&&(this.promise.catch(()=>{}),1===n.length?n(t):n(t,s))}}}function ds(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function Dt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}function rt(i){return JSON.parse(i)}function P(i){return JSON.stringify(i)}Error;const Mt=function(i){let n={},t={},s={},r="";try{const o=i.split(".");n=rt(cs(o[0])||""),t=rt(cs(o[1])||""),r=o[2],s=t.d||{},delete t.d}catch(o){}return{header:n,claims:t,data:s,signature:r}};function te(i,n){return Object.prototype.hasOwnProperty.call(i,n)}function Ie(i,n){if(Object.prototype.hasOwnProperty.call(i,n))return i[n]}function Rn(i){for(const n in i)if(Object.prototype.hasOwnProperty.call(i,n))return!1;return!0}function Ft(i,n,t){const s={};for(const r in i)Object.prototype.hasOwnProperty.call(i,r)&&(s[r]=n.call(t,i[r],r,i));return s}class Dl{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let n=1;n<this.blockSize;++n)this.pad_[n]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(n,t){t||(t=0);const s=this.W_;if("string"==typeof n)for(let d=0;d<16;d++)s[d]=n.charCodeAt(t)<<24|n.charCodeAt(t+1)<<16|n.charCodeAt(t+2)<<8|n.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)s[d]=n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3],t+=4;for(let d=16;d<80;d++){const p=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=4294967295&(p<<1|p>>>31)}let u,f,r=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(u=l^o&(a^l),f=1518500249):(u=o^a^l,f=1859775393):d<60?(u=o&a|l&(o|a),f=2400959708):(u=o^a^l,f=3395469782);const p=(r<<5|r>>>27)+u+c+f+s[d]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=r,r=p}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(n,t){if(null==n)return;void 0===t&&(t=n.length);const s=t-this.blockSize;let r=0;const o=this.buf_;let a=this.inbuf_;for(;r<t;){if(0===a)for(;r<=s;)this.compress_(n,r),r+=this.blockSize;if("string"==typeof n){for(;r<t;)if(o[a]=n.charCodeAt(r),++a,++r,a===this.blockSize){this.compress_(o),a=0;break}}else for(;r<t;)if(o[a]=n[r],++a,++r,a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=t}digest(){const n=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let o=24;o>=0;o-=8)n[s]=this.chain_[r]>>o&255,++s;return n}}const v=function(i,n,t,s){let r;if(s<n?r="at least "+n:s>t&&(r=0===t?"none":"no more than "+t),r)throw new Error(i+" failed: Was called with "+s+(1===s?" argument.":" arguments.")+" Expects "+r+".")};function H(i,n){return`${i} failed: ${n} argument `}function O(i,n,t,s){if((!s||t)&&"function"!=typeof t)throw new Error(H(i,n)+"must be a valid function.")}function fs(i,n,t,s){if((!s||t)&&("object"!=typeof t||null===t))throw new Error(H(i,n)+"must be a valid context object.")}const Qt=function(i){let n=0;for(let t=0;t<i.length;t++){const s=i.charCodeAt(t);s<128?n++:s<2048?n+=2:s>=55296&&s<=56319?(n+=4,t++):n+=3}return n};function z(i){return i&&i._delegate?i._delegate:i}class Dn{constructor(n,t,s){this.name=n,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(n){return this.instantiationMode=n,this}setMultipleInstances(n){return this.multipleInstances=n,this}setServiceProps(n){return this.serviceProps=n,this}setInstanceCreatedCallback(n){return this.onInstanceCreated=n,this}}const Ne="[DEFAULT]";class ps{constructor(n,t){this.name=n,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(n){const t=this.normalizeInstanceIdentifier(n);if(!this.instancesDeferred.has(t)){const s=new B;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&s.resolve(r)}catch(r){}}return this.instancesDeferred.get(t).promise}getImmediate(n){var t;const s=this.normalizeInstanceIdentifier(null==n?void 0:n.identifier),r=null!==(t=null==n?void 0:n.optional)&&void 0!==t&&t;if(!this.isInitialized(s)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(r)return null;throw o}}getComponent(){return this.component}setComponent(n){if(n.name!==this.name)throw Error(`Mismatching Component ${n.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=n,this.shouldAutoInitialize()){if(function zl(i){return"EAGER"===i.instantiationMode}(n))try{this.getOrInitializeService({instanceIdentifier:Ne})}catch(t){}for(const[t,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:r});s.resolve(o)}catch(o){}}}}clearInstance(n=Ne){this.instancesDeferred.delete(n),this.instancesOptions.delete(n),this.instances.delete(n)}delete(){var n=this;return(0,rs.Z)(function*(){const t=Array.from(n.instances.values());yield Promise.all([...t.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...t.filter(s=>"_delete"in s).map(s=>s._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(n=Ne){return this.instances.has(n)}getOptions(n=Ne){return this.instancesOptions.get(n)||{}}initialize(n={}){const{options:t={}}=n,s=this.normalizeInstanceIdentifier(n.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[o,a]of this.instancesDeferred.entries())s===this.normalizeInstanceIdentifier(o)&&a.resolve(r);return r}onInit(n,t){var s;const r=this.normalizeInstanceIdentifier(t),o=null!==(s=this.onInitCallbacks.get(r))&&void 0!==s?s:new Set;o.add(n),this.onInitCallbacks.set(r,o);const a=this.instances.get(r);return a&&n(a,r),()=>{o.delete(n)}}invokeOnInitCallbacks(n,t){const s=this.onInitCallbacks.get(t);if(s)for(const r of s)try{r(n,t)}catch(o){}}getOrInitializeService({instanceIdentifier:n,options:t={}}){let s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(i=n,i===Ne?void 0:i),options:t}),this.instances.set(n,s),this.instancesOptions.set(n,t),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(r){}var i;return s||null}normalizeInstanceIdentifier(n=Ne){return this.component?this.component.multipleInstances?n:Ne:n}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Gl{constructor(n){this.name=n,this.providers=new Map}addComponent(n){const t=this.getProvider(n.name);if(t.isComponentSet())throw new Error(`Component ${n.name} has already been registered with ${this.name}`);t.setComponent(n)}addOrOverwriteComponent(n){this.getProvider(n.name).isComponentSet()&&this.providers.delete(n.name),this.addComponent(n)}getProvider(n){if(this.providers.has(n))return this.providers.get(n);const t=new ps(n,this);return this.providers.set(n,t),t}getProviders(){return Array.from(this.providers.values())}}var Ht=y(9206);const Mn=[];var I=(()=>{return(i=I||(I={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT",I;var i})();const gs={debug:I.DEBUG,verbose:I.VERBOSE,info:I.INFO,warn:I.WARN,error:I.ERROR,silent:I.SILENT},jl=I.INFO,Kl={[I.DEBUG]:"log",[I.VERBOSE]:"log",[I.INFO]:"info",[I.WARN]:"warn",[I.ERROR]:"error"},$l=(i,n,...t)=>{if(n<i.logLevel)return;const s=(new Date).toISOString(),r=Kl[n];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${n})`);console[r](`[${s}]  ${i.name}:`,...t)};class _s{constructor(n){this.name=n,this._logLevel=jl,this._logHandler=$l,this._userLogHandler=null,Mn.push(this)}get logLevel(){return this._logLevel}set logLevel(n){if(!(n in I))throw new TypeError(`Invalid value "${n}" assigned to \`logLevel\``);this._logLevel=n}setLogLevel(n){this._logLevel="string"==typeof n?gs[n]:n}get logHandler(){return this._logHandler}set logHandler(n){if("function"!=typeof n)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=n}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...n){this._userLogHandler&&this._userLogHandler(this,I.DEBUG,...n),this._logHandler(this,I.DEBUG,...n)}log(...n){this._userLogHandler&&this._userLogHandler(this,I.VERBOSE,...n),this._logHandler(this,I.VERBOSE,...n)}info(...n){this._userLogHandler&&this._userLogHandler(this,I.INFO,...n),this._logHandler(this,I.INFO,...n)}warn(...n){this._userLogHandler&&this._userLogHandler(this,I.WARN,...n),this._logHandler(this,I.WARN,...n)}error(...n){this._userLogHandler&&this._userLogHandler(this,I.ERROR,...n),this._logHandler(this,I.ERROR,...n)}}const ms="@firebase/database";let Fn="";function ys(i){Fn=i}class Xl{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,t){null==t?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),P(t))}get(n){const t=this.domStorage_.getItem(this.prefixedName_(n));return null==t?null:rt(t)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}}class ec{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,t){null==t?delete this.cache_[n]:this.cache_[n]=t}get(n){return te(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}}const bs=function(i){try{if("undefined"!=typeof window&&void 0!==window[i]){const n=window[i];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new Xl(n)}}catch(n){}return new ec},Ue=bs("localStorage"),Qn=bs("sessionStorage"),Je=new _s("@firebase/database"),Cs=function(){let i=1;return function(){return i++}}(),Ts=function(i){const n=function(i){const n=[];let t=0;for(let s=0;s<i.length;s++){let r=i.charCodeAt(s);if(r>=55296&&r<=56319){const o=r-55296;s++,g(s<i.length,"Surrogate pair missing trail surrogate."),r=65536+(o<<10)+(i.charCodeAt(s)-56320)}r<128?n[t++]=r:r<2048?(n[t++]=r>>6|192,n[t++]=63&r|128):r<65536?(n[t++]=r>>12|224,n[t++]=r>>6&63|128,n[t++]=63&r|128):(n[t++]=r>>18|240,n[t++]=r>>12&63|128,n[t++]=r>>6&63|128,n[t++]=63&r|128)}return n}(i),t=new Dl;t.update(n);const s=t.digest();return Ln.encodeByteArray(s)},ot=function(...i){let n="";for(let t=0;t<i.length;t++){const s=i[t];Array.isArray(s)||s&&"object"==typeof s&&"number"==typeof s.length?n+=ot.apply(null,s):n+="object"==typeof s?P(s):s,n+=" "}return n};let ke=null,Zs=!0;const As=function(i,n){g(!n||!0===i||!1===i,"Can't turn on custom loggers persistently."),!0===i?(Je.logLevel=I.VERBOSE,ke=Je.log.bind(Je),n&&Qn.set("logging_enabled",!0)):"function"==typeof i?ke=i:(ke=null,Qn.remove("logging_enabled"))},D=function(...i){if(!0===Zs&&(Zs=!1,null===ke&&!0===Qn.get("logging_enabled")&&As(!0)),ke){const n=ot.apply(null,i);ke(n)}},at=function(i){return function(...n){D(i,...n)}},Hn=function(...i){const n="FIREBASE INTERNAL ERROR: "+ot(...i);Je.error(n)},oe=function(...i){const n=`FIREBASE FATAL ERROR: ${ot(...i)}`;throw Je.error(n),new Error(n)},V=function(...i){const n="FIREBASE WARNING: "+ot(...i);Je.warn(n)},Vt=function(i){return"number"==typeof i&&(i!=i||i===Number.POSITIVE_INFINITY||i===Number.NEGATIVE_INFINITY)},he="[MIN_NAME]",ae="[MAX_NAME]",qe=function(i,n){if(i===n)return 0;if(i===he||n===ae)return-1;if(n===he||i===ae)return 1;{const t=Jt(i),s=Jt(n);return null!==t?null!==s?t-s==0?i.length-n.length:t-s:-1:null!==s?1:i<n?-1:1}},ic=function(i,n){return i===n?0:i<n?-1:1},lt=function(i,n){if(n&&i in n)return n[i];throw new Error("Missing required key ("+i+") in object: "+P(n))},Vn=function(i){if("object"!=typeof i||null===i)return P(i);const n=[];for(const s in i)n.push(s);n.sort();let t="{";for(let s=0;s<n.length;s++)0!==s&&(t+=","),t+=P(n[s]),t+=":",t+=Vn(i[n[s]]);return t+="}",t},ws=function(i,n){const t=i.length;if(t<=n)return[i];const s=[];for(let r=0;r<t;r+=n)s.push(i.substring(r,r+n>t?t:r+n));return s};function M(i,n){for(const t in i)i.hasOwnProperty(t)&&n(t,i[t])}const xs=function(i){g(!Vt(i),"Invalid JSON number");const s=1023;let r,o,a,l,c;0===i?(o=0,a=0,r=1/i==-1/0?1:0):(r=i<0,(i=Math.abs(i))>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(i)/Math.LN2),s),o=l+s,a=Math.round(i*Math.pow(2,52-l)-Math.pow(2,52))):(o=0,a=Math.round(i/Math.pow(2,-1074))));const u=[];for(c=52;c;c-=1)u.push(a%2?1:0),a=Math.floor(a/2);for(c=11;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(r?1:0),u.reverse();const f=u.join("");let d="";for(c=0;c<64;c+=8){let p=parseInt(f.substr(c,8),2).toString(16);1===p.length&&(p="0"+p),d+=p}return d.toLowerCase()},ac=new RegExp("^-?(0*)\\d{1,10}$"),Ss=-2147483648,Jn=2147483647,Jt=function(i){if(ac.test(i)){const n=Number(i);if(n>=Ss&&n<=Jn)return n}return null},Be=function(i){try{i()}catch(n){setTimeout(()=>{throw V("Exception was thrown by user callback.",n.stack||""),n},Math.floor(0))}},ct=function(i,n){const t=setTimeout(i,n);return"object"==typeof t&&t.unref&&t.unref(),t};class cc{constructor(n,t){this.appName_=n,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(s=>this.appCheck=s)}getToken(n){return this.appCheck?this.appCheck.getToken(n):new Promise((t,s)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(t,s):t(null)},0)})}addTokenChangeListener(n){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(s=>s.addTokenListener(n))}notifyForInvalidToken(){V(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class uc{constructor(n,t,s){this.appName_=n,this.firebaseOptions_=t,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(t=>t&&"auth/token-not-initialized"===t.code?(D("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,s)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(t,s):t(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(t=>t.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(t=>t.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';n+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',V(n)}}let ut=(()=>{class i{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return i.OWNER="owner",i})();const ks=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ls="websocket",Ps="long_polling";class Yn{constructor(n,t,s,r,o=!1,a="",l=!1){this.secure=t,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=a,this.includeNamespaceInQueryParams=l,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ue.get("host:"+n)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&Ue.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function Rs(i,n,t){let s;if(g("string"==typeof n,"typeof type must == string"),g("object"==typeof t,"typeof params must == object"),n===Ls)s=(i.secure?"wss://":"ws://")+i.internalHost+"/.ws?";else{if(n!==Ps)throw new Error("Unknown connection type: "+n);s=(i.secure?"https://":"http://")+i.internalHost+"/.lp?"}(function hc(i){return i.host!==i.internalHost||i.isCustomHost()||i.includeNamespaceInQueryParams})(i)&&(t.ns=i.namespace);const r=[];return M(t,(o,a)=>{r.push(o+"="+a)}),s+r.join("&")}class fc{constructor(){this.counters_={}}incrementCounter(n,t=1){te(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=t}get(){return wl(this.counters_)}}const Wn={},zn={};function Gn(i){const n=i.toString();return Wn[n]||(Wn[n]=new fc),Wn[n]}class gc{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,t){this.closeAfterResponse=n,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,t){for(this.pendingResponses[n]=t;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&Be(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Ye{constructor(n,t,s,r,o,a,l){this.connId=n,this.repoInfo=t,this.applicationId=s,this.appCheckToken=r,this.authToken=o,this.transportSessionId=a,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=at(n),this.stats_=Gn(t),this.urlFn=c=>(this.appCheckToken&&(c.ac=this.appCheckToken),Rs(t,Ps,c))}open(n,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new gc(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(i){if("complete"===document.readyState)i();else{let n=!1;const t=function(){document.body?n||(n=!0,i()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new jn((...o)=>{const[a,l,c,u,f]=o;if(this.incrementIncomingBytes_(o),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===a)this.id=l,this.password=c;else{if("close"!==a)throw new Error("Unrecognized command received: "+a);l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_()}},(...o)=>{const[a,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(a,l)},()=>{this.onClosed_()},this.urlFn);const s={start:"t"};s.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(s.cb=this.scriptTagHolder.uniqueCallbackIdentifier),s.v="5",this.transportSessionId&&(s.s=this.transportSessionId),this.lastSessionId&&(s.ls=this.lastSessionId),this.applicationId&&(s.p=this.applicationId),this.appCheckToken&&(s.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&ks.test(location.hostname)&&(s.r="f");const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ye.forceAllow_=!0}static forceDisallow(){Ye.forceDisallow_=!0}static isAvailable(){return!(!Ye.forceAllow_&&(Ye.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){const t=P(n);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const s=as(t),r=ws(s,1840);for(let o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++}addDisconnectPingFrame(n,t){this.myDisconnFrame=document.createElement("iframe");const s={dframe:"t"};s.id=n,s.pw=t,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){const t=P(n).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class jn{constructor(n,t,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Cs(),window["pLPCommand"+this.uniqueCallbackIdentifier]=n,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=jn.createIFrame_();let o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(o='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){D("frame writing exception"),l.stack&&D(l.stack),D(l)}}}static createIFrame_(){const n=document.createElement("iframe");if(n.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(n);try{n.contentWindow.document||D("No IE domain setting required")}catch(t){const s=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,t){for(this.myID=n,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const n={};n.id=this.myID,n.pw=this.myPW,n.ser=this.currentSerial;let t=this.urlFn(n),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+s.length<=1870;){const a=this.pendingSegs.shift();s=s+"&seg"+r+"="+a.seg+"&ts"+r+"="+a.ts+"&d"+r+"="+a.d,r++}return t+=s,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(n,t,s){this.pendingSegs.push({seg:n,ts:t,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(n,t){this.outstandingRequests.add(t);const s=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(s,Math.floor(25e3));this.addTag(n,()=>{clearTimeout(r),s()})}addTag(n,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=n,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||"loaded"===r||"complete"===r)&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),t())},s.onerror=()=>{D("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch(s){}},Math.floor(1))}}let dt=null;"undefined"!=typeof MozWebSocket?dt=MozWebSocket:"undefined"!=typeof WebSocket&&(dt=WebSocket);let ht=(()=>{class i{constructor(t,s,r,o,a,l,c){this.connId=t,this.applicationId=r,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=at(this.connId),this.stats_=Gn(s),this.connURL=i.connectionURL_(s,l,c,o),this.nodeAdmin=s.nodeAdmin}static connectionURL_(t,s,r,o){const a={v:"5"};return"undefined"!=typeof location&&location.hostname&&ks.test(location.hostname)&&(a.r="f"),s&&(a.s=s),r&&(a.ls=r),o&&(a.ac=o),Rs(t,Ls,a)}open(t,s){this.onDisconnect=s,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ue.set("previous_websocket_failure",!0);try{this.mySock=new dt(this.connURL,[],{headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(r){this.log_("Error instantiating WebSocket.");const o=r.message||r.data;return o&&this.log_(o),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const o=r.message||r.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){i.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==dt&&!i.forceDisallow_}static previouslyFailed(){return Ue.isInMemoryStorage||!0===Ue.get("previous_websocket_failure")}markConnectionHealthy(){Ue.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const s=this.frames.join("");this.frames=null;const r=rt(s);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(g(null===this.frames,"We already have a frame buffer"),t.length<=6){const s=Number(t);if(!isNaN(s))return this.handleNewFrameCount_(s),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const s=t.data;if(this.bytesReceived+=s.length,this.stats_.incrementCounter("bytes_received",s.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(s);else{const r=this.extractFrameCount_(s);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const s=P(t);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);const r=ws(s,16384);r.length>1&&this.sendString_(String(r.length));for(let o=0;o<r.length;o++)this.sendString_(r[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(s){this.log_("Exception thrown from WebSocket.send():",s.message||s.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return i.responsesRequiredToBeHealthy=2,i.healthyTimeout=3e4,i})();class Kn{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Ye,ht]}initTransports_(n){const t=ht&&ht.isAvailable();let s=t&&!ht.previouslyFailed();if(n.webSocketOnly&&(t||V("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[ht];else{const r=this.transports_=[];for(const o of Kn.ALL_TRANSPORTS)o&&o.isAvailable()&&r.push(o)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}class Gs{constructor(n,t,s,r,o,a,l,c,u,f){this.id=n,this.repoInfo_=t,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=a,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=f,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=at("c:"+this.id+":"),this.transportManager_=new Kn(t),this.log_("Connection created"),this.start_()}start_(){const n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,s)},Math.floor(0));const r=n.healthyTimeout||0;r>0&&(this.healthyTimeout_=ct(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return t=>{n===this.conn_?this.onConnectionLost_(t):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return t=>{2!==this.state_&&(n===this.rx_?this.onPrimaryMessageReceived_(t):n===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(n){this.sendData_({t:"d",d:n})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if("t"in n){const t=n.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){const t=lt("t",n),s=lt("d",n);if("c"===t)this.onSecondaryControl_(s);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(s)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){const t=lt("t",n),s=lt("d",n);"c"===t?this.onControl_(s):"d"===t&&this.onDataMessage_(s)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){const t=lt("t",n);if("d"in n){const s=n.d;if("h"===t)this.onHandshake_(s);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(s):"r"===t?this.onReset_(s):"e"===t?Hn("Server Error: "+s):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hn("Unknown control packet command: "+t)}}onHandshake_(n){const t=n.ts,s=n.v,r=n.h;this.sessionId=n.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==s&&V("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,s),ct(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,t){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ct(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,n||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ue.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(n)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class js{put(n,t,s,r){}merge(n,t,s,r){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,t,s){}onDisconnectMerge(n,t,s){}onDisconnectCancel(n,t){}reportStats(n){}}class Ks{constructor(n){this.allowedEvents_=n,this.listeners_={},g(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...t){if(Array.isArray(this.listeners_[n])){const s=[...this.listeners_[n]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,t)}}on(n,t,s){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:t,context:s});const r=this.getInitialEvent(n);r&&t.apply(s,r)}off(n,t,s){this.validateEventType_(n);const r=this.listeners_[n]||[];for(let o=0;o<r.length;o++)if(r[o].callback===t&&(!s||s===r[o].context))return void r.splice(o,1)}validateEventType_(n){g(this.allowedEvents_.find(t=>t===n),"Unknown event: "+n)}}class Yt extends Ks{constructor(){super(["online"]),this.online_=!0,"undefined"!=typeof window&&void 0!==window.addEventListener&&!ds()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Yt}getInitialEvent(n){return g("online"===n,"Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}}class x{constructor(n,t){if(void 0===t){this.pieces_=n.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=t}toString(){let n="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(n+="/"+this.pieces_[t]);return n||"/"}}function w(){return new x("")}function C(i){return i.pieceNum_>=i.pieces_.length?null:i.pieces_[i.pieceNum_]}function ve(i){return i.pieces_.length-i.pieceNum_}function N(i){let n=i.pieceNum_;return n<i.pieces_.length&&n++,new x(i.pieces_,n)}function Xn(i){return i.pieceNum_<i.pieces_.length?i.pieces_[i.pieces_.length-1]:null}function ft(i,n=0){return i.pieces_.slice(i.pieceNum_+n)}function er(i){if(i.pieceNum_>=i.pieces_.length)return null;const n=[];for(let t=i.pieceNum_;t<i.pieces_.length-1;t++)n.push(i.pieces_[t]);return new x(n,0)}function q(i,n){const t=[];for(let s=i.pieceNum_;s<i.pieces_.length;s++)t.push(i.pieces_[s]);if(n instanceof x)for(let s=n.pieceNum_;s<n.pieces_.length;s++)t.push(n.pieces_[s]);else{const s=n.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&t.push(s[r])}return new x(t,0)}function T(i){return i.pieceNum_>=i.pieces_.length}function J(i,n){const t=C(i),s=C(n);if(null===t)return n;if(t===s)return J(N(i),N(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+i+")")}function Oc(i,n){const t=ft(i,0),s=ft(n,0);for(let r=0;r<t.length&&r<s.length;r++){const o=qe(t[r],s[r]);if(0!==o)return o}return t.length===s.length?0:t.length<s.length?-1:1}function ei(i,n){if(ve(i)!==ve(n))return!1;for(let t=i.pieceNum_,s=n.pieceNum_;t<=i.pieces_.length;t++,s++)if(i.pieces_[t]!==n.pieces_[s])return!1;return!0}function j(i,n){let t=i.pieceNum_,s=n.pieceNum_;if(ve(i)>ve(n))return!1;for(;t<i.pieces_.length;){if(i.pieces_[t]!==n.pieces_[s])return!1;++t,++s}return!0}class Dc{constructor(n,t){this.errorPrefix_=t,this.parts_=ft(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Qt(this.parts_[s]);tr(this)}}function tr(i){if(i.byteLength_>768)throw new Error(i.errorPrefix_+"has a key path longer than 768 bytes ("+i.byteLength_+").");if(i.parts_.length>32)throw new Error(i.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Le(i))}function Le(i){return 0===i.parts_.length?"":"in property '"+i.parts_.join(".")+"'"}class ti extends Ks{constructor(){let n,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",n="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",n="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",n="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const s=!document[n];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new ti}getInitialEvent(n){return g("visible"===n,"Unknown event type: "+n),[this.visible_]}}const pt=1e3;let zt,Pe=(()=>{class i extends js{constructor(t,s,r,o,a,l,c,u){if(super(),this.repoInfo_=t,this.applicationId_=s,this.onDataUpdate_=r,this.onConnectStatus_=o,this.onServerInfoUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=i.nextPersistentConnectionId_++,this.log_=at("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=pt,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ti.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&Yt.getInstance().on("online",this.onOnline_,this)}sendRequest(t,s,r){const o=++this.requestNumber_,a={r:o,a:t,b:s};this.log_(P(a)),g(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(a),r&&(this.requestCBHash_[o]=r)}get(t){this.initConnection_();const s=new B,r={p:t._path.toString(),q:t._queryObject},o={action:"g",request:r,onComplete:l=>{const c=l.d;"ok"===l.s?(this.onDataUpdate_(r.p,c,!1,null),s.resolve(c)):s.reject(c)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;const a=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const l=this.outstandingGets_[a];void 0===l||o!==l||(delete this.outstandingGets_[a],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+a+" timed out on connection"),s.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(a),s.promise}listen(t,s,r,o){this.initConnection_();const a=t._queryIdentifier,l=t._path.toString();this.log_("Listen called for "+l+" "+a),this.listens.has(l)||this.listens.set(l,new Map),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),g(!this.listens.get(l).has(a),"listen() called twice for same path/queryId.");const c={onComplete:o,hashFn:s,query:t,tag:r};this.listens.get(l).set(a,c),this.connected_&&this.sendListen_(c)}sendGet_(t){const s=this.outstandingGets_[t];this.sendRequest("g",s.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),s.onComplete&&s.onComplete(r)})}sendListen_(t){const s=t.query,r=s._path.toString(),o=s._queryIdentifier;this.log_("Listen on "+r+" for "+o);const a={p:r};t.tag&&(a.q=s._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,c=>{const u=c.d,f=c.s;i.warnOnListenWarnings_(u,s),(this.listens.get(r)&&this.listens.get(r).get(o))===t&&(this.log_("listen response",c),"ok"!==f&&this.removeListen_(r,o),t.onComplete&&t.onComplete(f,u))})}static warnOnListenWarnings_(t,s){if(t&&"object"==typeof t&&te(t,"w")){const r=Ie(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const o='".indexOn": "'+s._queryParams.getIndex().toString()+'"',a=s._path.toString();V(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${a} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(i){const n=Mt(i).claims;return"object"==typeof n&&!0===n.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,s=function(i){const t=Mt(i).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(s,r,o=>{const a=o.s,l=o.d||"error";this.authToken_===t&&("ok"===a?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(a,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const s=t.s,r=t.d||"error";"ok"===s?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(s,r)})}unlisten(t,s){const r=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+o),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,o)&&this.connected_&&this.sendUnlisten_(r,o,t._queryObject,s)}sendUnlisten_(t,s,r,o){this.log_("Unlisten on "+t+" for "+s);const a={p:t};o&&(a.q=r,a.t=o),this.sendRequest("n",a)}onDisconnectPut(t,s,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,s,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:s,onComplete:r})}onDisconnectMerge(t,s,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,s,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:s,onComplete:r})}onDisconnectCancel(t,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,s):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:s})}sendOnDisconnect_(t,s,r,o){const a={p:s,d:r};this.log_("onDisconnect "+t,a),this.sendRequest(t,a,l=>{o&&setTimeout(()=>{o(l.s,l.d)},Math.floor(0))})}put(t,s,r,o){this.putInternal("p",t,s,r,o)}merge(t,s,r,o){this.putInternal("m",t,s,r,o)}putInternal(t,s,r,o,a){this.initConnection_();const l={p:s,d:r};void 0!==a&&(l.h=a),this.outstandingPuts_.push({action:t,request:l,onComplete:o}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+s)}sendPut_(t){const s=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(s,r,a=>{this.log_(s+" response",a),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),o&&o(a.s,a.d)})}reportStats(t){if(this.connected_){const s={c:t};this.log_("reportStats",s),this.sendRequest("s",s,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+P(t));const s=t.r,r=this.requestCBHash_[s];r&&(delete this.requestCBHash_[s],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,s){this.log_("handleServerMessage",t,s),"d"===t?this.onDataUpdate_(s.p,s.d,!1,s.t):"m"===t?this.onDataUpdate_(s.p,s.d,!0,s.t):"c"===t?this.onListenRevoked_(s.p,s.q):"ac"===t?this.onAuthRevoked_(s.s,s.d):"apc"===t?this.onAppCheckRevoked_(s.s,s.d):"sd"===t?this.onSecurityDebugPacket_(s):Hn("Unrecognized action received from server: "+P(t)+"\nAre you using the latest client?")}onReady_(t,s){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=s,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){g(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=pt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=pt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=pt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let s=Math.max(0,this.reconnectDelay_-t);s=Math.random()*s,this.log_("Trying to reconnect in "+s+"ms"),this.scheduleConnect_(s),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,rs.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const s=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),o=t.onRealtimeDisconnect_.bind(t),a=t.id+":"+i.nextConnectionId_++,l=t.lastSessionId;let c=!1,u=null;const f=function(){u?u.close():(c=!0,o())};t.realtime_={close:f,sendRequest:function(_){g(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(_)}};const p=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[_,m]=yield Promise.all([t.authTokenProvider_.getToken(p),t.appCheckTokenProvider_.getToken(p)]);c?D("getToken() completed but was canceled"):(D("getToken() completed. Creating connection."),t.authToken_=_&&_.accessToken,t.appCheckToken_=m&&m.token,u=new Gs(a,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,s,r,o,S=>{V(S+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},l))}catch(_){t.log_("Failed to get token: "+_),c||(t.repoInfo_.nodeAdmin&&V(_),f())}}})()}interrupt(t){D("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){D("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Rn(this.interruptReasons_)&&(this.reconnectDelay_=pt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const s=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:s})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const s=this.outstandingPuts_[t];s&&"h"in s.request&&s.queued&&(s.onComplete&&s.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,s){let r;r=s?s.map(a=>Vn(a)).join("$"):"default";const o=this.removeListen_(t,r);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,s){const r=new x(t).toString();let o;if(this.listens.has(r)){const a=this.listens.get(r);o=a.get(s),a.delete(s),0===a.size&&this.listens.delete(r)}else o=void 0;return o}onAuthRevoked_(t,s){D("Auth token revoked: "+t+"/"+s),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,s){D("App check token revoked: "+t+"/"+s),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const s of t.values())this.sendListen_(s);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let s="js";t["sdk."+s+"."+Fn.replace(/\./g,"-")]=1,ds()?t["framework.cordova"]=1:function Il(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Yt.getInstance().currentlyOnline();return Rn(this.interruptReasons_)&&t}}return i.nextPersistentConnectionId_=0,i.nextConnectionId_=0,i})();class Z{constructor(n,t){this.name=n,this.node=t}static Wrap(n,t){return new Z(n,t)}}class Wt{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,t){const s=new Z(he,n),r=new Z(he,t);return 0!==this.compare(s,r)}minPost(){return Z.MIN}}class sr extends Wt{static get __EMPTY_NODE(){return zt}static set __EMPTY_NODE(n){zt=n}compare(n,t){return qe(n.name,t.name)}isDefinedOn(n){throw Ve("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,t){return!1}minPost(){return Z.MIN}maxPost(){return new Z(ae,zt)}makePost(n,t){return g("string"==typeof n,"KeyIndex indexValue must always be a string."),new Z(n,zt)}toString(){return".key"}}const le=new sr;class Gt{constructor(n,t,s,r,o=null){this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let a=1;for(;!n.isEmpty();)if(n=n,a=t?s(n.key,t):1,r&&(a*=-1),a<0)n=this.isReverse_?n.left:n.right;else{if(0===a){this.nodeStack_.push(n);break}this.nodeStack_.push(n),n=this.isReverse_?n.right:n.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,n=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}}let ii,ne=(()=>{class i{constructor(t,s,r,o,a){this.key=t,this.value=s,this.color=null!=r?r:i.RED,this.left=null!=o?o:Y.EMPTY_NODE,this.right=null!=a?a:Y.EMPTY_NODE}copy(t,s,r,o,a){return new i(null!=t?t:this.key,null!=s?s:this.value,null!=r?r:this.color,null!=o?o:this.left,null!=a?a:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,s,r){let o=this;const a=r(t,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(t,s,r),null):0===a?o.copy(null,s,null,null,null):o.copy(null,null,null,null,o.right.insert(t,s,r)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return Y.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,s){let r,o;if(r=this,s(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,s),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===s(t,r.key)){if(r.right.isEmpty())return Y.EMPTY_NODE;o=r.right.min_(),r=r.copy(o.key,o.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,s))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,s)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return i.RED=!0,i.BLACK=!1,i})();class Y{constructor(n,t=Y.EMPTY_NODE){this.comparator_=n,this.root_=t}insert(n,t){return new Y(this.comparator_,this.root_.insert(n,t,this.comparator_).copy(null,null,ne.BLACK,null,null))}remove(n){return new Y(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,ne.BLACK,null,null))}get(n){let t,s=this.root_;for(;!s.isEmpty();){if(t=this.comparator_(n,s.key),0===t)return s.value;t<0?s=s.left:t>0&&(s=s.right)}return null}getPredecessorKey(n){let t,s=this.root_,r=null;for(;!s.isEmpty();){if(t=this.comparator_(n,s.key),0===t){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}t<0?s=s.left:t>0&&(r=s,s=s.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new Gt(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,t){return new Gt(this.root_,n,this.comparator_,!1,t)}getReverseIteratorFrom(n,t){return new Gt(this.root_,n,this.comparator_,!0,t)}getReverseIterator(n){return new Gt(this.root_,null,this.comparator_,!0,n)}}function Wc(i,n){return qe(i.name,n.name)}function ni(i,n){return qe(i,n)}Y.EMPTY_NODE=new class Yc{copy(n,t,s,r,o){return this}insert(n,t,s){return new ne(n,t,null)}remove(n,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const rr=function(i){return"number"==typeof i?"number:"+xs(i):"string:"+i},or=function(i){if(i.isLeafNode()){const n=i.val();g("string"==typeof n||"number"==typeof n||"object"==typeof n&&te(n,".sv"),"Priority must be a string or number.")}else g(i===ii||i.isEmpty(),"priority of unexpected type.");g(i===ii||i.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let ar,lr,cr,We=(()=>{class i{constructor(t,s=i.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=s,this.lazyHash_=null,g(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),or(this.priorityNode_)}static set __childrenNodeConstructor(t){ar=t}static get __childrenNodeConstructor(){return ar}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new i(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:i.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return T(t)?this:".priority"===C(t)?this.priorityNode_:i.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,s){return null}updateImmediateChild(t,s){return".priority"===t?this.updatePriority(s):s.isEmpty()&&".priority"!==t?this:i.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,s).updatePriority(this.priorityNode_)}updateChild(t,s){const r=C(t);return null===r?s:s.isEmpty()&&".priority"!==r?this:(g(".priority"!==r||1===ve(t),".priority must be the last token in a path"),this.updateImmediateChild(r,i.__childrenNodeConstructor.EMPTY_NODE.updateChild(N(t),s)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,s){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+rr(this.priorityNode_.val())+":");const s=typeof this.value_;t+=s+":",t+="number"===s?xs(this.value_):this.value_,this.lazyHash_=Ts(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===i.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof i.__childrenNodeConstructor?-1:(g(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const s=typeof t.value_,r=typeof this.value_,o=i.VALUE_TYPE_ORDER.indexOf(s),a=i.VALUE_TYPE_ORDER.indexOf(r);return g(o>=0,"Unknown leaf type: "+s),g(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const s=t;return this.value_===s.value_&&this.priorityNode_.equals(s.priorityNode_)}return!1}}return i.VALUE_TYPE_ORDER=["object","boolean","number","string"],i})();const U=new class Kc extends Wt{compare(n,t){const s=n.node.getPriority(),r=t.node.getPriority(),o=s.compareTo(r);return 0===o?qe(n.name,t.name):o}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,t){return!n.getPriority().equals(t.getPriority())}minPost(){return Z.MIN}maxPost(){return new Z(ae,new We("[PRIORITY-POST]",cr))}makePost(n,t){const s=lr(n);return new Z(t,new We("[PRIORITY-POST]",s))}toString(){return".priority"}},$c=Math.log(2);class Xc{constructor(n){this.count=parseInt(Math.log(n+1)/$c,10),this.current_=this.count-1;const r=(o=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=n+1&r}nextBitIsOne(){const n=!(this.bits_&1<<this.current_);return this.current_--,n}}const jt=function(i,n,t,s){i.sort(n);const r=function(c,u){const f=u-c;let d,p;if(0===f)return null;if(1===f)return d=i[c],p=t?t(d):d,new ne(p,d.node,ne.BLACK,null,null);{const _=parseInt(f/2,10)+c,m=r(c,_),S=r(_+1,u);return d=i[_],p=t?t(d):d,new ne(p,d.node,ne.BLACK,m,S)}},l=function(c){let u=null,f=null,d=i.length;const p=function(m,S){const F=d-m,He=d;d-=m;const ge=r(F+1,He),it=i[F],Vp=t?t(it):it;_(new ne(Vp,it.node,S,null,ge))},_=function(m){u?(u.left=m,u=m):(f=m,u=m)};for(let m=0;m<c.count;++m){const S=c.nextBitIsOne(),F=Math.pow(2,c.count-(m+1));S?p(F,ne.BLACK):(p(F,ne.BLACK),p(F,ne.RED))}return f}(new Xc(i.length));return new Y(s||n,l)};let si;const ze={};class fe{constructor(n,t){this.indexes_=n,this.indexSet_=t}static get Default(){return g(ze&&U,"ChildrenNode.ts has not been loaded"),si=si||new fe({".priority":ze},{".priority":U}),si}get(n){const t=Ie(this.indexes_,n);if(!t)throw new Error("No index defined for "+n);return t instanceof Y?t:null}hasIndex(n){return te(this.indexSet_,n.toString())}addIndex(n,t){g(n!==le,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const o=t.getIterator(Z.Wrap);let l,a=o.getNext();for(;a;)r=r||n.isDefinedOn(a.node),s.push(a),a=o.getNext();l=r?jt(s,n.getCompare()):ze;const c=n.toString(),u=Object.assign({},this.indexSet_);u[c]=n;const f=Object.assign({},this.indexes_);return f[c]=l,new fe(f,u)}addToIndexes(n,t){const s=Ft(this.indexes_,(r,o)=>{const a=Ie(this.indexSet_,o);if(g(a,"Missing index implementation for "+o),r===ze){if(a.isDefinedOn(n.node)){const l=[],c=t.getIterator(Z.Wrap);let u=c.getNext();for(;u;)u.name!==n.name&&l.push(u),u=c.getNext();return l.push(n),jt(l,a.getCompare())}return ze}{const l=t.get(n.name);let c=r;return l&&(c=c.remove(new Z(n.name,l))),c.insert(n,n.node)}});return new fe(s,this.indexSet_)}removeFromIndexes(n,t){const s=Ft(this.indexes_,r=>{if(r===ze)return r;{const o=t.get(n.name);return o?r.remove(new Z(n.name,o)):r}});return new fe(s,this.indexSet_)}}let gt,b=(()=>{class i{constructor(t,s,r){this.children_=t,this.priorityNode_=s,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&or(this.priorityNode_),this.children_.isEmpty()&&g(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return gt||(gt=new i(new Y(ni),null,fe.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||gt}updatePriority(t){return this.children_.isEmpty()?this:new i(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const s=this.children_.get(t);return null===s?gt:s}}getChild(t){const s=C(t);return null===s?this:this.getImmediateChild(s).getChild(N(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,s){if(g(s,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(s);{const r=new Z(t,s);let o,a;s.isEmpty()?(o=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(t,s),a=this.indexMap_.addToIndexes(r,this.children_));const l=o.isEmpty()?gt:this.priorityNode_;return new i(o,l,a)}}updateChild(t,s){const r=C(t);if(null===r)return s;{g(".priority"!==C(t)||1===ve(t),".priority must be the last token in a path");const o=this.getImmediateChild(r).updateChild(N(t),s);return this.updateImmediateChild(r,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const s={};let r=0,o=0,a=!0;if(this.forEachChild(U,(l,c)=>{s[l]=c.val(t),r++,a&&i.INTEGER_REGEXP_.test(l)?o=Math.max(o,Number(l)):a=!1}),!t&&a&&o<2*r){const l=[];for(const c in s)l[c]=s[c];return l}return t&&!this.getPriority().isEmpty()&&(s[".priority"]=this.getPriority().val()),s}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+rr(this.getPriority().val())+":"),this.forEachChild(U,(s,r)=>{const o=r.hash();""!==o&&(t+=":"+s+":"+o)}),this.lazyHash_=""===t?"":Ts(t)}return this.lazyHash_}getPredecessorChildName(t,s,r){const o=this.resolveIndex_(r);if(o){const a=o.getPredecessorKey(new Z(t,s));return a?a.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const s=this.resolveIndex_(t);if(s){const r=s.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const s=this.getFirstChildName(t);return s?new Z(s,this.children_.get(s)):null}getLastChildName(t){const s=this.resolveIndex_(t);if(s){const r=s.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const s=this.getLastChildName(t);return s?new Z(s,this.children_.get(s)):null}forEachChild(t,s){const r=this.resolveIndex_(t);return r?r.inorderTraversal(o=>s(o.name,o.node)):this.children_.inorderTraversal(s)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,s){const r=this.resolveIndex_(s);if(r)return r.getIteratorFrom(t,o=>o);{const o=this.children_.getIteratorFrom(t.name,Z.Wrap);let a=o.peek();for(;null!=a&&s.compare(a,t)<0;)o.getNext(),a=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,s){const r=this.resolveIndex_(s);if(r)return r.getReverseIteratorFrom(t,o=>o);{const o=this.children_.getReverseIteratorFrom(t.name,Z.Wrap);let a=o.peek();for(;null!=a&&s.compare(a,t)>0;)o.getNext(),a=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===_t?-1:0}withIndex(t){if(t===le||this.indexMap_.hasIndex(t))return this;{const s=this.indexMap_.addIndex(t,this.children_);return new i(this.children_,this.priorityNode_,s)}}isIndexed(t){return t===le||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const s=t;if(this.getPriority().equals(s.getPriority())){if(this.children_.count()===s.children_.count()){const r=this.getIterator(U),o=s.getIterator(U);let a=r.getNext(),l=o.getNext();for(;a&&l;){if(a.name!==l.name||!a.node.equals(l.node))return!1;a=r.getNext(),l=o.getNext()}return null===a&&null===l}return!1}return!1}}resolveIndex_(t){return t===le?null:this.indexMap_.get(t.toString())}}return i.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,i})();const _t=new class eu extends b{constructor(){super(new Y(ni),b.EMPTY_NODE,fe.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return b.EMPTY_NODE}isEmpty(){return!1}};function L(i,n=null){if(null===i)return b.EMPTY_NODE;if("object"==typeof i&&".priority"in i&&(n=i[".priority"]),g(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+typeof n),"object"==typeof i&&".value"in i&&null!==i[".value"]&&(i=i[".value"]),"object"!=typeof i||".sv"in i)return new We(i,L(n));if(i instanceof Array){let t=b.EMPTY_NODE;return M(i,(s,r)=>{if(te(i,s)&&"."!==s.substring(0,1)){const o=L(r);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(s,o))}}),t.updatePriority(L(n))}{const t=[];let s=!1;if(M(i,(a,l)=>{if("."!==a.substring(0,1)){const c=L(l);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),t.push(new Z(a,c)))}}),0===t.length)return b.EMPTY_NODE;const o=jt(t,Wc,a=>a.name,ni);if(s){const a=jt(t,U.getCompare());return new b(o,L(n),new fe({".priority":a},{".priority":U}))}return new b(o,L(n),fe.Default)}}Object.defineProperties(Z,{MIN:{value:new Z(he,b.EMPTY_NODE)},MAX:{value:new Z(ae,_t)}}),sr.__EMPTY_NODE=b.EMPTY_NODE,We.__childrenNodeConstructor=b,function zc(i){ii=i}(_t),function jc(i){cr=i}(_t),function Gc(i){lr=i}(L);class ri extends Wt{constructor(n){super(),this.indexPath_=n,g(!T(n)&&".priority"!==C(n),"Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,t){const s=this.extractChild(n.node),r=this.extractChild(t.node),o=s.compareTo(r);return 0===o?qe(n.name,t.name):o}makePost(n,t){const s=L(n),r=b.EMPTY_NODE.updateChild(this.indexPath_,s);return new Z(t,r)}maxPost(){const n=b.EMPTY_NODE.updateChild(this.indexPath_,_t);return new Z(ae,n)}toString(){return ft(this.indexPath_,0).join("/")}}const oi=new class nu extends Wt{compare(n,t){const s=n.node.compareTo(t.node);return 0===s?qe(n.name,t.name):s}isDefinedOn(n){return!0}indexedValueChanged(n,t){return!n.equals(t)}minPost(){return Z.MIN}maxPost(){return Z.MAX}makePost(n,t){const s=L(n);return new Z(t,s)}toString(){return".value"}},Ge="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",iu=function(){let i=0;const n=[];return function(t){const s=t===i;let r;i=t;const o=new Array(8);for(r=7;r>=0;r--)o[r]=Ge.charAt(t%64),t=Math.floor(t/64);g(0===t,"Cannot push at time == 0");let a=o.join("");if(s){for(r=11;r>=0&&63===n[r];r--)n[r]=0;n[r]++}else for(r=0;r<12;r++)n[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)a+=Ge.charAt(n[r]);return g(20===a.length,"nextPushId: Length should be 20."),a}}(),hr=function(i){if(i===""+Jn)return"-";const n=Jt(i);if(null!=n)return""+(n+1);const t=new Array(i.length);for(let a=0;a<t.length;a++)t[a]=i.charAt(a);if(t.length<786)return t.push("-"),t.join("");let s=t.length-1;for(;s>=0&&"z"===t[s];)s--;if(-1===s)return ae;const o=Ge.charAt(Ge.indexOf(t[s])+1);return t[s]=o,t.slice(0,s+1).join("")},fr=function(i){if(i===""+Ss)return he;const n=Jt(i);if(null!=n)return""+(n-1);const t=new Array(i.length);for(let s=0;s<t.length;s++)t[s]=i.charAt(s);return"-"===t[t.length-1]?1===t.length?""+Jn:(delete t[t.length-1],t.join("")):(t[t.length-1]=Ge.charAt(Ge.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function pr(i){return{type:"value",snapshotNode:i}}function je(i,n){return{type:"child_added",snapshotNode:n,childName:i}}function mt(i,n){return{type:"child_removed",snapshotNode:n,childName:i}}function vt(i,n,t){return{type:"child_changed",snapshotNode:n,childName:i,oldSnap:t}}class li{constructor(n){this.index_=n}updateChild(n,t,s,r,o,a){g(n.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=n.getImmediateChild(t);return l.getChild(r).equals(s.getChild(r))&&l.isEmpty()===s.isEmpty()||(null!=a&&(s.isEmpty()?n.hasChild(t)?a.trackChildChange(mt(t,l)):g(n.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?a.trackChildChange(je(t,s)):a.trackChildChange(vt(t,s,l))),n.isLeafNode()&&s.isEmpty())?n:n.updateImmediateChild(t,s).withIndex(this.index_)}updateFullNode(n,t,s){return null!=s&&(n.isLeafNode()||n.forEachChild(U,(r,o)=>{t.hasChild(r)||s.trackChildChange(mt(r,o))}),t.isLeafNode()||t.forEachChild(U,(r,o)=>{if(n.hasChild(r)){const a=n.getImmediateChild(r);a.equals(o)||s.trackChildChange(vt(r,o,a))}else s.trackChildChange(je(r,o))})),t.withIndex(this.index_)}updatePriority(n,t){return n.isEmpty()?b.EMPTY_NODE:n.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class yt{constructor(n){this.indexedFilter_=new li(n.getIndex()),this.index_=n.getIndex(),this.startPost_=yt.getStartPost_(n),this.endPost_=yt.getEndPost_(n)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(n){return this.index_.compare(this.getStartPost(),n)<=0&&this.index_.compare(n,this.getEndPost())<=0}updateChild(n,t,s,r,o,a){return this.matches(new Z(t,s))||(s=b.EMPTY_NODE),this.indexedFilter_.updateChild(n,t,s,r,o,a)}updateFullNode(n,t,s){t.isLeafNode()&&(t=b.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(b.EMPTY_NODE);const o=this;return t.forEachChild(U,(a,l)=>{o.matches(new Z(a,l))||(r=r.updateImmediateChild(a,b.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(n,r,s)}updatePriority(n,t){return n}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(n){if(n.hasStart()){const t=n.getIndexStartName();return n.getIndex().makePost(n.getIndexStartValue(),t)}return n.getIndex().minPost()}static getEndPost_(n){if(n.hasEnd()){const t=n.getIndexEndName();return n.getIndex().makePost(n.getIndexEndValue(),t)}return n.getIndex().maxPost()}}class ru{constructor(n){this.rangedFilter_=new yt(n),this.index_=n.getIndex(),this.limit_=n.getLimit(),this.reverse_=!n.isViewFromLeft()}updateChild(n,t,s,r,o,a){return this.rangedFilter_.matches(new Z(t,s))||(s=b.EMPTY_NODE),n.getImmediateChild(t).equals(s)?n:n.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(n,t,s,r,o,a):this.fullLimitUpdateChild_(n,t,s,o,a)}updateFullNode(n,t,s){let r;if(t.isLeafNode()||t.isEmpty())r=b.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let o;r=b.EMPTY_NODE.withIndex(this.index_),o=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;o.hasNext()&&a<this.limit_;){const l=o.getNext();let c;if(c=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),l)<=0:this.index_.compare(l,this.rangedFilter_.getEndPost())<=0,!c)break;r=r.updateImmediateChild(l.name,l.node),a++}}else{let o,a,l,c;if(r=t.withIndex(this.index_),r=r.updatePriority(b.EMPTY_NODE),this.reverse_){c=r.getReverseIterator(this.index_),o=this.rangedFilter_.getEndPost(),a=this.rangedFilter_.getStartPost();const d=this.index_.getCompare();l=(p,_)=>d(_,p)}else c=r.getIterator(this.index_),o=this.rangedFilter_.getStartPost(),a=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();let u=0,f=!1;for(;c.hasNext();){const d=c.getNext();!f&&l(o,d)<=0&&(f=!0),f&&u<this.limit_&&l(d,a)<=0?u++:r=r.updateImmediateChild(d.name,b.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(n,r,s)}updatePriority(n,t){return n}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(n,t,s,r,o){let a;if(this.reverse_){const d=this.index_.getCompare();a=(p,_)=>d(_,p)}else a=this.index_.getCompare();const l=n;g(l.numChildren()===this.limit_,"");const c=new Z(t,s),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),f=this.rangedFilter_.matches(c);if(l.hasChild(t)){const d=l.getImmediateChild(t);let p=r.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=p&&(p.name===t||l.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);const _=null==p?1:a(p,c);if(f&&!s.isEmpty()&&_>=0)return null!=o&&o.trackChildChange(vt(t,s,d)),l.updateImmediateChild(t,s);{null!=o&&o.trackChildChange(mt(t,d));const S=l.updateImmediateChild(t,b.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=o&&o.trackChildChange(je(p.name,p.node)),S.updateImmediateChild(p.name,p.node)):S}}return s.isEmpty()?n:f&&a(u,c)>=0?(null!=o&&(o.trackChildChange(mt(u.name,u.node)),o.trackChildChange(je(t,s))),l.updateImmediateChild(t,s).updateImmediateChild(u.name,b.EMPTY_NODE)):n}}class Kt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=U}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return g(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return g(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:he}hasEnd(){return this.endSet_}getIndexEndValue(){return g(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return g(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ae}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return g(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===U}copy(){const n=new Kt;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}}function ci(i,n,t){const s=i.copy();return s.startSet_=!0,void 0===n&&(n=null),s.indexStartValue_=n,null!=t?(s.startNameSet_=!0,s.indexStartName_=t):(s.startNameSet_=!1,s.indexStartName_=""),s}function ui(i,n,t){const s=i.copy();return s.endSet_=!0,void 0===n&&(n=null),s.indexEndValue_=n,void 0!==t?(s.endNameSet_=!0,s.indexEndName_=t):(s.endNameSet_=!1,s.indexEndName_=""),s}function $t(i,n){const t=i.copy();return t.index_=n,t}function gr(i){const n={};if(i.isDefault())return n;let t;return i.index_===U?t="$priority":i.index_===oi?t="$value":i.index_===le?t="$key":(g(i.index_ instanceof ri,"Unrecognized index type!"),t=i.index_.toString()),n.orderBy=P(t),i.startSet_&&(n.startAt=P(i.indexStartValue_),i.startNameSet_&&(n.startAt+=","+P(i.indexStartName_))),i.endSet_&&(n.endAt=P(i.indexEndValue_),i.endNameSet_&&(n.endAt+=","+P(i.indexEndName_))),i.limitSet_&&(i.isViewFromLeft()?n.limitToFirst=i.limit_:n.limitToLast=i.limit_),n}function _r(i){const n={};if(i.startSet_&&(n.sp=i.indexStartValue_,i.startNameSet_&&(n.sn=i.indexStartName_)),i.endSet_&&(n.ep=i.indexEndValue_,i.endNameSet_&&(n.en=i.indexEndName_)),i.limitSet_){n.l=i.limit_;let t=i.viewFrom_;""===t&&(t=i.isViewFromLeft()?"l":"r"),n.vf=t}return i.index_!==U&&(n.i=i.index_.toString()),n}class Xt extends js{constructor(n,t,s,r){super(),this.repoInfo_=n,this.onDataUpdate_=t,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=at("p:rest:"),this.listens_={}}reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,t){return void 0!==t?"tag$"+t:(g(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}listen(n,t,s,r){const o=n._path.toString();this.log_("Listen called for "+o+" "+n._queryIdentifier);const a=Xt.getListenId_(n,s),l={};this.listens_[a]=l;const c=gr(n._queryParams);this.restRequest_(o+".json",c,(u,f)=>{let d=f;if(404===u&&(d=null,u=null),null===u&&this.onDataUpdate_(o,d,!1,s),Ie(this.listens_,a)===l){let p;p=u?401===u?"permission_denied":"rest_error:"+u:"ok",r(p,null)}})}unlisten(n,t){const s=Xt.getListenId_(n,t);delete this.listens_[s]}get(n){const t=gr(n._queryParams),s=n._path.toString(),r=new B;return this.restRequest_(s+".json",t,(o,a)=>{let l=a;404===o&&(l=null,o=null),null===o?(this.onDataUpdate_(s,l,!1,null),r.resolve(l)):r.reject(new Error(l))}),r.promise}refreshAuthToken(n){}restRequest_(n,t={},s){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,o])=>{r&&r.accessToken&&(t.auth=r.accessToken),o&&o.token&&(t.ac=o.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+function Ol(i){const n=[];for(const[t,s]of Object.entries(i))Array.isArray(s)?s.forEach(r=>{n.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return n.length?"&"+n.join("&"):""}(t);this.log_("Sending REST request for "+a);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&4===l.readyState){this.log_("REST Response for "+a+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=rt(l.responseText)}catch(u){V("Failed to parse JSON response for "+a+": "+l.responseText)}s(null,c)}else 401!==l.status&&404!==l.status&&V("Got unsuccessful REST response for "+a+" Status: "+l.status),s(l.status);s=null}},l.open("GET",a,!0),l.send()})}}class du{constructor(){this.rootNode_=b.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,t){this.rootNode_=this.rootNode_.updateChild(n,t)}}function en(){return{value:null,children:new Map}}function Ke(i,n,t){if(T(n))i.value=t,i.children.clear();else if(null!==i.value)i.value=i.value.updateChild(n,t);else{const s=C(n);i.children.has(s)||i.children.set(s,en()),Ke(i.children.get(s),n=N(n),t)}}function di(i,n){if(T(n))return i.value=null,i.children.clear(),!0;if(null!==i.value){if(i.value.isLeafNode())return!1;{const t=i.value;return i.value=null,t.forEachChild(U,(s,r)=>{Ke(i,new x(s),r)}),di(i,n)}}if(i.children.size>0){const t=C(n);return n=N(n),i.children.has(t)&&di(i.children.get(t),n)&&i.children.delete(t),0===i.children.size}return!0}function hi(i,n,t){null!==i.value?t(n,i.value):function hu(i,n){i.children.forEach((t,s)=>{n(s,t)})}(i,(s,r)=>{hi(r,new x(n.toString()+"/"+s),t)})}class fu{constructor(n){this.collection_=n,this.last_=null}get(){const n=this.collection_.get(),t=Object.assign({},n);return this.last_&&M(this.last_,(s,r)=>{t[s]=t[s]-r}),this.last_=n,t}}class _u{constructor(n,t){this.server_=t,this.statsToReport_={},this.statsListener_=new fu(n);const s=1e4+2e4*Math.random();ct(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const n=this.statsListener_.get(),t={};let s=!1;M(n,(r,o)=>{o>0&&te(this.statsToReport_,r)&&(t[r]=o,s=!0)}),s&&this.server_.reportStats(t),ct(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var K=(()=>{return(i=K||(K={}))[i.OVERWRITE=0]="OVERWRITE",i[i.MERGE=1]="MERGE",i[i.ACK_USER_WRITE=2]="ACK_USER_WRITE",i[i.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",K;var i})();function gi(i){return{fromUser:!1,fromServer:!0,queryId:i,tagged:!0}}class tn{constructor(n,t,s){this.path=n,this.affectedTree=t,this.revert=s,this.type=K.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(n){if(T(this.path)){if(null!=this.affectedTree.value)return g(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new x(n));return new tn(w(),t,this.revert)}}return g(C(this.path)===n,"operationForChild called for unrelated child."),new tn(N(this.path),this.affectedTree,this.revert)}}class bt{constructor(n,t){this.source=n,this.path=t,this.type=K.LISTEN_COMPLETE}operationForChild(n){return T(this.path)?new bt(this.source,w()):new bt(this.source,N(this.path))}}class Re{constructor(n,t,s){this.source=n,this.path=t,this.snap=s,this.type=K.OVERWRITE}operationForChild(n){return T(this.path)?new Re(this.source,w(),this.snap.getImmediateChild(n)):new Re(this.source,N(this.path),this.snap)}}class $e{constructor(n,t,s){this.source=n,this.path=t,this.children=s,this.type=K.MERGE}operationForChild(n){if(T(this.path)){const t=this.children.subtree(new x(n));return t.isEmpty()?null:t.value?new Re(this.source,w(),t.value):new $e(this.source,w(),t)}return g(C(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new $e(this.source,N(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class ye{constructor(n,t,s){this.node_=n,this.fullyInitialized_=t,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(T(n))return this.isFullyInitialized()&&!this.filtered_;const t=C(n);return this.isCompleteForChild(t)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}}class mu{constructor(n){this.query_=n,this.index_=this.query_._queryParams.getIndex()}}function Ct(i,n,t,s,r,o){const a=s.filter(l=>l.type===t);a.sort((l,c)=>function bu(i,n,t){if(null==n.childName||null==t.childName)throw Ve("Should only compare child_ events.");const s=new Z(n.childName,n.snapshotNode),r=new Z(t.childName,t.snapshotNode);return i.index_.compare(s,r)}(i,l,c)),a.forEach(l=>{const c=function yu(i,n,t){return"value"===n.type||"child_removed"===n.type||(n.prevName=t.getPredecessorChildName(n.childName,n.snapshotNode,i.index_)),n}(i,l,o);r.forEach(u=>{u.respondsTo(l.type)&&n.push(u.createEvent(c,i.query_))})})}function nn(i,n){return{eventCache:i,serverCache:n}}function Tt(i,n,t,s){return nn(new ye(n,t,s),i.serverCache)}function vr(i,n,t,s){return nn(i.eventCache,new ye(n,t,s))}function sn(i){return i.eventCache.isFullyInitialized()?i.eventCache.getNode():null}function Oe(i){return i.serverCache.isFullyInitialized()?i.serverCache.getNode():null}let _i;class k{constructor(n,t=(()=>(_i||(_i=new Y(ic)),_i))()){this.value=n,this.children=t}static fromObject(n){let t=new k(null);return M(n,(s,r)=>{t=t.set(new x(s),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,t){if(null!=this.value&&t(this.value))return{path:w(),value:this.value};if(T(n))return null;{const s=C(n),r=this.children.get(s);if(null!==r){const o=r.findRootMostMatchingPathAndValue(N(n),t);return null!=o?{path:q(new x(s),o.path),value:o.value}:null}return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(T(n))return this;{const t=C(n),s=this.children.get(t);return null!==s?s.subtree(N(n)):new k(null)}}set(n,t){if(T(n))return new k(t,this.children);{const s=C(n),o=(this.children.get(s)||new k(null)).set(N(n),t),a=this.children.insert(s,o);return new k(this.value,a)}}remove(n){if(T(n))return this.children.isEmpty()?new k(null):new k(null,this.children);{const t=C(n),s=this.children.get(t);if(s){const r=s.remove(N(n));let o;return o=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&o.isEmpty()?new k(null):new k(this.value,o)}return this}}get(n){if(T(n))return this.value;{const t=C(n),s=this.children.get(t);return s?s.get(N(n)):null}}setTree(n,t){if(T(n))return t;{const s=C(n),o=(this.children.get(s)||new k(null)).setTree(N(n),t);let a;return a=o.isEmpty()?this.children.remove(s):this.children.insert(s,o),new k(this.value,a)}}fold(n){return this.fold_(w(),n)}fold_(n,t){const s={};return this.children.inorderTraversal((r,o)=>{s[r]=o.fold_(q(n,r),t)}),t(n,this.value,s)}findOnPath(n,t){return this.findOnPath_(n,w(),t)}findOnPath_(n,t,s){const r=!!this.value&&s(t,this.value);if(r)return r;if(T(n))return null;{const o=C(n),a=this.children.get(o);return a?a.findOnPath_(N(n),q(t,o),s):null}}foreachOnPath(n,t){return this.foreachOnPath_(n,w(),t)}foreachOnPath_(n,t,s){if(T(n))return this;{this.value&&s(t,this.value);const r=C(n),o=this.children.get(r);return o?o.foreachOnPath_(N(n),q(t,r),s):new k(null)}}foreach(n){this.foreach_(w(),n)}foreach_(n,t){this.children.inorderTraversal((s,r)=>{r.foreach_(q(n,s),t)}),this.value&&t(n,this.value)}foreachChild(n){this.children.inorderTraversal((t,s)=>{s.value&&n(t,s.value)})}}class ie{constructor(n){this.writeTree_=n}static empty(){return new ie(new k(null))}}function Zt(i,n,t){if(T(n))return new ie(new k(t));{const s=i.writeTree_.findRootMostValueAndPath(n);if(null!=s){const r=s.path;let o=s.value;const a=J(r,n);return o=o.updateChild(a,t),new ie(i.writeTree_.set(r,o))}{const r=new k(t),o=i.writeTree_.setTree(n,r);return new ie(o)}}}function mi(i,n,t){let s=i;return M(t,(r,o)=>{s=Zt(s,q(n,r),o)}),s}function yr(i,n){if(T(n))return ie.empty();{const t=i.writeTree_.setTree(n,new k(null));return new ie(t)}}function vi(i,n){return null!=De(i,n)}function De(i,n){const t=i.writeTree_.findRootMostValueAndPath(n);return null!=t?i.writeTree_.get(t.path).getChild(J(t.path,n)):null}function br(i){const n=[],t=i.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(U,(s,r)=>{n.push(new Z(s,r))}):i.writeTree_.children.inorderTraversal((s,r)=>{null!=r.value&&n.push(new Z(s,r.value))}),n}function be(i,n){if(T(n))return i;{const t=De(i,n);return new ie(null!=t?new k(t):i.writeTree_.subtree(n))}}function yi(i){return i.writeTree_.isEmpty()}function Xe(i,n){return Cr(w(),i.writeTree_,n)}function Cr(i,n,t){if(null!=n.value)return t.updateChild(i,n.value);{let s=null;return n.children.inorderTraversal((r,o)=>{".priority"===r?(g(null!==o.value,"Priority writes must always be leaf nodes"),s=o.value):t=Cr(q(i,r),o,t)}),!t.getChild(i).isEmpty()&&null!==s&&(t=t.updateChild(q(i,".priority"),s)),t}}function rn(i,n){return xr(n,i)}function xu(i,n){if(i.snap)return j(i.path,n);for(const t in i.children)if(i.children.hasOwnProperty(t)&&j(q(i.path,t),n))return!0;return!1}function Eu(i){return i.visible}function Tr(i,n,t){let s=ie.empty();for(let r=0;r<i.length;++r){const o=i[r];if(n(o)){const a=o.path;let l;if(o.snap)j(t,a)?(l=J(t,a),s=Zt(s,l,o.snap)):j(a,t)&&(l=J(a,t),s=Zt(s,w(),o.snap.getChild(l)));else{if(!o.children)throw Ve("WriteRecord should have .snap or .children");if(j(t,a))l=J(t,a),s=mi(s,l,o.children);else if(j(a,t))if(l=J(a,t),T(l))s=mi(s,w(),o.children);else{const c=Ie(o.children,C(l));if(c){const u=c.getChild(N(l));s=Zt(s,w(),u)}}}}}return s}function Zr(i,n,t,s,r){if(s||r){const o=be(i.visibleWrites,n);return!r&&yi(o)?t:r||null!=t||vi(o,w())?Xe(Tr(i.allWrites,function(u){return(u.visible||r)&&(!s||!~s.indexOf(u.writeId))&&(j(u.path,n)||j(n,u.path))},n),t||b.EMPTY_NODE):null}{const o=De(i.visibleWrites,n);if(null!=o)return o;{const a=be(i.visibleWrites,n);return yi(a)?t:null!=t||vi(a,w())?Xe(a,t||b.EMPTY_NODE):null}}}function on(i,n,t,s){return Zr(i.writeTree,i.treePath,n,t,s)}function bi(i,n){return function Iu(i,n,t){let s=b.EMPTY_NODE;const r=De(i.visibleWrites,n);if(r)return r.isLeafNode()||r.forEachChild(U,(o,a)=>{s=s.updateImmediateChild(o,a)}),s;if(t){const o=be(i.visibleWrites,n);return t.forEachChild(U,(a,l)=>{const c=Xe(be(o,new x(a)),l);s=s.updateImmediateChild(a,c)}),br(o).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}return br(be(i.visibleWrites,n)).forEach(a=>{s=s.updateImmediateChild(a.name,a.node)}),s}(i.writeTree,i.treePath,n)}function Ar(i,n,t,s){return function Nu(i,n,t,s,r){g(s||r,"Either existingEventSnap or existingServerSnap must exist");const o=q(n,t);if(vi(i.visibleWrites,o))return null;{const a=be(i.visibleWrites,o);return yi(a)?r.getChild(t):Xe(a,r.getChild(t))}}(i.writeTree,i.treePath,n,t,s)}function an(i,n){return function ku(i,n){return De(i.visibleWrites,n)}(i.writeTree,q(i.treePath,n))}function Ci(i,n,t){return function Uu(i,n,t,s){const r=q(n,t),o=De(i.visibleWrites,r);return null!=o?o:s.isCompleteForChild(t)?Xe(be(i.visibleWrites,r),s.getNode().getImmediateChild(t)):null}(i.writeTree,i.treePath,n,t)}function wr(i,n){return xr(q(i.treePath,n),i.writeTree)}function xr(i,n){return{treePath:i,writeTree:n}}class Ru{constructor(){this.changeMap=new Map}trackChildChange(n){const t=n.type,s=n.childName;g("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),g(".priority"!==s,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const o=r.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(s,vt(s,n.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(s);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(s,mt(s,r.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(s,je(s,n.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw Ve("Illegal combination of changes: "+n+" occurred after "+r);this.changeMap.set(s,vt(s,n.snapshotNode,r.oldSnap))}}else this.changeMap.set(s,n)}getChanges(){return Array.from(this.changeMap.values())}}const Sr=new class Ou{getCompleteChild(n){return null}getChildAfterChild(n,t,s){return null}};class Ti{constructor(n,t,s=null){this.writes_=n,this.viewCache_=t,this.optCompleteServerCache_=s}getCompleteChild(n){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(n))return t.getNode().getImmediateChild(n);{const s=null!=this.optCompleteServerCache_?new ye(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ci(this.writes_,n,s)}}getChildAfterChild(n,t,s){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Oe(this.viewCache_),o=function Pu(i,n,t,s,r,o){return function qu(i,n,t,s,r,o,a){let l;const c=be(i.visibleWrites,n),u=De(c,w());if(null!=u)l=u;else{if(null==t)return[];l=Xe(c,t)}if(l=l.withIndex(a),l.isEmpty()||l.isLeafNode())return[];{const f=[],d=a.getCompare(),p=o?l.getReverseIteratorFrom(s,a):l.getIteratorFrom(s,a);let _=p.getNext();for(;_&&f.length<r;)0!==d(_,s)&&f.push(_),_=p.getNext();return f}}(i.writeTree,i.treePath,n,t,s,r,o)}(this.writes_,r,t,1,s,n);return 0===o.length?null:o[0]}}function Er(i,n,t,s,r,o){const a=n.eventCache;if(null!=an(s,t))return n;{let l,c;if(T(t))if(g(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const u=Oe(n),d=bi(s,u instanceof b?u:b.EMPTY_NODE);l=i.filter.updateFullNode(n.eventCache.getNode(),d,o)}else{const u=on(s,Oe(n));l=i.filter.updateFullNode(n.eventCache.getNode(),u,o)}else{const u=C(t);if(".priority"===u){g(1===ve(t),"Can't have a priority with additional path components");const f=a.getNode();c=n.serverCache.getNode();const d=Ar(s,t,f,c);l=null!=d?i.filter.updatePriority(f,d):a.getNode()}else{const f=N(t);let d;if(a.isCompleteForChild(u)){c=n.serverCache.getNode();const p=Ar(s,t,a.getNode(),c);d=null!=p?a.getNode().getImmediateChild(u).updateChild(f,p):a.getNode().getImmediateChild(u)}else d=Ci(s,u,n.serverCache);l=null!=d?i.filter.updateChild(a.getNode(),u,d,f,r,o):a.getNode()}}return Tt(n,l,a.isFullyInitialized()||T(t),i.filter.filtersNodes())}}function ln(i,n,t,s,r,o,a,l){const c=n.serverCache;let u;const f=a?i.filter:i.filter.getIndexedFilter();if(T(t))u=f.updateFullNode(c.getNode(),s,null);else if(f.filtersNodes()&&!c.isFiltered()){const _=c.getNode().updateChild(t,s);u=f.updateFullNode(c.getNode(),_,null)}else{const _=C(t);if(!c.isCompleteForPath(t)&&ve(t)>1)return n;const m=N(t),F=c.getNode().getImmediateChild(_).updateChild(m,s);u=".priority"===_?f.updatePriority(c.getNode(),F):f.updateChild(c.getNode(),_,F,m,Sr,null)}const d=vr(n,u,c.isFullyInitialized()||T(t),f.filtersNodes());return Er(i,d,t,r,new Ti(r,d,o),l)}function Zi(i,n,t,s,r,o,a){const l=n.eventCache;let c,u;const f=new Ti(r,n,o);if(T(t))u=i.filter.updateFullNode(n.eventCache.getNode(),s,a),c=Tt(n,u,!0,i.filter.filtersNodes());else{const d=C(t);if(".priority"===d)u=i.filter.updatePriority(n.eventCache.getNode(),s),c=Tt(n,u,l.isFullyInitialized(),l.isFiltered());else{const p=N(t),_=l.getNode().getImmediateChild(d);let m;if(T(p))m=s;else{const S=f.getCompleteChild(d);m=null!=S?".priority"===Xn(p)&&S.getChild(er(p)).isEmpty()?S:S.updateChild(p,s):b.EMPTY_NODE}c=_.equals(m)?n:Tt(n,i.filter.updateChild(l.getNode(),d,m,p,f,a),l.isFullyInitialized(),i.filter.filtersNodes())}}return c}function Ir(i,n){return i.eventCache.isCompleteForChild(n)}function Nr(i,n,t){return t.foreach((s,r)=>{n=n.updateChild(s,r)}),n}function Ai(i,n,t,s,r,o,a,l){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let u,c=n;u=T(t)?s:new k(null).setTree(t,s);const f=n.serverCache.getNode();return u.children.inorderTraversal((d,p)=>{if(f.hasChild(d)){const m=Nr(0,n.serverCache.getNode().getImmediateChild(d),p);c=ln(i,c,new x(d),m,r,o,a,l)}}),u.children.inorderTraversal((d,p)=>{const _=!n.serverCache.isCompleteForChild(d)&&void 0===p.value;if(!f.hasChild(d)&&!_){const S=Nr(0,n.serverCache.getNode().getImmediateChild(d),p);c=ln(i,c,new x(d),S,r,o,a,l)}}),c}class Yu{constructor(n,t){this.query_=n,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new li(s.getIndex()),o=function ou(i){return i.loadsAllData()?new li(i.getIndex()):i.hasLimit()?new ru(i):new yt(i)}(s);this.processor_=function Du(i){return{filter:i}}(o);const a=t.serverCache,l=t.eventCache,c=r.updateFullNode(b.EMPTY_NODE,a.getNode(),null),u=o.updateFullNode(b.EMPTY_NODE,l.getNode(),null),f=new ye(c,a.isFullyInitialized(),r.filtersNodes()),d=new ye(u,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=nn(d,f),this.eventGenerator_=new mu(this.query_)}get query(){return this.query_}}function Gu(i,n){const t=Oe(i.viewCache_);return t&&(i.query._queryParams.loadsAllData()||!T(n)&&!t.getImmediateChild(C(n)).isEmpty())?t.getChild(n):null}function Ur(i){return 0===i.eventRegistrations_.length}function kr(i,n,t){const s=[];if(t){g(null==n,"A cancel should cancel all event registrations.");const r=i.query._path;i.eventRegistrations_.forEach(o=>{const a=o.createCancelEvent(t,r);a&&s.push(a)})}if(n){let r=[];for(let o=0;o<i.eventRegistrations_.length;++o){const a=i.eventRegistrations_[o];if(a.matches(n)){if(n.hasAnyCallback()){r=r.concat(i.eventRegistrations_.slice(o+1));break}}else r.push(a)}i.eventRegistrations_=r}else i.eventRegistrations_=[];return s}function qr(i,n,t,s){n.type===K.MERGE&&null!==n.source.queryId&&(g(Oe(i.viewCache_),"We should always have a full cache before handling merges"),g(sn(i.viewCache_),"Missing event cache, even though we have a server cache"));const r=i.viewCache_,o=function Fu(i,n,t,s,r){const o=new Ru;let a,l;if(t.type===K.OVERWRITE){const u=t;u.source.fromUser?a=Zi(i,n,u.path,u.snap,s,r,o):(g(u.source.fromServer,"Unknown source."),l=u.source.tagged||n.serverCache.isFiltered()&&!T(u.path),a=ln(i,n,u.path,u.snap,s,r,l,o))}else if(t.type===K.MERGE){const u=t;u.source.fromUser?a=function Hu(i,n,t,s,r,o,a){let l=n;return s.foreach((c,u)=>{const f=q(t,c);Ir(n,C(f))&&(l=Zi(i,l,f,u,r,o,a))}),s.foreach((c,u)=>{const f=q(t,c);Ir(n,C(f))||(l=Zi(i,l,f,u,r,o,a))}),l}(i,n,u.path,u.children,s,r,o):(g(u.source.fromServer,"Unknown source."),l=u.source.tagged||n.serverCache.isFiltered(),a=Ai(i,n,u.path,u.children,s,r,l,o))}else if(t.type===K.ACK_USER_WRITE){const u=t;a=u.revert?function Bu(i,n,t,s,r,o){let a;if(null!=an(s,t))return n;{const l=new Ti(s,n,r),c=n.eventCache.getNode();let u;if(T(t)||".priority"===C(t)){let f;if(n.serverCache.isFullyInitialized())f=on(s,Oe(n));else{const d=n.serverCache.getNode();g(d instanceof b,"serverChildren would be complete if leaf node"),f=bi(s,d)}f=f,u=i.filter.updateFullNode(c,f,o)}else{const f=C(t);let d=Ci(s,f,n.serverCache);null==d&&n.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),u=null!=d?i.filter.updateChild(c,f,d,N(t),l,o):n.eventCache.getNode().hasChild(f)?i.filter.updateChild(c,f,b.EMPTY_NODE,N(t),l,o):c,u.isEmpty()&&n.serverCache.isFullyInitialized()&&(a=on(s,Oe(n)),a.isLeafNode()&&(u=i.filter.updateFullNode(u,a,o)))}return a=n.serverCache.isFullyInitialized()||null!=an(s,w()),Tt(n,u,a,i.filter.filtersNodes())}}(i,n,u.path,s,r,o):function Vu(i,n,t,s,r,o,a){if(null!=an(r,t))return n;const l=n.serverCache.isFiltered(),c=n.serverCache;if(null!=s.value){if(T(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return ln(i,n,t,c.getNode().getChild(t),r,o,l,a);if(T(t)){let u=new k(null);return c.getNode().forEachChild(le,(f,d)=>{u=u.set(new x(f),d)}),Ai(i,n,t,u,r,o,l,a)}return n}{let u=new k(null);return s.foreach((f,d)=>{const p=q(t,f);c.isCompleteForPath(p)&&(u=u.set(f,c.getNode().getChild(p)))}),Ai(i,n,t,u,r,o,l,a)}}(i,n,u.path,u.affectedTree,s,r,o)}else{if(t.type!==K.LISTEN_COMPLETE)throw Ve("Unknown operation type: "+t.type);a=function Ju(i,n,t,s,r){const o=n.serverCache;return Er(i,vr(n,o.getNode(),o.isFullyInitialized()||T(t),o.isFiltered()),t,s,Sr,r)}(i,n,t.path,s,o)}const c=o.getChanges();return function Qu(i,n,t){const s=n.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),o=sn(i);(t.length>0||!i.eventCache.isFullyInitialized()||r&&!s.getNode().equals(o)||!s.getNode().getPriority().equals(o.getPriority()))&&t.push(pr(sn(n)))}}(n,a,c),{viewCache:a,changes:c}}(i.processor_,r,n,t,s);return function Mu(i,n){g(n.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),g(n.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed")}(i.processor_,o.viewCache),g(o.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),i.viewCache_=o.viewCache,Lr(i,o.changes,o.viewCache.eventCache.getNode(),null)}function Lr(i,n,t,s){return function vu(i,n,t,s){const r=[],o=[];return n.forEach(a=>{"child_changed"===a.type&&i.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&o.push(function su(i,n){return{type:"child_moved",snapshotNode:n,childName:i}}(a.childName,a.snapshotNode))}),Ct(i,r,"child_removed",n,s,t),Ct(i,r,"child_added",n,s,t),Ct(i,r,"child_moved",o,s,t),Ct(i,r,"child_changed",n,s,t),Ct(i,r,"value",n,s,t),r}(i.eventGenerator_,n,t,s?[s]:i.eventRegistrations_)}let cn,dn;class Pr{constructor(){this.views=new Map}}function wi(i,n,t,s){const r=n.source.queryId;if(null!==r){const o=i.views.get(r);return g(null!=o,"SyncTree gave us an op for an invalid query."),qr(o,n,t,s)}{let o=[];for(const a of i.views.values())o=o.concat(qr(a,n,t,s));return o}}function Rr(i,n,t,s,r){const a=i.views.get(n._queryIdentifier);if(!a){let l=on(t,r?s:null),c=!1;l?c=!0:s instanceof b?(l=bi(t,s),c=!1):(l=b.EMPTY_NODE,c=!1);const u=nn(new ye(l,c,!1),new ye(s,r,!1));return new Yu(n,u)}return a}function Or(i){const n=[];for(const t of i.views.values())t.query._queryParams.loadsAllData()||n.push(t);return n}function Ce(i,n){let t=null;for(const s of i.views.values())t=t||Gu(s,n);return t}function Dr(i,n){return n._queryParams.loadsAllData()?un(i):i.views.get(n._queryIdentifier)}function Mr(i,n){return null!=Dr(i,n)}function Te(i){return null!=un(i)}function un(i){for(const n of i.views.values())if(n.query._queryParams.loadsAllData())return n;return null}let rd=1;class Fr{constructor(n){this.listenProvider_=n,this.syncPointTree_=new k(null),this.pendingWriteTree_=function Lu(){return{visibleWrites:ie.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function xi(i,n,t,s,r){return function Tu(i,n,t,s,r){g(s>i.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),i.allWrites.push({path:n,snap:t,writeId:s,visible:r}),r&&(i.visibleWrites=Zt(i.visibleWrites,n,t)),i.lastWriteId=s}(i.pendingWriteTree_,n,t,s,r),r?et(i,new Re({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,t)):[]}function Ze(i,n,t=!1){const s=function Au(i,n){for(let t=0;t<i.allWrites.length;t++){const s=i.allWrites[t];if(s.writeId===n)return s}return null}(i.pendingWriteTree_,n);if(function wu(i,n){const t=i.allWrites.findIndex(l=>l.writeId===n);g(t>=0,"removeWrite called with nonexistent writeId.");const s=i.allWrites[t];i.allWrites.splice(t,1);let r=s.visible,o=!1,a=i.allWrites.length-1;for(;r&&a>=0;){const l=i.allWrites[a];l.visible&&(a>=t&&xu(l,s.path)?r=!1:j(s.path,l.path)&&(o=!0)),a--}return!!r&&(o?(function Su(i){i.visibleWrites=Tr(i.allWrites,Eu,w()),i.lastWriteId=i.allWrites.length>0?i.allWrites[i.allWrites.length-1].writeId:-1}(i),!0):(s.snap?i.visibleWrites=yr(i.visibleWrites,s.path):M(s.children,c=>{i.visibleWrites=yr(i.visibleWrites,q(s.path,c))}),!0))}(i.pendingWriteTree_,n)){let o=new k(null);return null!=s.snap?o=o.set(w(),!0):M(s.children,a=>{o=o.set(new x(a),!0)}),et(i,new tn(s.path,o,t))}return[]}function At(i,n,t){return et(i,new Re({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,t))}function Si(i,n,t,s){const r=n._path,o=i.syncPointTree_.get(r);let a=[];if(o&&("default"===n._queryIdentifier||Mr(o,n))){const l=function nd(i,n,t,s){const r=n._queryIdentifier,o=[];let a=[];const l=Te(i);if("default"===r)for(const[c,u]of i.views.entries())a=a.concat(kr(u,t,s)),Ur(u)&&(i.views.delete(c),u.query._queryParams.loadsAllData()||o.push(u.query));else{const c=i.views.get(r);c&&(a=a.concat(kr(c,t,s)),Ur(c)&&(i.views.delete(r),c.query._queryParams.loadsAllData()||o.push(c.query)))}return l&&!Te(i)&&o.push(new(function Xu(){return g(cn,"Reference.ts has not been loaded"),cn}())(n._repo,n._path)),{removed:o,events:a}}(o,n,t,s);(function ed(i){return 0===i.views.size})(o)&&(i.syncPointTree_=i.syncPointTree_.remove(r));const c=l.removed;a=l.events;const u=-1!==c.findIndex(d=>d._queryParams.loadsAllData()),f=i.syncPointTree_.findOnPath(r,(d,p)=>Te(p));if(u&&!f){const d=i.syncPointTree_.subtree(r);if(!d.isEmpty()){const p=function fd(i){return i.fold((n,t,s)=>{if(t&&Te(t))return[un(t)];{let r=[];return t&&(r=Or(t)),M(s,(o,a)=>{r=r.concat(a)}),r}})}(d);for(let _=0;_<p.length;++_){const m=p[_],S=m.query,F=Jr(i,m);i.listenProvider_.startListening(wt(S),fn(i,S),F.hashFn,F.onComplete)}}}!f&&c.length>0&&!s&&(u?i.listenProvider_.stopListening(wt(n),null):c.forEach(d=>{const p=i.queryToTagMap.get(pn(d));i.listenProvider_.stopListening(wt(d),p)})),function pd(i,n){for(let t=0;t<n.length;++t){const s=n[t];if(!s._queryParams.loadsAllData()){const r=pn(s),o=i.queryToTagMap.get(r);i.queryToTagMap.delete(r),i.tagToQueryMap.delete(o)}}}(i,c)}return a}function Qr(i,n,t){const s=n._path;let r=null,o=!1;i.syncPointTree_.foreachOnPath(s,(d,p)=>{const _=J(d,s);r=r||Ce(p,_),o=o||Te(p)});let l,a=i.syncPointTree_.get(s);a?(o=o||Te(a),r=r||Ce(a,w())):(a=new Pr,i.syncPointTree_=i.syncPointTree_.set(s,a)),null!=r?l=!0:(l=!1,r=b.EMPTY_NODE,i.syncPointTree_.subtree(s).foreachChild((p,_)=>{const m=Ce(_,w());m&&(r=r.updateImmediateChild(p,m))}));const c=Mr(a,n);if(!c&&!n._queryParams.loadsAllData()){const d=pn(n);g(!i.queryToTagMap.has(d),"View does not exist, but we have a tag");const p=function gd(){return rd++}();i.queryToTagMap.set(d,p),i.tagToQueryMap.set(p,d)}let f=function td(i,n,t,s,r,o){const a=Rr(i,n,s,r,o);return i.views.has(n._queryIdentifier)||i.views.set(n._queryIdentifier,a),function ju(i,n){i.eventRegistrations_.push(n)}(a,t),function Ku(i,n){const t=i.viewCache_.eventCache,s=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(U,(o,a)=>{s.push(je(o,a))}),t.isFullyInitialized()&&s.push(pr(t.getNode())),Lr(i,s,t.getNode(),n)}(a,t)}(a,n,t,rn(i.pendingWriteTree_,s),r,l);if(!c&&!o){const d=Dr(a,n);f=f.concat(function _d(i,n,t){const s=n._path,r=fn(i,n),o=Jr(i,t),a=i.listenProvider_.startListening(wt(n),r,o.hashFn,o.onComplete),l=i.syncPointTree_.subtree(s);if(r)g(!Te(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,f,d)=>{if(!T(u)&&f&&Te(f))return[un(f).query];{let p=[];return f&&(p=p.concat(Or(f).map(_=>_.query))),M(d,(_,m)=>{p=p.concat(m)}),p}});for(let u=0;u<c.length;++u){const f=c[u];i.listenProvider_.stopListening(wt(f),fn(i,f))}}return a}(i,n,d))}return f}function hn(i,n,t){const r=i.pendingWriteTree_,o=i.syncPointTree_.findOnPath(n,(a,l)=>{const u=Ce(l,J(a,n));if(u)return u});return Zr(r,n,o,t,!0)}function et(i,n){return Hr(n,i.syncPointTree_,null,rn(i.pendingWriteTree_,w()))}function Hr(i,n,t,s){if(T(i.path))return Vr(i,n,t,s);{const r=n.get(w());null==t&&null!=r&&(t=Ce(r,w()));let o=[];const a=C(i.path),l=i.operationForChild(a),c=n.children.get(a);if(c&&l){const u=t?t.getImmediateChild(a):null,f=wr(s,a);o=o.concat(Hr(l,c,u,f))}return r&&(o=o.concat(wi(r,i,s,t))),o}}function Vr(i,n,t,s){const r=n.get(w());null==t&&null!=r&&(t=Ce(r,w()));let o=[];return n.children.inorderTraversal((a,l)=>{const c=t?t.getImmediateChild(a):null,u=wr(s,a),f=i.operationForChild(a);f&&(o=o.concat(Vr(f,l,c,u)))}),r&&(o=o.concat(wi(r,i,s,t))),o}function Jr(i,n){const t=n.query,s=fn(i,t);return{hashFn:()=>(function Wu(i){return i.viewCache_.serverCache.getNode()}(n)||b.EMPTY_NODE).hash(),onComplete:r=>{if("ok"===r)return s?function cd(i,n,t){const s=Ei(i,t);if(s){const r=Ii(s),o=r.path,a=r.queryId,l=J(o,n);return Ni(i,o,new bt(gi(a),l))}return[]}(i,t._path,s):function ld(i,n){return et(i,new bt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n))}(i,t._path);{const o=function oc(i,n){let t="Unknown Error";"too_big"===i?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===i?t="Client doesn't have permission to access the desired data.":"unavailable"===i&&(t="The service is unavailable");const s=new Error(i+" at "+n._path.toString()+": "+t);return s.code=i.toUpperCase(),s}(r,t);return Si(i,t,null,o)}}}}function fn(i,n){const t=pn(n);return i.queryToTagMap.get(t)}function pn(i){return i._path.toString()+"$"+i._queryIdentifier}function Ei(i,n){return i.tagToQueryMap.get(n)}function Ii(i){const n=i.indexOf("$");return g(-1!==n&&n<i.length-1,"Bad queryKey."),{queryId:i.substr(n+1),path:new x(i.substr(0,n))}}function Ni(i,n,t){const s=i.syncPointTree_.get(n);return g(s,"Missing sync point for query tag that we're tracking"),wi(s,t,rn(i.pendingWriteTree_,n),null)}function wt(i){return i._queryParams.loadsAllData()&&!i._queryParams.isDefault()?new(function sd(){return g(dn,"Reference.ts has not been loaded"),dn}())(i._repo,i._path):i}class Ui{constructor(n){this.node_=n}getImmediateChild(n){const t=this.node_.getImmediateChild(n);return new Ui(t)}node(){return this.node_}}class ki{constructor(n,t){this.syncTree_=n,this.path_=t}getImmediateChild(n){const t=q(this.path_,n);return new ki(this.syncTree_,t)}node(){return hn(this.syncTree_,this.path_)}}const Br=function(i,n,t){return i&&"object"==typeof i?(g(".sv"in i,"Unexpected leaf node or priority contents"),"string"==typeof i[".sv"]?vd(i[".sv"],n,t):"object"==typeof i[".sv"]?yd(i[".sv"],n):void g(!1,"Unexpected server value: "+JSON.stringify(i,null,2))):i},vd=function(i,n,t){if("timestamp"===i)return t.timestamp;g(!1,"Unexpected server value: "+i)},yd=function(i,n,t){i.hasOwnProperty("increment")||g(!1,"Unexpected server value: "+JSON.stringify(i,null,2));const s=i.increment;"number"!=typeof s&&g(!1,"Unexpected increment value: "+s);const r=n.node();if(g(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const a=r.getValue();return"number"!=typeof a?s:a+s},Yr=function(i,n,t,s){return Li(n,new ki(t,i),s)},qi=function(i,n,t){return Li(i,new Ui(n),t)};function Li(i,n,t){const s=i.getPriority().val(),r=Br(s,n.getImmediateChild(".priority"),t);let o;if(i.isLeafNode()){const a=i,l=Br(a.getValue(),n,t);return l!==a.getValue()||r!==a.getPriority().val()?new We(l,L(r)):i}{const a=i;return o=a,r!==a.getPriority().val()&&(o=o.updatePriority(new We(r))),a.forEachChild(U,(l,c)=>{const u=Li(c,n.getImmediateChild(l),t);u!==c&&(o=o.updateImmediateChild(l,u))}),o}}class Pi{constructor(n="",t=null,s={children:{},childCount:0}){this.name=n,this.parent=t,this.node=s}}function gn(i,n){let t=n instanceof x?n:new x(n),s=i,r=C(t);for(;null!==r;){const o=Ie(s.node.children,r)||{children:{},childCount:0};s=new Pi(r,s,o),t=N(t),r=C(t)}return s}function Me(i){return i.node.value}function Ri(i,n){i.node.value=n,Oi(i)}function Wr(i){return i.node.childCount>0}function _n(i,n){M(i.node.children,(t,s)=>{n(new Pi(t,i,s))})}function zr(i,n,t,s){t&&!s&&n(i),_n(i,r=>{zr(r,n,!0,s)}),t&&s&&n(i)}function xt(i){return new x(null===i.parent?i.name:xt(i.parent)+"/"+i.name)}function Oi(i){null!==i.parent&&function Td(i,n,t){const s=function bd(i){return void 0===Me(i)&&!Wr(i)}(t),r=te(i.node.children,n);s&&r?(delete i.node.children[n],i.node.childCount--,Oi(i)):!s&&!r&&(i.node.children[n]=t.node,i.node.childCount++,Oi(i))}(i.parent,i.name,i)}const Zd=/[\[\].#$\/\u0000-\u001F\u007F]/,Ad=/[\[\].#$\u0000-\u001F\u007F]/,Di=10485760,mn=function(i){return"string"==typeof i&&0!==i.length&&!Zd.test(i)},Gr=function(i){return"string"==typeof i&&0!==i.length&&!Ad.test(i)},St=function(i){return null===i||"string"==typeof i||"number"==typeof i&&!Vt(i)||i&&"object"==typeof i&&te(i,".sv")},ce=function(i,n,t,s){s&&void 0===n||Et(H(i,"value"),n,t)},Et=function(i,n,t){const s=t instanceof x?new Dc(t,i):t;if(void 0===n)throw new Error(i+"contains undefined "+Le(s));if("function"==typeof n)throw new Error(i+"contains a function "+Le(s)+" with contents = "+n.toString());if(Vt(n))throw new Error(i+"contains "+n.toString()+" "+Le(s));if("string"==typeof n&&n.length>Di/3&&Qt(n)>Di)throw new Error(i+"contains a string greater than "+Di+" utf8 bytes "+Le(s)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){let r=!1,o=!1;if(M(n,(a,l)=>{if(".value"===a)r=!0;else if(".priority"!==a&&".sv"!==a&&(o=!0,!mn(a)))throw new Error(i+" contains an invalid key ("+a+") "+Le(s)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Mc(i,n){i.parts_.length>0&&(i.byteLength_+=1),i.parts_.push(n),i.byteLength_+=Qt(n),tr(i)})(s,a),Et(i,l,s),function Fc(i){const n=i.parts_.pop();i.byteLength_-=Qt(n),i.parts_.length>0&&(i.byteLength_-=1)}(s)}),r&&o)throw new Error(i+' contains ".value" child '+Le(s)+" in addition to actual children.")}},jr=function(i,n,t,s){if(s&&void 0===n)return;const r=H(i,"values");if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(r+" must be an object containing the children to replace.");const o=[];M(n,(a,l)=>{const c=new x(a);if(Et(r,l,q(t,c)),".priority"===Xn(c)&&!St(l))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(c)}),function(i,n){let t,s;for(t=0;t<n.length;t++){s=n[t];const o=ft(s);for(let a=0;a<o.length;a++)if((".priority"!==o[a]||a!==o.length-1)&&!mn(o[a]))throw new Error(i+"contains an invalid key ("+o[a]+") in path "+s.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(Oc);let r=null;for(t=0;t<n.length;t++){if(s=n[t],null!==r&&j(r,s))throw new Error(i+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}}(r,o)},Mi=function(i,n,t){if(!t||void 0!==n){if(Vt(n))throw new Error(H(i,"priority")+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!St(n))throw new Error(H(i,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},It=function(i,n,t,s){if(!(s&&void 0===t||mn(t)))throw new Error(H(i,n)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Nt=function(i,n,t,s){if(!(s&&void 0===t||Gr(t)))throw new Error(H(i,n)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},$=function(i,n){if(".info"===C(n))throw new Error(i+" failed = Can't modify data under /.info/")},Kr=function(i,n){const t=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!mn(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==t.length&&!function(i){return i&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Gr(i)}(t))throw new Error(H(i,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Ed{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function vn(i,n){let t=null;for(let s=0;s<n.length;s++){const r=n[s],o=r.getPath();null!==t&&!ei(o,t.path)&&(i.eventLists_.push(t),t=null),null===t&&(t={events:[],path:o}),t.events.push(r)}t&&i.eventLists_.push(t)}function Fi(i,n,t){vn(i,t),$r(i,s=>ei(s,n))}function X(i,n,t){vn(i,t),$r(i,s=>j(s,n)||j(n,s))}function $r(i,n){i.recursionDepth_++;let t=!0;for(let s=0;s<i.eventLists_.length;s++){const r=i.eventLists_[s];r&&(n(r.path)?(Id(i.eventLists_[s]),i.eventLists_[s]=null):t=!1)}t&&(i.eventLists_=[]),i.recursionDepth_--}function Id(i){for(let n=0;n<i.events.length;n++){const t=i.events[n];if(null!==t){i.events[n]=null;const s=t.getEventRunner();ke&&D("event: "+t.toString()),Be(s)}}}const Xr="repo_interrupt";class Ud{constructor(n,t,s,r){this.repoInfo_=n,this.forceRestClient_=t,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ed,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=en(),this.transactionQueueTree_=new Pi,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function eo(i){const t=i.infoData_.getNode(new x(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Ut(i){return function(i){return(i=i||{}).timestamp=i.timestamp||(new Date).getTime(),i}({timestamp:eo(i)})}function to(i,n,t,s,r){i.dataUpdateCount++;const o=new x(n);t=i.interceptServerDataCallback_?i.interceptServerDataCallback_(n,t):t;let a=[];if(r)if(s){const c=Ft(t,u=>L(u));a=function dd(i,n,t,s){const r=Ei(i,s);if(r){const o=Ii(r),a=o.path,l=o.queryId,c=J(a,n),u=k.fromObject(t);return Ni(i,a,new $e(gi(l),c,u))}return[]}(i.serverSyncTree_,o,c,r)}else{const c=L(t);a=function ud(i,n,t,s){const r=Ei(i,s);if(null!=r){const o=Ii(r),a=o.path,l=o.queryId,c=J(a,n);return Ni(i,a,new Re(gi(l),c,t))}return[]}(i.serverSyncTree_,o,c,r)}else if(s){const c=Ft(t,u=>L(u));a=function ad(i,n,t){const s=k.fromObject(t);return et(i,new $e({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},n,s))}(i.serverSyncTree_,o,c)}else{const c=L(t);a=At(i.serverSyncTree_,o,c)}let l=o;a.length>0&&(l=nt(i,o)),X(i.eventQueue_,l,a)}function no(i,n){Qi(i,"connected",n),!1===n&&function Rd(i){tt(i,"onDisconnectEvents");const n=Ut(i),t=en();hi(i.onDisconnect_,w(),(r,o)=>{const a=Yr(r,o,i.serverSyncTree_,n);Ke(t,r,a)});let s=[];hi(t,w(),(r,o)=>{s=s.concat(At(i.serverSyncTree_,r,o));const a=Bi(i,r);nt(i,a)}),i.onDisconnect_=en(),X(i.eventQueue_,w(),s)}(i)}function Qi(i,n,t){const s=new x("/.info/"+n),r=L(t);i.infoData_.updateSnapshot(s,r);const o=At(i.infoSyncTree_,s,r);X(i.eventQueue_,s,o)}function yn(i){return i.nextWriteId_++}function Hi(i,n,t,s,r){tt(i,"set",{path:n.toString(),value:t,priority:s});const o=Ut(i),a=L(t,s),l=hn(i.serverSyncTree_,n),c=qi(a,l,o),u=yn(i),f=xi(i.serverSyncTree_,n,c,u,!0);vn(i.eventQueue_,f),i.server_.put(n.toString(),a.val(!0),(p,_)=>{const m="ok"===p;m||V("set at "+n+" failed: "+p);const S=Ze(i.serverSyncTree_,u,!m);X(i.eventQueue_,n,S),Ae(0,r,p,_)});const d=Bi(i,n);nt(i,d),X(i.eventQueue_,d,[])}function Od(i,n,t){i.server_.onDisconnectCancel(n.toString(),(s,r)=>{"ok"===s&&di(i.onDisconnect_,n),Ae(0,t,s,r)})}function io(i,n,t,s){const r=L(t);i.server_.onDisconnectPut(n.toString(),r.val(!0),(o,a)=>{"ok"===o&&Ke(i.onDisconnect_,n,r),Ae(0,s,o,a)})}function Vi(i,n,t){let s;s=".info"===C(n._path)?Si(i.infoSyncTree_,n,t):Si(i.serverSyncTree_,n,t),Fi(i.eventQueue_,n._path,s)}function so(i){i.persistentConnection_&&i.persistentConnection_.interrupt(Xr)}function tt(i,...n){let t="";i.persistentConnection_&&(t=i.persistentConnection_.id+":"),D(t,...n)}function Ae(i,n,t,s){n&&Be(()=>{if("ok"===t)n(null);else{const r=(t||"error").toUpperCase();let o=r;s&&(o+=": "+s);const a=new Error(o);a.code=r,n(a)}})}function Ji(i,n,t){return hn(i.serverSyncTree_,n,t)||b.EMPTY_NODE}function bn(i,n=i.transactionQueueTree_){if(n||Cn(i,n),Me(n)){const t=oo(i,n);g(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function Vd(i,n,t){const s=t.map(u=>u.currentWriteId),r=Ji(i,n,s);let o=r;const a=r.hash();for(let u=0;u<t.length;u++){const f=t[u];g(0===f.status,"tryToSendTransactionQueue_: items in queue should all be run."),f.status=1,f.retryCount++;const d=J(n,f.path);o=o.updateChild(d,f.currentOutputSnapshotRaw)}const l=o.val(!0),c=n;i.server_.put(c.toString(),l,u=>{tt(i,"transaction put response",{path:c.toString(),status:u});let f=[];if("ok"===u){const d=[];for(let p=0;p<t.length;p++)t[p].status=2,f=f.concat(Ze(i.serverSyncTree_,t[p].currentWriteId)),t[p].onComplete&&d.push(()=>t[p].onComplete(null,!0,t[p].currentOutputSnapshotResolved)),t[p].unwatcher();Cn(i,gn(i.transactionQueueTree_,n)),bn(i,i.transactionQueueTree_),X(i.eventQueue_,n,f);for(let p=0;p<d.length;p++)Be(d[p])}else{if("datastale"===u)for(let d=0;d<t.length;d++)t[d].status=3===t[d].status?4:0;else{V("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=u}nt(i,n)}},a)}(i,xt(n),t)}else Wr(n)&&_n(n,t=>{bn(i,t)})}function nt(i,n){const t=ro(i,n),s=xt(t);return function Jd(i,n,t){if(0===n.length)return;const s=[];let r=[];const a=n.filter(l=>0===l.status).map(l=>l.currentWriteId);for(let l=0;l<n.length;l++){const c=n[l],u=J(t,c.path);let d,f=!1;if(g(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)f=!0,d=c.abortReason,r=r.concat(Ze(i.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)f=!0,d="maxretry",r=r.concat(Ze(i.serverSyncTree_,c.currentWriteId,!0));else{const p=Ji(i,c.path,a);c.currentInputSnapshot=p;const _=n[l].update(p.val());if(void 0!==_){Et("transaction failed: Data returned ",_,c.path);let m=L(_);"object"==typeof _&&null!=_&&te(_,".priority")||(m=m.updatePriority(p.getPriority()));const F=c.currentWriteId,He=Ut(i),ge=qi(m,p,He);c.currentOutputSnapshotRaw=m,c.currentOutputSnapshotResolved=ge,c.currentWriteId=yn(i),a.splice(a.indexOf(F),1),r=r.concat(xi(i.serverSyncTree_,c.path,ge,c.currentWriteId,c.applyLocally)),r=r.concat(Ze(i.serverSyncTree_,F,!0))}else f=!0,d="nodata",r=r.concat(Ze(i.serverSyncTree_,c.currentWriteId,!0))}X(i.eventQueue_,t,r),r=[],f&&(n[l].status=2,setTimeout(n[l].unwatcher,Math.floor(0)),n[l].onComplete&&s.push("nodata"===d?()=>n[l].onComplete(null,!1,n[l].currentInputSnapshot):()=>n[l].onComplete(new Error(d),!1,null)))}Cn(i,i.transactionQueueTree_);for(let l=0;l<s.length;l++)Be(s[l]);bn(i,i.transactionQueueTree_)}(i,oo(i,t),s),s}function ro(i,n){let t,s=i.transactionQueueTree_;for(t=C(n);null!==t&&void 0===Me(s);)s=gn(s,t),t=C(n=N(n));return s}function oo(i,n){const t=[];return ao(i,n,t),t.sort((s,r)=>s.order-r.order),t}function ao(i,n,t){const s=Me(n);if(s)for(let r=0;r<s.length;r++)t.push(s[r]);_n(n,r=>{ao(i,r,t)})}function Cn(i,n){const t=Me(n);if(t){let s=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[s]=t[r],s++);t.length=s,Ri(n,t.length>0?t:void 0)}_n(n,s=>{Cn(i,s)})}function Bi(i,n){const t=xt(ro(i,n)),s=gn(i.transactionQueueTree_,n);return function Cd(i,n,t){let s=t?i:i.parent;for(;null!==s;){if(n(s))return!0;s=s.parent}}(s,r=>{Yi(i,r)}),Yi(i,s),zr(s,r=>{Yi(i,r)}),t}function Yi(i,n){const t=Me(n);if(t){const s=[];let r=[],o=-1;for(let a=0;a<t.length;a++)3===t[a].status||(1===t[a].status?(g(o===a-1,"All SENT items should be at beginning of queue."),o=a,t[a].status=3,t[a].abortReason="set"):(g(0===t[a].status,"Unexpected transaction status in abort"),t[a].unwatcher(),r=r.concat(Ze(i.serverSyncTree_,t[a].currentWriteId,!0)),t[a].onComplete&&s.push(t[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Ri(n,void 0):t.length=o+1,X(i.eventQueue_,xt(n),r);for(let a=0;a<s.length;a++)Be(s[a])}}const Wi=function(i,n){const t=Wd(i),s=t.namespace;return"firebase.com"===t.domain&&oe(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||"undefined"===s)&&"localhost"!==t.domain&&oe("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&V("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Yn(t.host,t.secure,s,n,"ws"===t.scheme||"wss"===t.scheme,"",s!==t.subdomain),path:new x(t.pathString)}},Wd=function(i){let n="",t="",s="",r="",o="",a=!0,l="https",c=443;if("string"==typeof i){let u=i.indexOf("//");u>=0&&(l=i.substring(0,u-1),i=i.substring(u+2));let f=i.indexOf("/");-1===f&&(f=i.length);let d=i.indexOf("?");-1===d&&(d=i.length),n=i.substring(0,Math.min(f,d)),f<d&&(r=function Bd(i){let n="";const t=i.split("/");for(let s=0;s<t.length;s++)if(t[s].length>0){let r=t[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(o){}n+="/"+r}return n}(i.substring(f,d)));const p=function Yd(i){const n={};"?"===i.charAt(0)&&(i=i.substring(1));for(const t of i.split("&")){if(0===t.length)continue;const s=t.split("=");2===s.length?n[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):V(`Invalid query segment '${t}' in query '${i}'`)}return n}(i.substring(Math.min(i.length,d)));u=n.indexOf(":"),u>=0?(a="https"===l||"wss"===l,c=parseInt(n.substring(u+1),10)):u=n.length;const _=n.slice(0,u);if("localhost"===_.toLowerCase())t="localhost";else if(_.split(".").length<=2)t=_;else{const m=n.indexOf(".");s=n.substring(0,m).toLowerCase(),t=n.substring(m+1),o=s}"ns"in p&&(o=p.ns)}return{host:n,port:c,domain:t,subdomain:s,secure:a,scheme:l,pathString:r,namespace:o}};class lo{constructor(n,t,s,r){this.eventType=n,this.eventRegistration=t,this.snapshot=s,this.prevName=r}getPath(){const n=this.snapshot.ref;return"value"===this.eventType?n._path:n.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+P(this.snapshot.exportVal())}}class co{constructor(n,t,s){this.eventRegistration=n,this.error=t,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class uo{constructor(n,t){this.snapshotCallback=n,this.cancelCallback=t}onValue(n,t){this.snapshotCallback.call(null,n,t)}onCancel(n){return g(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,n)}get hasCancelCallback(){return!!this.cancelCallback}matches(n){return this.snapshotCallback===n.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===n.snapshotCallback.userCallback&&this.snapshotCallback.context===n.snapshotCallback.context}}class ho{constructor(n,t){this._repo=n,this._path=t}cancel(){const n=new B;return Od(this._repo,this._path,n.wrapCallback(()=>{})),n.promise}remove(){$("OnDisconnect.remove",this._path);const n=new B;return io(this._repo,this._path,null,n.wrapCallback(()=>{})),n.promise}set(n){$("OnDisconnect.set",this._path),ce("OnDisconnect.set",n,this._path,!1);const t=new B;return io(this._repo,this._path,n,t.wrapCallback(()=>{})),t.promise}setWithPriority(n,t){$("OnDisconnect.setWithPriority",this._path),ce("OnDisconnect.setWithPriority",n,this._path,!1),Mi("OnDisconnect.setWithPriority",t,!1);const s=new B;return function Dd(i,n,t,s,r){const o=L(t,s);i.server_.onDisconnectPut(n.toString(),o.val(!0),(a,l)=>{"ok"===a&&Ke(i.onDisconnect_,n,o),Ae(0,r,a,l)})}(this._repo,this._path,n,t,s.wrapCallback(()=>{})),s.promise}update(n){$("OnDisconnect.update",this._path),jr("OnDisconnect.update",n,this._path,!1);const t=new B;return function Md(i,n,t,s){if(Rn(t))return D("onDisconnect().update() called with empty data.  Don't do anything."),void Ae(0,s,"ok",void 0);i.server_.onDisconnectMerge(n.toString(),t,(r,o)=>{"ok"===r&&M(t,(a,l)=>{const c=L(l);Ke(i.onDisconnect_,q(n,a),c)}),Ae(0,s,r,o)})}(this._repo,this._path,n,t.wrapCallback(()=>{})),t.promise}}class W{constructor(n,t,s,r){this._repo=n,this._path=t,this._queryParams=s,this._orderByCalled=r}get key(){return T(this._path)?null:Xn(this._path)}get ref(){return new ee(this._repo,this._path)}get _queryIdentifier(){const n=_r(this._queryParams),t=Vn(n);return"{}"===t?"default":t}get _queryObject(){return _r(this._queryParams)}isEqual(n){if(!((n=z(n))instanceof W))return!1;const t=this._repo===n._repo,s=ei(this._path,n._path);return t&&s&&this._queryIdentifier===n._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Rc(i){let n="";for(let t=i.pieceNum_;t<i.pieces_.length;t++)""!==i.pieces_[t]&&(n+="/"+encodeURIComponent(String(i.pieces_[t])));return n||"/"}(this._path)}}function Tn(i,n){if(!0===i._orderByCalled)throw new Error(n+": You can't combine multiple orderBy calls.")}function we(i){let n=null,t=null;if(i.hasStart()&&(n=i.getIndexStartValue()),i.hasEnd()&&(t=i.getIndexEndValue()),i.getIndex()===le){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(i.hasStart()){if(i.getIndexStartName()!==he)throw new Error(s);if("string"!=typeof n)throw new Error(r)}if(i.hasEnd()){if(i.getIndexEndName()!==ae)throw new Error(s);if("string"!=typeof t)throw new Error(r)}}else if(i.getIndex()===U){if(null!=n&&!St(n)||null!=t&&!St(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(g(i.getIndex()instanceof ri||i.getIndex()===oi,"unknown index type."),null!=n&&"object"==typeof n||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Zn(i){if(i.hasStart()&&i.hasEnd()&&i.hasLimit()&&!i.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ee extends W{constructor(n,t){super(n,t,new Kt,!1)}get parent(){const n=er(this._path);return null===n?null:new ee(this._repo,n)}get root(){let n=this;for(;null!==n.parent;)n=n.parent;return n}}class Fe{constructor(n,t,s){this._node=n,this.ref=t,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(n){const t=new x(n),s=Qe(this.ref,n);return new Fe(this._node.getChild(t),s,U)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(n){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(s,r)=>n(new Fe(r,Qe(this.ref,s),U)))}hasChild(n){const t=new x(n);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function fo(i,n){return(i=z(i))._checkNotDeleted("ref"),void 0!==n?Qe(i._root,n):i._root}function po(i,n){(i=z(i))._checkNotDeleted("refFromURL");const t=Wi(n,i._repo.repoInfo_.nodeAdmin);Kr("refFromURL",t);const s=t.repoInfo;return!i._repo.repoInfo_.isCustomHost()&&s.host!==i._repo.repoInfo_.host&&oe("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+i._repo.repoInfo_.host+")"),fo(i,t.path.toString())}function Qe(i,n){return null===C((i=z(i))._path)?(t=n,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Nt("child","path",t,!1)):Nt("child","path",n,!1),new ee(i._repo,q(i._path,n));var t}function zi(i,n){i=z(i),$("set",i._path),ce("set",n,i._path,!1);const t=new B;return Hi(i._repo,i._path,n,null,t.wrapCallback(()=>{})),t.promise}function $d(i,n){jr("update",n,i._path,!1);const t=new B;return function Pd(i,n,t,s){tt(i,"update",{path:n.toString(),value:t});let r=!0;const o=Ut(i),a={};if(M(t,(l,c)=>{r=!1,a[l]=Yr(q(n,l),L(c),i.serverSyncTree_,o)}),r)D("update() called with empty data.  Don't do anything."),Ae(0,s,"ok",void 0);else{const l=yn(i),c=function od(i,n,t,s){!function Zu(i,n,t,s){g(s>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:n,children:t,writeId:s,visible:!0}),i.visibleWrites=mi(i.visibleWrites,n,t),i.lastWriteId=s}(i.pendingWriteTree_,n,t,s);const r=k.fromObject(t);return et(i,new $e({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,r))}(i.serverSyncTree_,n,a,l);vn(i.eventQueue_,c),i.server_.merge(n.toString(),t,(u,f)=>{const d="ok"===u;d||V("update at "+n+" failed: "+u);const p=Ze(i.serverSyncTree_,l,!d),_=p.length>0?nt(i,n):n;X(i.eventQueue_,_,p),Ae(0,s,u,f)}),M(t,u=>{const f=Bi(i,q(n,u));nt(i,f)}),X(i.eventQueue_,n,[])}}(i._repo,i._path,n,t.wrapCallback(()=>{})),t.promise}function Xd(i){return function Ld(i,n){const t=function hd(i,n){const t=n._path;let s=null;i.syncPointTree_.foreachOnPath(t,(u,f)=>{const d=J(u,t);s=s||Ce(f,d)});let r=i.syncPointTree_.get(t);r?s=s||Ce(r,w()):(r=new Pr,i.syncPointTree_=i.syncPointTree_.set(t,r));const o=null!=s,a=o?new ye(s,!0,!1):null;return function zu(i){return sn(i.viewCache_)}(Rr(r,n,rn(i.pendingWriteTree_,n._path),o?a.getNode():b.EMPTY_NODE,o))}(i.serverSyncTree_,n);return null!=t?Promise.resolve(t):i.server_.get(n).then(s=>{const r=L(s).withIndex(n._queryParams.getIndex()),o=At(i.serverSyncTree_,n._path,r);return Fi(i.eventQueue_,n._path,o),Promise.resolve(r)},s=>(tt(i,"get for query "+P(n)+" failed: "+s),Promise.reject(new Error(s))))}((i=z(i))._repo,i).then(n=>new Fe(n,new ee(i._repo,i._path),i._queryParams.getIndex()))}class An{constructor(n){this.callbackContext=n}respondsTo(n){return"value"===n}createEvent(n,t){const s=t._queryParams.getIndex();return new lo("value",this,new Fe(n.snapshotNode,new ee(t._repo,t._path),s))}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,null)}createCancelEvent(n,t){return this.callbackContext.hasCancelCallback?new co(this,n,t):null}matches(n){return n instanceof An&&(!n.callbackContext||!this.callbackContext||n.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class wn{constructor(n,t){this.eventType=n,this.callbackContext=t}respondsTo(n){let t="children_added"===n?"child_added":n;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(n,t){return this.callbackContext.hasCancelCallback?new co(this,n,t):null}createEvent(n,t){g(null!=n.childName,"Child events should have a childName.");const s=Qe(new ee(t._repo,t._path),n.childName),r=t._queryParams.getIndex();return new lo(n.type,this,new Fe(n.snapshotNode,s,r),n.prevName)}getEventRunner(n){return"cancel"===n.getEventType()?()=>this.callbackContext.onCancel(n.error):()=>this.callbackContext.onValue(n.snapshot,n.prevName)}matches(n){return n instanceof wn&&this.eventType===n.eventType&&(!this.callbackContext||!n.callbackContext||this.callbackContext.matches(n.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function kt(i,n,t,s,r){let o;if("object"==typeof s&&(o=void 0,r=s),"function"==typeof s&&(o=s),r&&r.onlyOnce){const c=t,u=(f,d)=>{Vi(i._repo,i,l),c(f,d)};u.userCallback=t.userCallback,u.context=t.context,t=u}const a=new uo(t,o||void 0),l="value"===n?new An(a):new wn(n,a);return function Fd(i,n,t){let s;s=".info"===C(n._path)?Qr(i.infoSyncTree_,n,t):Qr(i.serverSyncTree_,n,t),Fi(i.eventQueue_,n._path,s)}(i._repo,i,l),()=>Vi(i._repo,i,l)}function Gi(i,n,t,s){return kt(i,"value",n,t,s)}function go(i,n,t,s){return kt(i,"child_added",n,t,s)}function _o(i,n,t,s){return kt(i,"child_changed",n,t,s)}function mo(i,n,t,s){return kt(i,"child_moved",n,t,s)}function vo(i,n,t,s){return kt(i,"child_removed",n,t,s)}function yo(i,n,t){let s=null;const r=t?new uo(t):null;"value"===n?s=new An(r):n&&(s=new wn(n,r)),Vi(i._repo,i,s)}class se{}class bo extends se{constructor(n,t){super(),this._value=n,this._key=t}_apply(n){ce("endAt",this._value,n._path,!0);const t=ui(n._queryParams,this._value,this._key);if(Zn(t),we(t),n._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new W(n._repo,n._path,t,n._orderByCalled)}}class th extends se{constructor(n,t){super(),this._value=n,this._key=t}_apply(n){ce("endBefore",this._value,n._path,!1);const t=function uu(i,n,t){let s,r;return i.index_===le?("string"==typeof n&&(n=fr(n)),r=ui(i,n,t)):(s=null==t?he:fr(t),r=ui(i,n,s)),r.endBeforeSet_=!0,r}(n._queryParams,this._value,this._key);if(Zn(t),we(t),n._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new W(n._repo,n._path,t,n._orderByCalled)}}class Co extends se{constructor(n,t){super(),this._value=n,this._key=t}_apply(n){ce("startAt",this._value,n._path,!0);const t=ci(n._queryParams,this._value,this._key);if(Zn(t),we(t),n._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new W(n._repo,n._path,t,n._orderByCalled)}}class sh extends se{constructor(n,t){super(),this._value=n,this._key=t}_apply(n){ce("startAfter",this._value,n._path,!1);const t=function cu(i,n,t){let s;if(i.index_===le)"string"==typeof n&&(n=hr(n)),s=ci(i,n,t);else{let r;r=null==t?ae:hr(t),s=ci(i,n,r)}return s.startAfterSet_=!0,s}(n._queryParams,this._value,this._key);if(Zn(t),we(t),n._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new W(n._repo,n._path,t,n._orderByCalled)}}class oh extends se{constructor(n){super(),this._limit=n}_apply(n){if(n._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new W(n._repo,n._path,function au(i,n){const t=i.copy();return t.limitSet_=!0,t.limit_=n,t.viewFrom_="l",t}(n._queryParams,this._limit),n._orderByCalled)}}class lh extends se{constructor(n){super(),this._limit=n}_apply(n){if(n._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new W(n._repo,n._path,function lu(i,n){const t=i.copy();return t.limitSet_=!0,t.limit_=n,t.viewFrom_="r",t}(n._queryParams,this._limit),n._orderByCalled)}}class uh extends se{constructor(n){super(),this._path=n}_apply(n){Tn(n,"orderByChild");const t=new x(this._path);if(T(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new ri(t),r=$t(n._queryParams,s);return we(r),new W(n._repo,n._path,r,!0)}}class hh extends se{_apply(n){Tn(n,"orderByKey");const t=$t(n._queryParams,le);return we(t),new W(n._repo,n._path,t,!0)}}class ph extends se{_apply(n){Tn(n,"orderByPriority");const t=$t(n._queryParams,U);return we(t),new W(n._repo,n._path,t,!0)}}class _h extends se{_apply(n){Tn(n,"orderByValue");const t=$t(n._queryParams,oi);return we(t),new W(n._repo,n._path,t,!0)}}class vh extends se{constructor(n,t){super(),this._value=n,this._key=t}_apply(n){if(ce("equalTo",this._value,n._path,!1),n._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(n._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new bo(this._value,this._key)._apply(new Co(this._value,this._key)._apply(n))}}function re(i,...n){let t=z(i);for(const s of n)t=s._apply(t);return t}(function $u(i){g(!cn,"__referenceConstructor has already been defined"),cn=i})(ee),function id(i){g(!dn,"__referenceConstructor has already been defined"),dn=i}(ee);const ji={};function Zo(i,n,t,s,r){let o=s||i.options.databaseURL;void 0===o&&(i.options.projectId||oe("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),D("Using default host for project ",i.options.projectId),o=`${i.options.projectId}-default-rtdb.firebaseio.com`);let c,u,a=Wi(o,r),l=a.repoInfo;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(c=!0,o=`http://${u}?ns=${l.namespace}`,a=Wi(o,r),l=a.repoInfo):c=!a.repoInfo.secure;const f=r&&c?new ut(ut.OWNER):new uc(i.name,i.options,n);Kr("Invalid Firebase Database URL",a),T(a.path)||oe("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function Zh(i,n,t,s){let r=ji[n.name];r||(r={},ji[n.name]=r);let o=r[i.toURLString()];return o&&oe("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Ud(i,false,t,s),r[i.toURLString()]=o,o}(l,i,f,new cc(i.name,t));return new wh(d,i)}class wh{constructor(n,t){this._repoInternal=n,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function kd(i,n,t){if(i.stats_=Gn(i.repoInfo_),i.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)i.server_=new Xt(i.repoInfo_,(s,r,o,a)=>{to(i,s,r,o,a)},i.authTokenProvider_,i.appCheckProvider_),setTimeout(()=>no(i,!0),0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{P(t)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}i.persistentConnection_=new Pe(i.repoInfo_,n,(s,r,o,a)=>{to(i,s,r,o,a)},s=>{no(i,s)},s=>{!function qd(i,n){M(n,(t,s)=>{Qi(i,t,s)})}(i,s)},i.authTokenProvider_,i.appCheckProvider_,t),i.server_=i.persistentConnection_}i.authTokenProvider_.addTokenChangeListener(s=>{i.server_.refreshAuthToken(s)}),i.appCheckProvider_.addTokenChangeListener(s=>{i.server_.refreshAppCheckToken(s.token)}),i.statsReporter_=function pc(i,n){const t=i.toString();return zn[t]||(zn[t]=n()),zn[t]}(i.repoInfo_,()=>new _u(i.stats_,i.server_)),i.infoData_=new du,i.infoSyncTree_=new Fr({startListening:(s,r,o,a)=>{let l=[];const c=i.infoData_.getNode(s._path);return c.isEmpty()||(l=At(i.infoSyncTree_,s._path,c),setTimeout(()=>{a("ok")},0)),l},stopListening:()=>{}}),Qi(i,"connected",!1),i.serverSyncTree_=new Fr({startListening:(s,r,o,a)=>(i.server_.listen(s,o,r,(l,c)=>{const u=a(l,c);X(i.eventQueue_,s._path,u)}),[]),stopListening:(s,r)=>{i.server_.unlisten(s,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ee(this._repo,w())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function Th(i,n){const t=ji[n];(!t||t[i.key]!==i)&&oe(`Database ${n}(${i.repoInfo_}) has already been deleted.`),so(i),delete t[i.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){null===this._rootInternal&&oe("Cannot call "+n+" on a deleted database.")}}function Ih(i,n){As(i,n)}const Uh={".sv":"timestamp"};class Lh{constructor(n,t){this.committed=n,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}Pe.prototype.simpleListen=function(i,n){this.sendRequest("q",{p:i},n)},Pe.prototype.echo=function(i,n){this.sendRequest("echo",{d:i},n)},function Nh(i){ys(Ht.SDK_VERSION),(0,Ht._registerComponent)(new Dn("database",(n,{instanceIdentifier:t})=>Zo(n.getProvider("app").getImmediate(),n.getProvider("auth-internal"),n.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Ht.registerVersion)(ms,"0.12.5",i),(0,Ht.registerVersion)(ms,"0.12.5","esm2017")}();const Dh=new _s("@firebase/database-compat"),Ao=function(i){Dh.warn("FIREBASE WARNING: "+i)};class Qh{constructor(n){this._delegate=n}cancel(n){v("OnDisconnect.cancel",0,1,arguments.length),O("OnDisconnect.cancel","onComplete",n,!0);const t=this._delegate.cancel();return n&&t.then(()=>n(null),s=>n(s)),t}remove(n){v("OnDisconnect.remove",0,1,arguments.length),O("OnDisconnect.remove","onComplete",n,!0);const t=this._delegate.remove();return n&&t.then(()=>n(null),s=>n(s)),t}set(n,t){v("OnDisconnect.set",1,2,arguments.length),O("OnDisconnect.set","onComplete",t,!0);const s=this._delegate.set(n);return t&&s.then(()=>t(null),r=>t(r)),s}setWithPriority(n,t,s){v("OnDisconnect.setWithPriority",2,3,arguments.length),O("OnDisconnect.setWithPriority","onComplete",s,!0);const r=this._delegate.setWithPriority(n,t);return s&&r.then(()=>s(null),o=>s(o)),r}update(n,t){if(v("OnDisconnect.update",1,2,arguments.length),Array.isArray(n)){const r={};for(let o=0;o<n.length;++o)r[""+o]=n[o];n=r,Ao("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}O("OnDisconnect.update","onComplete",t,!0);const s=this._delegate.update(n);return t&&s.then(()=>t(null),r=>t(r)),s}}class Hh{constructor(n,t){this.committed=n,this.snapshot=t}toJSON(){return v("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class xe{constructor(n,t){this._database=n,this._delegate=t}val(){return v("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return v("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return v("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return v("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(n){return v("DataSnapshot.child",0,1,arguments.length),n=String(n),Nt("DataSnapshot.child","path",n,!1),new xe(this._database,this._delegate.child(n))}hasChild(n){return v("DataSnapshot.hasChild",1,1,arguments.length),Nt("DataSnapshot.hasChild","path",n,!1),this._delegate.hasChild(n)}getPriority(){return v("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(n){return v("DataSnapshot.forEach",1,1,arguments.length),O("DataSnapshot.forEach","action",n,!1),this._delegate.forEach(t=>n(new xe(this._database,t)))}hasChildren(){return v("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return v("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return v("DataSnapshot.ref",0,0,arguments.length),new G(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Q{constructor(n,t){this.database=n,this._delegate=t}on(n,t,s,r){var o;v("Query.on",2,4,arguments.length),O("Query.on","callback",t,!1);const a=Q.getCancelAndContextArgs_("Query.on",s,r),l=(u,f)=>{t.call(a.context,new xe(this.database,u),f)};l.userCallback=t,l.context=a.context;const c=null===(o=a.cancel)||void 0===o?void 0:o.bind(a.context);switch(n){case"value":return Gi(this._delegate,l,c),t;case"child_added":return go(this._delegate,l,c),t;case"child_removed":return vo(this._delegate,l,c),t;case"child_changed":return _o(this._delegate,l,c),t;case"child_moved":return mo(this._delegate,l,c),t;default:throw new Error(H("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(n,t,s){if(v("Query.off",0,3,arguments.length),function(i,n,t){if(void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(H("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,n),O("Query.off","callback",t,!0),fs("Query.off","context",s,!0),t){const r=()=>{};r.userCallback=t,r.context=s,yo(this._delegate,n,r)}else yo(this._delegate,n)}get(){return Xd(this._delegate).then(n=>new xe(this.database,n))}once(n,t,s,r){v("Query.once",1,4,arguments.length),O("Query.once","callback",t,!0);const o=Q.getCancelAndContextArgs_("Query.once",s,r),a=new B,l=(u,f)=>{const d=new xe(this.database,u);t&&t.call(o.context,d,f),a.resolve(d)};l.userCallback=t,l.context=o.context;const c=u=>{o.cancel&&o.cancel.call(o.context,u),a.reject(u)};switch(n){case"value":Gi(this._delegate,l,c,{onlyOnce:!0});break;case"child_added":go(this._delegate,l,c,{onlyOnce:!0});break;case"child_removed":vo(this._delegate,l,c,{onlyOnce:!0});break;case"child_changed":_o(this._delegate,l,c,{onlyOnce:!0});break;case"child_moved":mo(this._delegate,l,c,{onlyOnce:!0});break;default:throw new Error(H("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return a.promise}limitToFirst(n){return v("Query.limitToFirst",1,1,arguments.length),new Q(this.database,re(this._delegate,function ah(i){if("number"!=typeof i||Math.floor(i)!==i||i<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new oh(i)}(n)))}limitToLast(n){return v("Query.limitToLast",1,1,arguments.length),new Q(this.database,re(this._delegate,function ch(i){if("number"!=typeof i||Math.floor(i)!==i||i<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new lh(i)}(n)))}orderByChild(n){return v("Query.orderByChild",1,1,arguments.length),new Q(this.database,re(this._delegate,function dh(i){if("$key"===i)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===i)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===i)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Nt("orderByChild","path",i,!1),new uh(i)}(n)))}orderByKey(){return v("Query.orderByKey",0,0,arguments.length),new Q(this.database,re(this._delegate,function fh(){return new hh}()))}orderByPriority(){return v("Query.orderByPriority",0,0,arguments.length),new Q(this.database,re(this._delegate,function gh(){return new ph}()))}orderByValue(){return v("Query.orderByValue",0,0,arguments.length),new Q(this.database,re(this._delegate,function mh(){return new _h}()))}startAt(n=null,t){return v("Query.startAt",0,2,arguments.length),new Q(this.database,re(this._delegate,function ih(i=null,n){return It("startAt","key",n,!0),new Co(i,n)}(n,t)))}startAfter(n=null,t){return v("Query.startAfter",0,2,arguments.length),new Q(this.database,re(this._delegate,function rh(i,n){return It("startAfter","key",n,!0),new sh(i,n)}(n,t)))}endAt(n=null,t){return v("Query.endAt",0,2,arguments.length),new Q(this.database,re(this._delegate,function eh(i,n){return It("endAt","key",n,!0),new bo(i,n)}(n,t)))}endBefore(n=null,t){return v("Query.endBefore",0,2,arguments.length),new Q(this.database,re(this._delegate,function nh(i,n){return It("endBefore","key",n,!0),new th(i,n)}(n,t)))}equalTo(n,t){return v("Query.equalTo",1,2,arguments.length),new Q(this.database,re(this._delegate,function yh(i,n){return It("equalTo","key",n,!0),new vh(i,n)}(n,t)))}toString(){return v("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return v("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(n){if(v("Query.isEqual",1,1,arguments.length),!(n instanceof Q))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(n._delegate)}static getCancelAndContextArgs_(n,t,s){const r={cancel:void 0,context:void 0};if(t&&s)r.cancel=t,O(n,"cancel",r.cancel,!0),r.context=s,fs(n,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(H(n,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new G(this.database,new ee(this._delegate._repo,this._delegate._path))}}class G extends Q{constructor(n,t){super(n,new W(t._repo,t._path,new Kt,!1)),this.database=n,this._delegate=t}getKey(){return v("Reference.key",0,0,arguments.length),this._delegate.key}child(n){return v("Reference.child",1,1,arguments.length),"number"==typeof n&&(n=String(n)),new G(this.database,Qe(this._delegate,n))}getParent(){v("Reference.parent",0,0,arguments.length);const n=this._delegate.parent;return n?new G(this.database,n):null}getRoot(){return v("Reference.root",0,0,arguments.length),new G(this.database,this._delegate.root)}set(n,t){v("Reference.set",1,2,arguments.length),O("Reference.set","onComplete",t,!0);const s=zi(this._delegate,n);return t&&s.then(()=>t(null),r=>t(r)),s}update(n,t){if(v("Reference.update",1,2,arguments.length),Array.isArray(n)){const r={};for(let o=0;o<n.length;++o)r[""+o]=n[o];n=r,Ao("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$("Reference.update",this._delegate._path),O("Reference.update","onComplete",t,!0);const s=$d(this._delegate,n);return t&&s.then(()=>t(null),r=>t(r)),s}setWithPriority(n,t,s){v("Reference.setWithPriority",2,3,arguments.length),O("Reference.setWithPriority","onComplete",s,!0);const r=function Kd(i,n,t){if($("setWithPriority",i._path),ce("setWithPriority",n,i._path,!1),Mi("setWithPriority",t,!1),".length"===i.key||".keys"===i.key)throw"setWithPriority failed: "+i.key+" is a read-only object.";const s=new B;return Hi(i._repo,i._path,n,t,s.wrapCallback(()=>{})),s.promise}(this._delegate,n,t);return s&&r.then(()=>s(null),o=>s(o)),r}remove(n){v("Reference.remove",0,1,arguments.length),O("Reference.remove","onComplete",n,!0);const t=function Gd(i){return $("remove",i._path),zi(i,null)}(this._delegate);return n&&t.then(()=>n(null),s=>n(s)),t}transaction(n,t,s){v("Reference.transaction",1,3,arguments.length),O("Reference.transaction","transactionUpdate",n,!1),O("Reference.transaction","onComplete",t,!0),function(i,n,t,s){if(void 0!==t&&"boolean"!=typeof t)throw new Error(H("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,s);const r=function Ph(i,n,t){var s;if(i=z(i),$("Reference.transaction",i._path),".length"===i.key||".keys"===i.key)throw"Reference.transaction failed: "+i.key+" is a read-only object.";const r=null===(s=null==t?void 0:t.applyLocally)||void 0===s||s,o=new B,l=Gi(i,()=>{});return function Hd(i,n,t,s,r,o){tt(i,"transaction on "+n);const a={path:n,update:t,onComplete:s,status:null,order:Cs(),applyLocally:o,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Ji(i,n,void 0);a.currentInputSnapshot=l;const c=a.update(l.val());if(void 0===c)a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete&&a.onComplete(null,!1,a.currentInputSnapshot);else{Et("transaction failed: Data returned ",c,a.path),a.status=0;const u=gn(i.transactionQueueTree_,n),f=Me(u)||[];let d;f.push(a),Ri(u,f),"object"==typeof c&&null!==c&&te(c,".priority")?(d=Ie(c,".priority"),g(St(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(hn(i.serverSyncTree_,n)||b.EMPTY_NODE).getPriority().val();const p=Ut(i),_=L(c,d),m=qi(_,l,p);a.currentOutputSnapshotRaw=_,a.currentOutputSnapshotResolved=m,a.currentWriteId=yn(i);const S=xi(i.serverSyncTree_,n,m,a.currentWriteId,a.applyLocally);X(i.eventQueue_,n,S),bn(i,i.transactionQueueTree_)}}(i._repo,i._path,n,(c,u,f)=>{let d=null;c?o.reject(c):(d=new Fe(f,new ee(i._repo,i._path),U),o.resolve(new Lh(u,d)))},l,r),o.promise}(this._delegate,n,{applyLocally:s}).then(o=>new Hh(o.committed,new xe(this.database,o.snapshot)));return t&&r.then(o=>t(null,o.committed,o.snapshot),o=>t(o,!1,null)),r}setPriority(n,t){v("Reference.setPriority",1,2,arguments.length),O("Reference.setPriority","onComplete",t,!0);const s=function jd(i,n){i=z(i),$("setPriority",i._path),Mi("setPriority",n,!1);const t=new B;return Hi(i._repo,q(i._path,".priority"),n,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,n);return t&&s.then(()=>t(null),r=>t(r)),s}push(n,t){v("Reference.push",0,2,arguments.length),O("Reference.push","onComplete",t,!0);const s=function zd(i,n){i=z(i),$("push",i._path),ce("push",n,i._path,!0);const t=eo(i._repo),s=iu(t),r=Qe(i,s),o=Qe(i,s);let a;return a=null!=n?zi(o,n).then(()=>o):Promise.resolve(o),r.then=a.then.bind(a),r.catch=a.then.bind(a,void 0),r}(this._delegate,n),r=s.then(a=>new G(this.database,a));t&&r.then(()=>t(null),a=>t(a));const o=new G(this.database,s);return o.then=r.then.bind(r),o.catch=r.catch.bind(r,void 0),o}onDisconnect(){return $("Reference.onDisconnect",this._delegate._path),new Qh(new ho(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class qt{constructor(n,t){this._delegate=n,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(n,t,s={}){!function xh(i,n,t,s={}){(i=z(i))._checkNotDeleted("useEmulator"),i._instanceStarted&&oe("Cannot call useEmulator() after instance has already been initialized.");const r=i._repoInternal;let o;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&oe('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new ut(ut.OWNER);else if(s.mockUserToken){const a="string"==typeof s.mockUserToken?s.mockUserToken:function Sl(i,n){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s=n||"demo-project",r=i.iat||0,o=i.sub||i.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},i);return[ls(JSON.stringify({alg:"none",type:"JWT"})),ls(JSON.stringify(a)),""].join(".")}(s.mockUserToken,i.app.options.projectId);o=new ut(a)}!function Ch(i,n,t,s){i.repoInfo_=new Yn(`${n}:${t}`,!1,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams),s&&(i.authTokenProvider_=s)}(r,n,t,o)}(this._delegate,n,t,s)}ref(n){if(v("database.ref",0,1,arguments.length),n instanceof G){const t=po(this._delegate,n.toString());return new G(this,t)}{const t=fo(this._delegate,n);return new G(this,t)}}refFromURL(n){v("database.refFromURL",1,1,arguments.length);const s=po(this._delegate,n);return new G(this,s)}goOffline(){return v("database.goOffline",0,0,arguments.length),function Sh(i){(i=z(i))._checkNotDeleted("goOffline"),so(i._repo)}(this._delegate)}goOnline(){return v("database.goOnline",0,0,arguments.length),function Eh(i){(i=z(i))._checkNotDeleted("goOnline"),function Qd(i){i.persistentConnection_&&i.persistentConnection_.resume(Xr)}(i._repo)}(this._delegate)}}qt.ServerValue={TIMESTAMP:function kh(){return Uh}(),increment:i=>function qh(i){return{".sv":{increment:i}}}(i)};var Jh=Object.freeze({__proto__:null,initStandalone:function Vh({app:i,url:n,version:t,customAuthImpl:s,namespace:r,nodeAdmin:o=!1}){ys(t);const a=new ps("auth-internal",new Gl("database-standalone"));return a.setComponent(new Dn("auth-internal",()=>s,"PRIVATE")),{instance:new qt(Zo(i,a,void 0,n,o),i),namespace:r}}});const Bh=qt.ServerValue;!function Yh(i){i.INTERNAL.registerComponent(new Dn("database-compat",(n,{instanceIdentifier:t})=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("database").getImmediate({identifier:t});return new qt(r,s)},"PUBLIC").setServiceProps({Reference:G,Query:Q,Database:qt,DataSnapshot:xe,enableLogging:Ih,INTERNAL:Jh,ServerValue:Bh}).setMultipleInstances(!0)),i.registerVersion("@firebase/database-compat","0.1.5")}(Zl.Z);var pe=y(1205),Wh=y(284);function wo(i){return null==i}function xo(i){return"function"==typeof i.set}function So(i,n){return xo(n)?n:i.ref(n)}function Eo(i,n){if(function zh(i){return"string"==typeof i}(i))return n.stringCase();if(xo(i))return n.firebaseCase();if(function Gh(i){return"function"==typeof i.exportVal}(i))return n.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof i)}function Lt(i,n,t="on",s=dl.z){return new hl.y(r=>{let o=null;return o=i[t](n,(a,l)=>{s.schedule(()=>{r.next({snapshot:a,prevKey:l})}),"once"===t&&s.schedule(()=>r.complete())},a=>{s.schedule(()=>r.error(a))}),"on"===t?{unsubscribe(){null!=o&&i.off(n,o)}}:{unsubscribe(){}}}).pipe((0,me.U)(r=>{const{snapshot:o,prevKey:a}=r;let l=null;return o.exists()&&(l=o.key),{type:n,payload:o,prevKey:a,key:l}}),(0,pl.B)())}function Io(i,n){const t=i.length;for(let s=0;s<t;s++)if(i[s].payload.key===n)return s;return-1}function $h(i,n){const{payload:t,prevKey:s,key:r}=n,o=Io(i,r),a=function Kh(i,n){if(wo(n))return 0;{const t=Io(i,n);return-1===t?i.length:t+1}}(i,s);switch(n.type){case"value":if(n.payload&&n.payload.exists()){let l=null;n.payload.forEach(c=>{const u={payload:c,type:"value",prevKey:l,key:c.key};return l=c.key,i=[...i,u],!1})}return i;case"child_added":if(o>-1){const l=i[o-1];(l&&l.key||null)!==s&&(i=i.filter(c=>c.payload.key!==t.key)).splice(a,0,n)}else{if(null==s)return[n,...i];(i=i.slice()).splice(a,0,n)}return i;case"child_removed":return i.filter(l=>l.payload.key!==t.key);case"child_changed":return i.map(l=>l.payload.key===r?n:l);case"child_moved":if(o>-1){const l=i.splice(o,1)[0];return(i=i.slice()).splice(a,0,l),i}return i;default:return i}}function No(i){return(wo(i)||0===i.length)&&(i=["child_added","child_removed","child_changed","child_moved"]),i}function Uo(i,n,t){return function jh(i,n,t){return Lt(i,"value","once",t).pipe((0,gl.w)(s=>{const r=[(0,fl.of)(s)];return n.forEach(o=>r.push(Lt(i,o,"on",t))),(0,ns.T)(...r).pipe((0,is.R)($h,[]))}),(0,_l.x)())}(i,n=No(n),t)}function ko(i,n,t){const s=(n=No(n)).map(r=>Lt(i,r,"on",t));return(0,ns.T)(...s)}function qo(i,n){return function(s,r){return Eo(s,{stringCase:()=>i.child(s)[n](r),firebaseCase:()=>s[n](r),snapshotCase:()=>s.ref[n](r)})}}function nf(i){return function(t){return t?Eo(t,{stringCase:()=>i.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):i.remove()}}function Lo(i,n){return function(){return Lt(i,"value","on",n)}}y(127);const of=new e.OlP("angularfire2.realtimeDatabaseURL"),af=new e.OlP("angularfire2.database.use-emulator");let lf=(()=>{class i{constructor(t,s,r,o,a,l,c,u,f,d,p,_,m,S,F){this.schedulers=l;const He=c,ge=(0,Ot.on)(t,a,s);u&&(0,pe.nw)(ge,a,f,p,_,m,d,S),this.database=(0,Ot.cc)(`${ge.name}.database.${r}`,"AngularFireDatabase",ge.name,()=>{const it=a.runOutsideAngular(()=>ge.database(r||void 0));return He&&it.useEmulator(...He),it},[He])}list(t,s){const r=this.schedulers.ngZone.runOutsideAngular(()=>So(this.database,t));let o=r;return s&&(o=s(r)),function sf(i,n){const t=n.schedulers.outsideAngular,s=n.schedulers.ngZone.run(()=>i.ref);return{query:i,update:qo(s,"update"),set:qo(s,"set"),push:r=>s.push(r),remove:nf(s),snapshotChanges:r=>Uo(i,r,t).pipe(Ee.iC),stateChanges:r=>ko(i,r,t).pipe(Ee.iC),auditTrail:r=>function Xh(i,n,t){return function tf(i,n,t){return function ef(i,n){return Lt(i,"value","on",n).pipe((0,me.U)(t=>{let s;return t.payload.forEach(r=>(s=r.key,!1)),{data:t,lastKeyToLoad:s}}))}(i,t).pipe(function Cl(...i){const n=(0,bl.jO)(i);return(0,ss.e)((t,s)=>{const r=i.length,o=new Array(r);let a=i.map(()=>!1),l=!1;for(let c=0;c<r;c++)(0,ml.Xf)(i[c]).subscribe((0,kn.x)(s,u=>{o[c]=u,!l&&!a[c]&&(a[c]=!0,(l=a.every(vl.y))&&(a=null))},yl.Z));t.subscribe((0,kn.x)(s,c=>{if(l){const u=[c,...o];s.next(n?n(...u):u)}}))})}(n),(0,me.U)(([r,o])=>{const a=r.lastKeyToLoad,l=o.map(c=>c.key);return{actions:o,lastKeyToLoad:a,loadedKeys:l}}),function Tl(i){return(0,ss.e)((n,t)=>{let s=!1,r=0;n.subscribe((0,kn.x)(t,o=>(s||(s=!i(o,r++)))&&t.next(o)))})}(r=>-1===r.loadedKeys.indexOf(r.lastKeyToLoad)),(0,me.U)(r=>r.actions))}(i,ko(i,n).pipe((0,is.R)((r,o)=>[...r,o],[])),t)}(i,r,t).pipe(Ee.iC),valueChanges:(r,o)=>Uo(i,r,t).pipe((0,me.U)(l=>l.map(c=>o&&o.idField?Object.assign(Object.assign({},c.payload.val()),{[o.idField]:c.key}):c.payload.val())),Ee.iC)}}(o,this)}object(t){return function rf(i,n){return{query:i,snapshotChanges:()=>Lo(i,n.schedulers.outsideAngular)().pipe(Ee.iC),update:t=>i.ref.update(t),set:t=>i.ref.set(t),remove:()=>i.ref.remove(),valueChanges:()=>Lo(i,n.schedulers.outsideAngular)().pipe(Ee.iC,(0,me.U)(s=>s.payload.exists()?s.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>So(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Ot.Dh),e.LFG(Ot.xv,8),e.LFG(of,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(Ee.HU),e.LFG(af,8),e.LFG(pe.zQ,8),e.LFG(pe.Qv,8),e.LFG(pe.L6,8),e.LFG(pe._Q,8),e.LFG(pe.rT,8),e.LFG(pe.lh,8),e.LFG(pe.f7,8),e.LFG(Wh.nm,8))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})();var Po=y(2297),Ro=y(520);let Pt=(()=>{class i{constructor(t,s,r,o){this.db=t,this.afAuth=s,this.afs=r,this.http=o,this.url="https://api.mapbox.com/geocoding/v5/mapbox.places/",R.accessToken=Se.N.mapbox.accessToken}getHouses(){}getAddress(t,s){return this.http.get(this.url+t+","+s+".json?types=place%2Cpostcode%2Caddress&limit=1&access_token="+Se.N.mapbox.accessToken)}getMarkers(){return this.forsaleCollection=this.afs.collection("buy",t=>t.orderBy("listed","asc")),this.forsaleCollection.snapshotChanges().pipe((0,me.U)(t=>t.map(s=>{const r=s.payload.doc.data();return Object.assign({id:s.payload.doc.id},r)})))}createMarker(t){return this.db.list("/markers").push(t)}removeMarker(t){return this.db.object("/markers/"+t).remove()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(lf),e.LFG(pe.zQ),e.LFG(Po.ST),e.LFG(Ro.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();var cf=y(8746),uf=y(7164);let Rt=(()=>{class i{constructor(t,s,r){this.db=t,this.storage=s,this.auth=r,this.userData=localStorage.getItem("user"),this.user=JSON.parse(this.userData),this.basePath="/"+this.user.uid+"/gallery_uploads"}pushFileToStorage(t){const s=`${this.basePath}/${t.file.name}`,r=this.storage.ref(s),o=this.storage.upload(s,t.file);return o.snapshotChanges().pipe((0,cf.x)(()=>{r.getDownloadURL().subscribe(a=>{t.url=a,t.name=t.file.name+"_"+t.file.lastModified,this.saveFileData(t)})})).subscribe(),o.percentageChanges()}saveFileData(t){const s={name:t.name,url:t.url,type:t.file.type,uploaded:this.auth.ts};return this.db.collection("file_uploads/"+this.user.uid+"/gallery").add(s).then(r=>r.id)}getFiles(){return this.uploadsCollection=this.db.collection("file_uploads/"+this.user.uid+"/gallery",t=>t.orderBy("uploaded","desc")),this.uploadsCollection.snapshotChanges().pipe((0,me.U)(t=>t.map(s=>{const r=s.payload.doc.data();return Object.assign({id:s.payload.doc.id},r)})))}deleteFile(t){this.deleteFileDatabase(t.id).then(()=>{this.deleteFileStorage(t.name)}).catch(s=>console.log(s))}deleteFileDatabase(t){return this.db.doc("file_uploads/"+this.user.uid+"/gallery/"+t).delete()}deleteFileStorage(t){this.storage.ref(this.basePath).child(t).delete()}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(Po.ST),e.LFG(uf.Q1),e.LFG(_e.e))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();class df{constructor(n){this.file=n}}const hf=function(i){return{width:i}};function ff(i,n){if(1&i&&(e.TgZ(0,"div",3)(1,"div",4),e._uU(2),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(3,hf,t.percentage+"%")),e.uIk("aria-valuenow",t.percentage),e.xp6(1),e.hij(" ",t.percentage,"% ")}}let Ki=(()=>{class i{constructor(t){this.uploadService=t,this.percentage=0}ngOnInit(){}selectFile(t){this.selectedFiles=t.target.files}upload(){if(this.selectedFiles){const t=this.selectedFiles.item(0);this.selectedFiles=void 0,t&&(this.currentFileUpload=new df(t),console.log("Filename: "+t.name),this.uploadService.pushFileToStorage(this.currentFileUpload).subscribe(s=>{this.percentage=Math.round(s||0)},s=>{console.log(s)}))}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Rt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-upload-form"]],decls:5,vars:2,consts:[["type","file",1,"text-nowrap","text-truncate",3,"change"],[1,"btn","btn-success","btn-sm",3,"disabled","click"],["class","progress mt-2",4,"ngIf"],[1,"progress","mt-2"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-info",3,"ngStyle"]],template:function(t,s){1&t&&(e.TgZ(0,"label")(1,"input",0),e.NdJ("change",function(o){return s.selectFile(o)}),e.qZA()(),e.TgZ(2,"button",1),e.NdJ("click",function(){return s.upload()}),e._uU(3," Upload "),e.qZA(),e.YNc(4,ff,3,5,"div",2)),2&t&&(e.xp6(2),e.Q6J("disabled",!s.selectedFiles),e.xp6(2),e.Q6J("ngIf",s.currentFileUpload))},directives:[A.O5,A.PC],styles:[""]}),i})();const pf=["lat"];function gf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Description is required."),e.qZA()())}function _f(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,gf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.description.errors&&t.f.description.errors.required)}}function mf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Name is required."),e.qZA()())}function vf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,mf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.name.errors&&t.f.name.errors.required)}}function yf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Number of rooms is required."),e.qZA()())}function bf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,yf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.rooms.errors&&t.f.rooms.errors.required)}}function Cf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Type is required."),e.qZA()())}function Tf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Cf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.type.errors&&t.f.type.errors.required)}}function Zf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Price is required."),e.qZA()())}function Af(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Zf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.price.errors&&t.f.price.errors.required)}}function wf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Number of bathrooms is required."),e.qZA()())}function xf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,wf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.bathrooms.errors&&t.f.bathrooms.errors.required)}}function Sf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Size is required."),e.qZA()())}function Ef(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Sf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.size.errors&&t.f.size.errors.required)}}function If(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",78)(1,"div",2)(2,"div",79),e._UZ(3,"img",80),e.qZA(),e.TgZ(4,"div",81)(5,"a",82),e._uU(6),e._UZ(7,"br"),e.TgZ(8,"small",83),e._uU(9),e.ALo(10,"date"),e.qZA()()(),e.TgZ(11,"div",84)(12,"div",85)(13,"input",86),e.NdJ("change",function(){const o=e.CHM(t).$implicit;return e.oxw().include(o)}),e.qZA()()(),e.TgZ(14,"div",87)(15,"button",88),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw().deleteFileUpload(o)}),e._uU(16," Delete "),e.qZA()()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(2),e.s9C("href",t.url,e.LSH),e.xp6(1),e.hij("",t.name," "),e.xp6(3),e.hij("Uploaded ",e.lcZ(10,4,t.uploaded.toDate()),"")}}function Nf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Full Address is required."),e.qZA()())}function Uf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Nf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fullAddress.errors&&t.f.fullAddress.errors.required)}}function kf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"County is required."),e.qZA()())}function qf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,kf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.county.errors&&t.f.county.errors.required)}}function Lf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Longitude is required."),e.qZA()())}function Pf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Lf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.longitude.errors&&t.f.longitude.errors.required)}}function Rf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Latitude is required."),e.qZA()())}function Of(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Rf,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.latitude.errors&&t.f.latitude.errors.required)}}function Df(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Terms are required."),e.qZA()())}function Mf(i,n){if(1&i&&(e.TgZ(0,"div",76),e.YNc(1,Df,3,0,"div",77),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.terms.errors&&t.f.terms.errors.required)}}let Ff=(()=>{class i{constructor(t,s,r){this.auth=t,this.mapServe=s,this.uploadService=r,this.images=[],this.form=new h.cw({description:new h.NI("",h.kI.required),name:new h.NI("",h.kI.required),bathrooms:new h.NI("",h.kI.required),rooms:new h.NI("",h.kI.required),type:new h.NI("",h.kI.required),price:new h.NI("",h.kI.required),size:new h.NI("",h.kI.required),gallery:new h.NI(""),fullAddress:new h.NI(""),county:new h.NI(""),longitude:new h.NI(""),latitude:new h.NI(""),title_deed:new h.NI(""),electricity:new h.NI(""),water:new h.NI(""),fenced:new h.NI(""),next_to_road:new h.NI(""),view:new h.NI(""),terms:new h.NI("",h.kI.required),uploader_id:new h.NI(""),uploaded:new h.NI(""),uploader_photoURL:new h.NI(""),uploader_displayName:new h.NI("")}),this.form.patchValue({lngVal:this.lngVal,latVal:this.latVal,fullAddress:this.address,county:this.address}),this.uploadService.getFiles().subscribe(o=>{this.fileUploads=o})}ngOnInit(){}ngAfterViewInit(){R.accessToken=Se.N.mapbox.accessToken,this.map=new R.Map({style:"mapbox://styles/mapbox/light-v10",center:[36.82,-1.38],zoom:11.5,pitch:45,container:"mapEl",antialias:!0});var t=new R.Marker({draggable:!0}).setLngLat([36.82588315391189,-1.3848034891855718]).addTo(this.map);this.lngVal=36.82,this.latVal=1.38,t.on("dragend",()=>{var r=t.getLngLat();r=t.getLngLat(),this.latVal=r.lng,this.lngVal=r.lat,this.mapServe.getAddress(r.lng,r.lat).subscribe(o=>{this.address=o.features[0].place_name,this.county=o.features[0].context[1].text})}),this.map.on("load",()=>{for(var o,r=this.map.getStyle().layers,a=0;a<r.length;a++)if("symbol"===r[a].type){o=r[a].id;break}this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},o)}),console.log("user data",this.auth.userData)}deleteFileUpload(t){this.uploadService.deleteFile(t)}include(t){var s,r,o;if(this.imageExists(t.id)){const a=null===(s=this.images)||void 0===s?void 0:s.indexOf(t);-1!==a&&(null===(r=this.images)||void 0===r||r.splice(a,1))}else this.imageExists(t.id)||null===(o=this.images)||void 0===o||o.push(t)}imageExists(t){var s;return null===(s=this.images)||void 0===s?void 0:s.some(function(r){return r.id===t})}setLat(t){this.latVal=t}get f(){return this.form.controls}submit(){this.form.patchValue({fullAddress:this.address,county:this.county,longitude:this.lngVal,latitude:this.latVal,gallery:this.images,uploader_id:this.auth.userData.uid,uploaded:this.auth.ts,uploader_photoURL:this.auth.userData.photoURL,uploader_displayName:this.auth.userData.displayName}),this.auth.createListing(this.form.value)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(Pt),e.Y36(Rt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-submit-homes"]],viewQuery:function(t,s){if(1&t&&e.Gf(pf,5),2&t){let r;e.iGM(r=e.CRH())&&(s.lat=r.first)}},inputs:{fileUpload:"fileUpload"},decls:201,vars:19,consts:[[1,"section"],[1,"container"],[1,"row"],[1,"col-md-4"],["id","submitListingTab","role","tablist",1,"nav","nav-tabs","tab-cards"],[1,"nav-item"],["id","basic-info-tab","data-toggle","tab","href","#basic-info","role","tab","aria-controls","basic-info","aria-selected","true",1,"nav-link","active"],["id","gallery-tab","data-toggle","tab","href","#gallery","role","tab","aria-controls","gallery","aria-selected","false",1,"nav-link"],["id","location-tab","data-toggle","tab","href","#location","role","tab","aria-controls","location","aria-selected","false",1,"nav-link"],["id","features-tab","data-toggle","tab","href","#features","role","tab","aria-controls","features","aria-selected","false",1,"nav-link"],[1,"col-md-8"],[3,"formGroup","ngSubmit"],["id","submitListingTabContent",1,"tab-content","m-0"],["id","basic-info","role","tabpanel","aria-labelledby","basic-info-tab",1,"tab-pane","fade","show","active"],[1,"col-md-12","form-group"],["formControlName","description","rows","4","placeholder","Property Description",1,"form-control"],["style","color: red;",4,"ngIf"],[1,"col-md-6","form-group"],["formControlName","name","type","text","placeholder","Property Name","name","name","value","",1,"form-control"],["formControlName","rooms","name","rooms",1,"form-control"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],[1,"col-md-6"],["formControlName","type","name","type",1,"form-control"],["value","home_rent"],["value","home_sale"],["value","staycations"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["formControlName","price","type","number","name","price","placeholder","Property Price",1,"form-control"],["formControlName","bathrooms","name","bathrooms",1,"form-control"],["formControlName","size","type","number","placeholder","Property Space (Sqft)","name","space","value","",1,"form-control"],["id","gallery","role","tabpanel","aria-labelledby","gallery-tab",1,"tab-pane","fade"],[1,"title",2,"margin-top","0%","margin-bottom","4%"],[1,"acr-form-notice"],[1,"my-3"],[1,"my-2"],[1,"card"],[1,"card-header"],[1,"list-group","list-group-flush",2,"overflow-y","auto","max-height","50vh"],["class","list-group-item",4,"ngFor","ngForOf"],["id","location","role","tabpanel","aria-labelledby","location-tab",1,"tab-pane","fade"],[1,"form-group","submit-listing-map"],["id","mapEl"],["mapEl",""],[1,"form-group"],["formControlName","fullAddress","type","text","name","address","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","county","type","text","name","county","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","longitude","type","text","name","lng","id","lngVal","placeholder","Longitude",1,"form-control",3,"value"],["formControlName","latitude","type","text","name","lat","id","latVal","placeholder","Latitude",1,"form-control",3,"value"],["lat",""],["id","features","role","tabpanel","aria-labelledby","features-tab",1,"tab-pane","fade"],[1,"col-lg-4","col-md-6","col-sm-6"],[1,"acr-listing-feature"],["formControlName","title_deed","type","checkbox","name","feature1","value",""],[1,"acr-feature-check","fas","fa-check"],[1,"acr-listing-feature-icon","flaticon-blog"],["formControlName","electricity","type","checkbox","name","feature2","value",""],[1,"acr-listing-feature-icon","flaticon-ceiling-light"],["formControlName","water","type","checkbox","name","feature3","value",""],[1,"acr-listing-feature-icon","flaticon-sink"],["formControlName","fenced","type","checkbox","name","feature4","value",""],[1,"acr-listing-feature-icon","flaticon-key"],["formControlName","next_to_road","type","checkbox","name","feature5","value",""],[1,"acr-listing-feature-icon","flaticon-garage"],["formControlName","view","type","checkbox","name","feature6","value",""],[1,"acr-listing-feature-icon","flaticon-eye"],["formControlName","garden","type","checkbox","name","feature6","value",""],[1,"custom-control","custom-checkbox"],["formControlName","terms","type","checkbox","id","termsAndConditions",1,"custom-control-input"],["for","termsAndConditions",1,"custom-control-label"],["type","submit","name","submit",1,"btn-custom",3,"disabled"],[2,"color","red"],[4,"ngIf"],[1,"list-group-item"],[1,"col-sm-4"],["alt","","srcset","",2,"display","block","max-width","230px","max-height","95px","width","auto","height","auto","border-radius","8px","border","1px solid lightgrey","image-rendering","auto","image-rendering","crisp-edges","image-rendering","pixelated","/* safari seems to support, but seems deprecated and does the same thing as the others. */\n                            image-rendering","-webkit-optimize-contrast",3,"src"],[1,"col-sm-5"],[3,"href"],[2,"font-size","10px","color","lightgray!important"],[1,"col-sm-1"],[1,"form-check","form-check-inline"],["type","checkbox","id","inlineCheckbox1","value","option1",1,"form-check-input",3,"change"],[1,"col-sm-2"],[1,"btn","btn-danger","btn-sm",2,"float","right",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6)(7,"span"),e._uU(8,"01"),e.qZA(),e._uU(9," Basic Information"),e.qZA()(),e.TgZ(10,"li",5)(11,"a",7)(12,"span"),e._uU(13,"02"),e.qZA(),e._uU(14," Gallery"),e.qZA()(),e.TgZ(15,"li",5)(16,"a",8)(17,"span"),e._uU(18,"03"),e.qZA(),e._uU(19," Location"),e.qZA()(),e.TgZ(20,"li",5)(21,"a",9)(22,"span"),e._uU(23,"04"),e.qZA(),e._uU(24," Features"),e.qZA()()()(),e.TgZ(25,"div",10)(26,"form",11),e.NdJ("ngSubmit",function(){return s.submit()}),e.TgZ(27,"div",12)(28,"div",13)(29,"div",2)(30,"div",14)(31,"label"),e._uU(32,"Property Description"),e.qZA(),e._UZ(33,"textarea",15),e.YNc(34,_f,2,1,"div",16),e.qZA(),e.TgZ(35,"div",17)(36,"label"),e._uU(37,"Property Name"),e.qZA(),e._UZ(38,"input",18),e.YNc(39,vf,2,1,"div",16),e.qZA(),e.TgZ(40,"div",17)(41,"label"),e._uU(42,"Number of Rooms"),e.qZA(),e.TgZ(43,"select",19)(44,"option",20),e._uU(45,"1"),e.qZA(),e.TgZ(46,"option",21),e._uU(47,"2"),e.qZA(),e.TgZ(48,"option",22),e._uU(49,"3"),e.qZA(),e.TgZ(50,"option",23),e._uU(51,"4"),e.qZA(),e.TgZ(52,"option",24),e._uU(53,"5"),e.qZA()(),e.YNc(54,bf,2,1,"div",16),e.qZA(),e.TgZ(55,"div",25)(56,"label"),e._uU(57,"Property Type"),e.qZA(),e.TgZ(58,"select",26)(59,"option",27),e._uU(60,"Home For Rent"),e.qZA(),e.TgZ(61,"option",28),e._uU(62,"Home For Sale"),e.qZA(),e.TgZ(63,"option",29),e._uU(64,"Staycations"),e.qZA()(),e.YNc(65,Tf,2,1,"div",16),e.qZA(),e.TgZ(66,"div",17)(67,"label"),e._uU(68,"Property Price"),e.qZA(),e.TgZ(69,"div",30)(70,"div",31)(71,"span",32),e._uU(72,"Kes"),e.qZA()(),e._UZ(73,"input",33),e.qZA(),e.YNc(74,Af,2,1,"div",16),e.qZA(),e.TgZ(75,"div",17)(76,"label"),e._uU(77,"Number of bathrooms"),e.qZA(),e.TgZ(78,"select",34)(79,"option",20),e._uU(80,"1"),e.qZA(),e.TgZ(81,"option",21),e._uU(82,"2"),e.qZA(),e.TgZ(83,"option",22),e._uU(84,"3"),e.qZA(),e.TgZ(85,"option",23),e._uU(86,"4"),e.qZA(),e.TgZ(87,"option",24),e._uU(88,"5"),e.qZA()(),e.YNc(89,xf,2,1,"div",16),e.qZA(),e.TgZ(90,"div",17)(91,"label"),e._uU(92,"Property Space / Lot size (Acres)"),e.qZA(),e._UZ(93,"input",35),e.YNc(94,Ef,2,1,"div",16),e.qZA()()(),e.TgZ(95,"div",36)(96,"div")(97,"h4",37),e._uU(98," Pick and/or upload images of the property "),e.qZA(),e.TgZ(99,"span",38),e._uU(100,"*You can upload up only up to 5 images for your listing"),e.qZA(),e.TgZ(101,"span",38),e._uU(102,"*Your images should have a height below 600px"),e.qZA(),e.TgZ(103,"span",38),e._uU(104,"*Your first upload will serve as the thumbnail for the "),e.qZA(),e.TgZ(105,"span",38),e._uU(106,"*Listing images should be atleast 620x480 in dimensions"),e.qZA()(),e.TgZ(107,"div",39),e._UZ(108,"app-upload-form"),e.qZA(),e.TgZ(109,"div",40)(110,"div",41)(111,"div",42),e._uU(112,"List of Files"),e.qZA(),e.TgZ(113,"ul",43),e.YNc(114,If,17,6,"li",44),e.qZA()()()(),e.TgZ(115,"div",45)(116,"div",46),e._UZ(117,"div",47,48),e.qZA(),e.TgZ(119,"div",49)(120,"span",38),e._uU(121,"Drag and drop the marker to identify your "),e.TgZ(122,"b"),e._uU(123,"Latitude"),e.qZA(),e._uU(124," and "),e.TgZ(125,"b"),e._uU(126,"Longitude"),e.qZA()()(),e.TgZ(127,"div",2)(128,"div",14)(129,"label"),e._uU(130,"Full Address"),e.qZA(),e._UZ(131,"input",50),e.YNc(132,Uf,2,1,"div",16),e.qZA(),e.TgZ(133,"div",14)(134,"label"),e._uU(135,"County"),e.qZA(),e._UZ(136,"input",51),e.YNc(137,qf,2,1,"div",16),e.qZA(),e.TgZ(138,"div",17)(139,"label"),e._uU(140,"Longitude"),e.qZA(),e._UZ(141,"input",52),e.YNc(142,Pf,2,1,"div",16),e.qZA(),e.TgZ(143,"div",17)(144,"label"),e._uU(145,"Latitude"),e.qZA(),e._UZ(146,"input",53,54),e.YNc(148,Of,2,1,"div",16),e.qZA()()(),e.TgZ(149,"div",55)(150,"div",2)(151,"div",56)(152,"label",57),e._UZ(153,"input",58)(154,"i",59)(155,"i",60),e._uU(156," Ready Title Deed "),e.qZA()(),e.TgZ(157,"div",56)(158,"label",57),e._UZ(159,"input",61)(160,"i",59)(161,"i",62),e._uU(162," Electricity Avaliable "),e.qZA()(),e.TgZ(163,"div",56)(164,"label",57),e._UZ(165,"input",63)(166,"i",59)(167,"i",64),e._uU(168," Water Avalaible "),e.qZA()(),e.TgZ(169,"div",56)(170,"label",57),e._UZ(171,"input",65)(172,"i",59)(173,"i",66),e._uU(174," Fenced "),e.qZA()(),e.TgZ(175,"div",56)(176,"label",57),e._UZ(177,"input",67)(178,"i",59)(179,"i",68),e._uU(180," Next to Road "),e.qZA()(),e.TgZ(181,"div",56)(182,"label",57),e._UZ(183,"input",69)(184,"i",59)(185,"i",70),e._uU(186," Pets Allowed "),e.qZA()(),e.TgZ(187,"div",56)(188,"label",57),e._UZ(189,"input",71)(190,"i",59)(191,"i",70),e._uU(192," Garden "),e.qZA()()(),e.TgZ(193,"div",49)(194,"div",72),e._UZ(195,"input",73),e.TgZ(196,"label",74),e._uU(197,"I Agree to the terms & Conditions of Property Submission"),e.qZA()(),e.YNc(198,Mf,2,1,"div",16),e.qZA(),e.TgZ(199,"button",75),e._uU(200,"Submit Listing"),e.qZA()()()()()()()()),2&t&&(e.xp6(26),e.Q6J("formGroup",s.form),e.xp6(8),e.Q6J("ngIf",s.f.description.touched&&s.f.description.invalid),e.xp6(5),e.Q6J("ngIf",s.f.name.touched&&s.f.name.invalid),e.xp6(15),e.Q6J("ngIf",s.f.rooms.touched&&s.f.rooms.invalid),e.xp6(11),e.Q6J("ngIf",s.f.type.touched&&s.f.type.invalid),e.xp6(9),e.Q6J("ngIf",s.f.price.touched&&s.f.price.invalid),e.xp6(15),e.Q6J("ngIf",s.f.bathrooms.touched&&s.f.bathrooms.invalid),e.xp6(5),e.Q6J("ngIf",s.f.size.touched&&s.f.size.invalid),e.xp6(20),e.Q6J("ngForOf",s.fileUploads),e.xp6(17),e.s9C("value",s.address),e.xp6(1),e.Q6J("ngIf",s.f.fullAddress.touched&&s.f.fullAddress.invalid),e.xp6(4),e.s9C("value",s.county),e.xp6(1),e.Q6J("ngIf",s.f.county.touched&&s.f.county.invalid),e.xp6(4),e.Q6J("value",s.lngVal),e.xp6(1),e.Q6J("ngIf",s.f.longitude.touched&&s.f.longitude.invalid),e.xp6(4),e.Q6J("value",s.latVal),e.xp6(2),e.Q6J("ngIf",s.f.latitude.touched&&s.f.latitude.invalid),e.xp6(50),e.Q6J("ngIf",s.f.terms.touched&&s.f.terms.invalid),e.xp6(1),e.Q6J("disabled",s.form.invalid))},directives:[h._Y,h.JL,h.sg,h.Fj,h.JJ,h.u,A.O5,h.EJ,h.YN,h.Kr,h.wV,Ki,A.sg,h.Wl],pipes:[A.uU],styles:[""]}),i})();const Qf=["lat"];function Hf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Description is required."),e.qZA()())}function Vf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,Hf,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.description.errors&&t.f.description.errors.required)}}function Jf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Name is required."),e.qZA()())}function Bf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,Jf,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.name.errors&&t.f.name.errors.required)}}function Yf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Status is required."),e.qZA()())}function Wf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,Yf,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.status.errors&&t.f.status.errors.required)}}function zf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Type is required."),e.qZA()())}function Gf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,zf,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.type.errors&&t.f.type.errors.required)}}function jf(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Price is required."),e.qZA()())}function Kf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,jf,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.price.errors&&t.f.price.errors.required)}}function $f(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Size is required."),e.qZA()())}function Xf(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,$f,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.size.errors&&t.f.size.errors.required)}}function ep(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",72)(1,"div",2)(2,"div",73),e._UZ(3,"img",74),e.qZA(),e.TgZ(4,"div",75)(5,"a",76),e._uU(6),e._UZ(7,"br"),e.TgZ(8,"small",77),e._uU(9),e.ALo(10,"date"),e.qZA()()(),e.TgZ(11,"div",78)(12,"div",79)(13,"input",80),e.NdJ("change",function(){const o=e.CHM(t).$implicit;return e.oxw().include(o)}),e.qZA()()(),e.TgZ(14,"div",81)(15,"button",82),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw().deleteFileUpload(o)}),e._uU(16," Delete "),e.qZA()()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(2),e.s9C("href",t.url,e.LSH),e.xp6(1),e.hij("",t.name," "),e.xp6(3),e.hij("Uploaded ",e.lcZ(10,4,t.uploaded.toDate()),"")}}function tp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Full Address is required."),e.qZA()())}function np(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,tp,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fullAddress.errors&&t.f.fullAddress.errors.required)}}function ip(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"County is required."),e.qZA()())}function sp(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,ip,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.county.errors&&t.f.county.errors.required)}}function rp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Longitude is required."),e.qZA()())}function op(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,rp,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.longitude.errors&&t.f.longitude.errors.required)}}function ap(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Latitude is required."),e.qZA()())}function lp(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,ap,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.latitude.errors&&t.f.latitude.errors.required)}}function cp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Terms are required."),e.qZA()())}function up(i,n){if(1&i&&(e.TgZ(0,"div",70),e.YNc(1,cp,3,0,"div",71),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.terms.errors&&t.f.terms.errors.required)}}let dp=(()=>{class i{constructor(t,s,r){this.auth=t,this.mapServe=s,this.uploadService=r,this.images=[],this.form=new h.cw({description:new h.NI("",h.kI.required),name:new h.NI("",h.kI.required),status:new h.NI("",h.kI.required),type:new h.NI("",h.kI.required),price:new h.NI("",h.kI.required),size:new h.NI("",h.kI.required),gallery:new h.NI(""),fullAddress:new h.NI(""),county:new h.NI(""),longitude:new h.NI(""),latitude:new h.NI(""),title_deed:new h.NI(""),electricity:new h.NI(""),water:new h.NI(""),fenced:new h.NI(""),next_to_road:new h.NI(""),view:new h.NI(""),terms:new h.NI("",h.kI.required),uploader_id:new h.NI(""),uploaded:new h.NI(""),uploader_photoURL:new h.NI(""),uploader_displayName:new h.NI("")}),this.form.patchValue({lngVal:this.lngVal,latVal:this.latVal,fullAddress:this.address,county:this.address}),this.uploadService.getFiles().subscribe(o=>{this.fileUploads=o})}ngOnInit(){}ngAfterViewInit(){R.accessToken=Se.N.mapbox.accessToken,this.map=new R.Map({style:"mapbox://styles/mapbox/light-v10",center:[36.82,-1.38],zoom:11.5,pitch:45,container:"mapEl",antialias:!0});var t=new R.Marker({draggable:!0}).setLngLat([36.82588315391189,-1.3848034891855718]).addTo(this.map);this.lngVal=36.82,this.latVal=1.38,t.on("dragend",()=>{var r=t.getLngLat();r=t.getLngLat(),this.latVal=r.lng,this.lngVal=r.lat,this.mapServe.getAddress(r.lng,r.lat).subscribe(o=>{this.address=o.features[0].place_name,this.county=o.features[0].context[1].text})}),this.map.on("load",()=>{for(var o,r=this.map.getStyle().layers,a=0;a<r.length;a++)if("symbol"===r[a].type){o=r[a].id;break}this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},o)}),console.log("user data",this.auth.userData)}deleteFileUpload(t){this.uploadService.deleteFile(t)}include(t){var s,r,o;if(this.imageExists(t.id)){const a=null===(s=this.images)||void 0===s?void 0:s.indexOf(t);-1!==a&&(null===(r=this.images)||void 0===r||r.splice(a,1))}else this.imageExists(t.id)||null===(o=this.images)||void 0===o||o.push(t)}imageExists(t){var s;return null===(s=this.images)||void 0===s?void 0:s.some(function(r){return r.id===t})}setLat(t){this.latVal=t}get f(){return this.form.controls}submit(){this.form.patchValue({fullAddress:this.address,county:this.county,longitude:this.lngVal,latitude:this.latVal,gallery:this.images,uploader_id:this.auth.userData.uid,uploaded:this.auth.ts,uploader_photoURL:this.auth.userData.photoURL,uploader_displayName:this.auth.userData.displayName}),this.auth.createListing(this.form.value)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(Pt),e.Y36(Rt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-submit-land"]],viewQuery:function(t,s){if(1&t&&e.Gf(Qf,5),2&t){let r;e.iGM(r=e.CRH())&&(s.lat=r.first)}},inputs:{fileUpload:"fileUpload"},decls:172,vars:18,consts:[[1,"section"],[1,"container"],[1,"row"],[1,"col-md-4"],["id","submitListingTab","role","tablist",1,"nav","nav-tabs","tab-cards"],[1,"nav-item"],["id","basic-info-tab","data-toggle","tab","href","#basic-info","role","tab","aria-controls","basic-info","aria-selected","true",1,"nav-link","active"],["id","gallery-tab","data-toggle","tab","href","#gallery","role","tab","aria-controls","gallery","aria-selected","false",1,"nav-link"],["id","location-tab","data-toggle","tab","href","#location","role","tab","aria-controls","location","aria-selected","false",1,"nav-link"],["id","features-tab","data-toggle","tab","href","#features","role","tab","aria-controls","features","aria-selected","false",1,"nav-link"],[1,"col-md-8"],[3,"formGroup","ngSubmit"],["id","submitListingTabContent",1,"tab-content","m-0"],["id","basic-info","role","tabpanel","aria-labelledby","basic-info-tab",1,"tab-pane","fade","show","active"],[1,"col-md-12","form-group"],["formControlName","description","rows","4","placeholder","Property Description",1,"form-control"],["style","color: red;",4,"ngIf"],[1,"col-md-6","form-group"],["formControlName","name","type","text","placeholder","Property Name","name","name","value","",1,"form-control"],["formControlName","status","name","status",1,"form-control"],["value","residential"],["value","commercial"],[1,"col-md-6"],["formControlName","type","name","type",1,"form-control"],["value","land_lease"],["value","land_sale"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["formControlName","price","type","number","name","price","placeholder","Property Price",1,"form-control"],["formControlName","size","type","number","placeholder","Property Space (Sqft)","name","space","value","",1,"form-control"],["id","gallery","role","tabpanel","aria-labelledby","gallery-tab",1,"tab-pane","fade"],[1,"title",2,"margin-top","0%","margin-bottom","4%"],[1,"acr-form-notice"],[1,"my-3"],[1,"my-2"],[1,"card"],[1,"card-header"],[1,"list-group","list-group-flush",2,"overflow-y","auto","max-height","50vh"],["class","list-group-item",4,"ngFor","ngForOf"],["id","location","role","tabpanel","aria-labelledby","location-tab",1,"tab-pane","fade"],[1,"form-group","submit-listing-map"],["id","mapEl"],["mapEl",""],[1,"form-group"],["formControlName","fullAddress","type","text","name","address","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","county","type","text","name","county","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","longitude","type","text","name","lng","id","lngVal","placeholder","Longitude",1,"form-control",3,"value"],["formControlName","latitude","type","text","name","lat","id","latVal","placeholder","Latitude",1,"form-control",3,"value"],["lat",""],["id","features","role","tabpanel","aria-labelledby","features-tab",1,"tab-pane","fade"],[1,"col-lg-4","col-md-6","col-sm-6"],[1,"acr-listing-feature"],["formControlName","title_deed","type","checkbox","name","feature1","value",""],[1,"acr-feature-check","fas","fa-check"],[1,"acr-listing-feature-icon","flaticon-blog"],["formControlName","electricity","type","checkbox","name","feature2","value",""],[1,"acr-listing-feature-icon","flaticon-ceiling-light"],["formControlName","water","type","checkbox","name","feature3","value",""],[1,"acr-listing-feature-icon","flaticon-sink"],["formControlName","fenced","type","checkbox","name","feature4","value",""],[1,"acr-listing-feature-icon","flaticon-key"],["formControlName","next_to_road","type","checkbox","name","feature5","value",""],[1,"acr-listing-feature-icon","flaticon-garage"],["formControlName","view","type","checkbox","name","feature6","value",""],[1,"acr-listing-feature-icon","flaticon-eye"],[1,"custom-control","custom-checkbox"],["formControlName","terms","type","checkbox","id","termsAndConditions",1,"custom-control-input"],["for","termsAndConditions",1,"custom-control-label"],["type","submit","name","submit",1,"btn-custom",3,"disabled"],[2,"color","red"],[4,"ngIf"],[1,"list-group-item"],[1,"col-sm-4"],["alt","","srcset","",2,"display","block","max-width","230px","max-height","95px","width","auto","height","auto","border-radius","8px","border","1px solid lightgrey","image-rendering","auto","image-rendering","crisp-edges","image-rendering","pixelated","/* safari seems to support, but seems deprecated and does the same thing as the others. */\n                            image-rendering","-webkit-optimize-contrast",3,"src"],[1,"col-sm-5"],[3,"href"],[2,"font-size","10px","color","lightgray!important"],[1,"col-sm-1"],[1,"form-check","form-check-inline"],["type","checkbox","id","inlineCheckbox1","value","option1",1,"form-check-input",3,"change"],[1,"col-sm-2"],[1,"btn","btn-danger","btn-sm",2,"float","right",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6)(7,"span"),e._uU(8,"01"),e.qZA(),e._uU(9," Basic Information"),e.qZA()(),e.TgZ(10,"li",5)(11,"a",7)(12,"span"),e._uU(13,"02"),e.qZA(),e._uU(14," Gallery"),e.qZA()(),e.TgZ(15,"li",5)(16,"a",8)(17,"span"),e._uU(18,"03"),e.qZA(),e._uU(19," Location"),e.qZA()(),e.TgZ(20,"li",5)(21,"a",9)(22,"span"),e._uU(23,"04"),e.qZA(),e._uU(24," Features"),e.qZA()()()(),e.TgZ(25,"div",10)(26,"form",11),e.NdJ("ngSubmit",function(){return s.submit()}),e.TgZ(27,"div",12)(28,"div",13)(29,"div",2)(30,"div",14)(31,"label"),e._uU(32,"Property Description"),e.qZA(),e._UZ(33,"textarea",15),e.YNc(34,Vf,2,1,"div",16),e.qZA(),e.TgZ(35,"div",17)(36,"label"),e._uU(37,"Property Name"),e.qZA(),e._UZ(38,"input",18),e.YNc(39,Bf,2,1,"div",16),e.qZA(),e.TgZ(40,"div",17)(41,"label"),e._uU(42,"Property Status"),e.qZA(),e.TgZ(43,"select",19)(44,"option",20),e._uU(45,"Residential"),e.qZA(),e.TgZ(46,"option",21),e._uU(47,"Commercial"),e.qZA()(),e.YNc(48,Wf,2,1,"div",16),e.qZA(),e.TgZ(49,"div",22)(50,"label"),e._uU(51,"Property Type"),e.qZA(),e.TgZ(52,"select",23)(53,"option",24),e._uU(54,"Land For Lease"),e.qZA(),e.TgZ(55,"option",25),e._uU(56,"Land For Sale"),e.qZA()(),e.YNc(57,Gf,2,1,"div",16),e.qZA(),e.TgZ(58,"div",17)(59,"label"),e._uU(60,"Property Price"),e.qZA(),e.TgZ(61,"div",26)(62,"div",27)(63,"span",28),e._uU(64,"Kes"),e.qZA()(),e._UZ(65,"input",29),e.qZA(),e.YNc(66,Kf,2,1,"div",16),e.qZA(),e.TgZ(67,"div",14)(68,"label"),e._uU(69,"Property Space (Acres)"),e.qZA(),e._UZ(70,"input",30),e.YNc(71,Xf,2,1,"div",16),e.qZA()()(),e.TgZ(72,"div",31)(73,"div")(74,"h4",32),e._uU(75," Pick and/or upload images of the property "),e.qZA(),e.TgZ(76,"span",33),e._uU(77,"*You can upload up only up to 5 images for your listing"),e.qZA(),e.TgZ(78,"span",33),e._uU(79,"*Your images should have a height below 600px"),e.qZA(),e.TgZ(80,"span",33),e._uU(81,"*Your first upload will serve as the thumbnail for the "),e.qZA(),e.TgZ(82,"span",33),e._uU(83,"*Listing images should be atleast 620x480 in dimensions"),e.qZA()(),e.TgZ(84,"div",34),e._UZ(85,"app-upload-form"),e.qZA(),e.TgZ(86,"div",35)(87,"div",36)(88,"div",37),e._uU(89,"List of Files"),e.qZA(),e.TgZ(90,"ul",38),e.YNc(91,ep,17,6,"li",39),e.qZA()()()(),e.TgZ(92,"div",40)(93,"div",41),e._UZ(94,"div",42,43),e.qZA(),e.TgZ(96,"div",44)(97,"span",33),e._uU(98,"Drag and drop the marker to identify your "),e.TgZ(99,"b"),e._uU(100,"Latitude"),e.qZA(),e._uU(101," and "),e.TgZ(102,"b"),e._uU(103,"Longitude"),e.qZA()()(),e.TgZ(104,"div",2)(105,"div",14)(106,"label"),e._uU(107,"Full Address"),e.qZA(),e._UZ(108,"input",45),e.YNc(109,np,2,1,"div",16),e.qZA(),e.TgZ(110,"div",14)(111,"label"),e._uU(112,"County"),e.qZA(),e._UZ(113,"input",46),e.YNc(114,sp,2,1,"div",16),e.qZA(),e.TgZ(115,"div",17)(116,"label"),e._uU(117,"Longitude"),e.qZA(),e._UZ(118,"input",47),e.YNc(119,op,2,1,"div",16),e.qZA(),e.TgZ(120,"div",17)(121,"label"),e._uU(122,"Latitude"),e.qZA(),e._UZ(123,"input",48,49),e.YNc(125,lp,2,1,"div",16),e.qZA()()(),e.TgZ(126,"div",50)(127,"div",2)(128,"div",51)(129,"label",52),e._UZ(130,"input",53)(131,"i",54)(132,"i",55),e._uU(133," Ready Title Deed "),e.qZA()(),e.TgZ(134,"div",51)(135,"label",52),e._UZ(136,"input",56)(137,"i",54)(138,"i",57),e._uU(139," Electricity Avaliable "),e.qZA()(),e.TgZ(140,"div",51)(141,"label",52),e._UZ(142,"input",58)(143,"i",54)(144,"i",59),e._uU(145," Water Avalaible "),e.qZA()(),e.TgZ(146,"div",51)(147,"label",52),e._UZ(148,"input",60)(149,"i",54)(150,"i",61),e._uU(151," Fenced "),e.qZA()(),e.TgZ(152,"div",51)(153,"label",52),e._UZ(154,"input",62)(155,"i",54)(156,"i",63),e._uU(157," Next to Road "),e.qZA()(),e.TgZ(158,"div",51)(159,"label",52),e._UZ(160,"input",64)(161,"i",54)(162,"i",65),e._uU(163," City View "),e.qZA()()(),e.TgZ(164,"div",44)(165,"div",66),e._UZ(166,"input",67),e.TgZ(167,"label",68),e._uU(168,"I Agree to the terms & Conditions of Property Submission"),e.qZA()(),e.YNc(169,up,2,1,"div",16),e.qZA(),e.TgZ(170,"button",69),e._uU(171,"Submit Listing"),e.qZA()()()()()()()()),2&t&&(e.xp6(26),e.Q6J("formGroup",s.form),e.xp6(8),e.Q6J("ngIf",s.f.description.touched&&s.f.description.invalid),e.xp6(5),e.Q6J("ngIf",s.f.name.touched&&s.f.name.invalid),e.xp6(9),e.Q6J("ngIf",s.f.status.touched&&s.f.status.invalid),e.xp6(9),e.Q6J("ngIf",s.f.type.touched&&s.f.type.invalid),e.xp6(9),e.Q6J("ngIf",s.f.price.touched&&s.f.price.invalid),e.xp6(5),e.Q6J("ngIf",s.f.size.touched&&s.f.size.invalid),e.xp6(20),e.Q6J("ngForOf",s.fileUploads),e.xp6(17),e.s9C("value",s.address),e.xp6(1),e.Q6J("ngIf",s.f.fullAddress.touched&&s.f.fullAddress.invalid),e.xp6(4),e.s9C("value",s.county),e.xp6(1),e.Q6J("ngIf",s.f.county.touched&&s.f.county.invalid),e.xp6(4),e.Q6J("value",s.lngVal),e.xp6(1),e.Q6J("ngIf",s.f.longitude.touched&&s.f.longitude.invalid),e.xp6(4),e.Q6J("value",s.latVal),e.xp6(2),e.Q6J("ngIf",s.f.latitude.touched&&s.f.latitude.invalid),e.xp6(44),e.Q6J("ngIf",s.f.terms.touched&&s.f.terms.invalid),e.xp6(1),e.Q6J("disabled",s.form.invalid))},directives:[h._Y,h.JL,h.sg,h.Fj,h.JJ,h.u,A.O5,h.EJ,h.YN,h.Kr,h.wV,Ki,A.sg,h.Wl],pipes:[A.uU],styles:[""]}),i})();const hp=["lat"];function fp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Description is required."),e.qZA()())}function pp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,fp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.description.errors&&t.f.description.errors.required)}}function gp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Name is required."),e.qZA()())}function _p(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,gp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.name.errors&&t.f.name.errors.required)}}function mp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Accomodation no. is required."),e.qZA()())}function vp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,mp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.accomodate.errors&&t.f.accomodate.errors.required)}}function yp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Type is required."),e.qZA()())}function bp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,yp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.type.errors&&t.f.type.errors.required)}}function Cp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Price is required."),e.qZA()())}function Tp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,Cp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.price.errors&&t.f.price.errors.required)}}function Zp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Size is required."),e.qZA()())}function Ap(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,Zp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.size.errors&&t.f.size.errors.required)}}function wp(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"li",70)(1,"div",2)(2,"div",71),e._UZ(3,"img",72),e.qZA(),e.TgZ(4,"div",73)(5,"a",74),e._uU(6),e._UZ(7,"br"),e.TgZ(8,"small",75),e._uU(9),e.ALo(10,"date"),e.qZA()()(),e.TgZ(11,"div",76)(12,"div",77)(13,"input",78),e.NdJ("change",function(){const o=e.CHM(t).$implicit;return e.oxw().include(o)}),e.qZA()()(),e.TgZ(14,"div",79)(15,"button",80),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw().deleteFileUpload(o)}),e._uU(16," Delete "),e.qZA()()()()}if(2&i){const t=n.$implicit;e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(2),e.s9C("href",t.url,e.LSH),e.xp6(1),e.hij("",t.name," "),e.xp6(3),e.hij("Uploaded ",e.lcZ(10,4,t.uploaded.toDate()),"")}}function xp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Full Address is required."),e.qZA()())}function Sp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,xp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fullAddress.errors&&t.f.fullAddress.errors.required)}}function Ep(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"County is required."),e.qZA()())}function Ip(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,Ep,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.county.errors&&t.f.county.errors.required)}}function Np(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Longitude is required."),e.qZA()())}function Up(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,Np,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.longitude.errors&&t.f.longitude.errors.required)}}function kp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Latitude is required."),e.qZA()())}function qp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,kp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.latitude.errors&&t.f.latitude.errors.required)}}function Lp(i,n){1&i&&(e.TgZ(0,"div")(1,"small"),e._uU(2,"Terms are required."),e.qZA()())}function Pp(i,n){if(1&i&&(e.TgZ(0,"div",68),e.YNc(1,Lp,3,0,"div",69),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.terms.errors&&t.f.terms.errors.required)}}let Rp=(()=>{class i{constructor(t,s,r){this.auth=t,this.mapServe=s,this.uploadService=r,this.images=[],this.form=new h.cw({description:new h.NI("",h.kI.required),name:new h.NI("",h.kI.required),type:new h.NI("",h.kI.required),price:new h.NI("",h.kI.required),size:new h.NI("",h.kI.required),gallery:new h.NI(""),fullAddress:new h.NI(""),county:new h.NI(""),longitude:new h.NI(""),latitude:new h.NI(""),generator:new h.NI(""),fibre:new h.NI(""),lift:new h.NI(""),aircon:new h.NI(""),parking:new h.NI(""),cctv:new h.NI(""),accomodate:new h.NI("",h.kI.required),terms:new h.NI("",h.kI.required),uploader_id:new h.NI(""),uploaded:new h.NI(""),uploader_photoURL:new h.NI(""),uploader_displayName:new h.NI("")}),this.form.patchValue({lngVal:this.lngVal,latVal:this.latVal,fullAddress:this.address,county:this.address}),this.uploadService.getFiles().subscribe(o=>{this.fileUploads=o})}ngOnInit(){}ngAfterViewInit(){R.accessToken=Se.N.mapbox.accessToken,this.map=new R.Map({style:"mapbox://styles/mapbox/light-v10",center:[36.82,-1.38],zoom:11.5,pitch:45,container:"mapEl",antialias:!0});var t=new R.Marker({draggable:!0}).setLngLat([36.82588315391189,-1.3848034891855718]).addTo(this.map);this.lngVal=36.82,this.latVal=1.38,t.on("dragend",()=>{var r=t.getLngLat();r=t.getLngLat(),this.latVal=r.lng,this.lngVal=r.lat,this.mapServe.getAddress(r.lng,r.lat).subscribe(o=>{this.address=o.features[0].place_name,this.county=o.features[0].context[1].text})}),this.map.on("load",()=>{for(var o,r=this.map.getStyle().layers,a=0;a<r.length;a++)if("symbol"===r[a].type){o=r[a].id;break}this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},o)}),console.log("user data",this.auth.userData)}deleteFileUpload(t){this.uploadService.deleteFile(t)}include(t){var s,r,o;if(this.imageExists(t.id)){const a=null===(s=this.images)||void 0===s?void 0:s.indexOf(t);-1!==a&&(null===(r=this.images)||void 0===r||r.splice(a,1))}else this.imageExists(t.id)||null===(o=this.images)||void 0===o||o.push(t)}imageExists(t){var s;return null===(s=this.images)||void 0===s?void 0:s.some(function(r){return r.id===t})}setLat(t){this.latVal=t}get f(){return this.form.controls}submit(){this.form.patchValue({fullAddress:this.address,county:this.county,longitude:this.lngVal,latitude:this.latVal,gallery:this.images,uploader_id:this.auth.userData.uid,uploaded:this.auth.ts,uploader_photoURL:this.auth.userData.photoURL,uploader_displayName:this.auth.userData.displayName}),this.auth.createListing(this.form.value)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(Pt),e.Y36(Rt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-submit-spaces"]],viewQuery:function(t,s){if(1&t&&e.Gf(hp,5),2&t){let r;e.iGM(r=e.CRH())&&(s.lat=r.first)}},inputs:{fileUpload:"fileUpload"},decls:168,vars:18,consts:[[1,"section"],[1,"container"],[1,"row"],[1,"col-md-4"],["id","submitListingTab","role","tablist",1,"nav","nav-tabs","tab-cards"],[1,"nav-item"],["id","basic-info-tab","data-toggle","tab","href","#basic-info","role","tab","aria-controls","basic-info","aria-selected","true",1,"nav-link","active"],["id","gallery-tab","data-toggle","tab","href","#gallery","role","tab","aria-controls","gallery","aria-selected","false",1,"nav-link"],["id","location-tab","data-toggle","tab","href","#location","role","tab","aria-controls","location","aria-selected","false",1,"nav-link"],["id","features-tab","data-toggle","tab","href","#features","role","tab","aria-controls","features","aria-selected","false",1,"nav-link"],[1,"col-md-8"],[3,"formGroup","ngSubmit"],["id","submitListingTabContent",1,"tab-content","m-0"],["id","basic-info","role","tabpanel","aria-labelledby","basic-info-tab",1,"tab-pane","fade","show","active"],[1,"col-md-12","form-group"],["formControlName","description","rows","4","placeholder","Property Description",1,"form-control"],["style","color: red;",4,"ngIf"],[1,"col-md-6","form-group"],["formControlName","name","type","text","placeholder","Property Name","name","name","value","",1,"form-control"],["formControlName","accomodate","type","number","placeholder","No. of people property can accomodate",1,"form-control"],[1,"col-md-6"],["formControlName","type","name","type",1,"form-control"],["value","office_space"],["value","event_spaces"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],["formControlName","price","type","number","name","price","placeholder","Property Price",1,"form-control"],["formControlName","size","type","number","placeholder","Property Space (Sqft)","name","space","value","",1,"form-control"],["id","gallery","role","tabpanel","aria-labelledby","gallery-tab",1,"tab-pane","fade"],[1,"title",2,"margin-top","0%","margin-bottom","4%"],[1,"acr-form-notice"],[1,"my-3"],[1,"my-2"],[1,"card"],[1,"card-header"],[1,"list-group","list-group-flush",2,"overflow-y","auto","max-height","50vh"],["class","list-group-item",4,"ngFor","ngForOf"],["id","location","role","tabpanel","aria-labelledby","location-tab",1,"tab-pane","fade"],[1,"form-group","submit-listing-map"],["id","mapEl"],["mapEl",""],[1,"form-group"],["formControlName","fullAddress","type","text","name","address","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","county","type","text","name","county","placeholder","Full Address",1,"form-control",3,"value"],["formControlName","longitude","type","text","name","lng","id","lngVal","placeholder","Longitude",1,"form-control",3,"value"],["formControlName","latitude","type","text","name","lat","id","latVal","placeholder","Latitude",1,"form-control",3,"value"],["lat",""],["id","features","role","tabpanel","aria-labelledby","features-tab",1,"tab-pane","fade"],[1,"col-lg-4","col-md-6","col-sm-6"],[1,"acr-listing-feature"],["formControlName","generator","type","checkbox","name","feature1","value",""],[1,"acr-feature-check","fas","fa-check"],[1,"acr-listing-feature-icon","flaticon-blog"],["formControlName","fibre","type","checkbox","name","feature2","value",""],[1,"acr-listing-feature-icon","flaticon-ceiling-light"],["formControlName","lift","type","checkbox","name","feature3","value",""],[1,"acr-listing-feature-icon","flaticon-sink"],["formControlName","aircon","type","checkbox","name","feature4","value",""],[1,"acr-listing-feature-icon","flaticon-key"],["formControlName","parking","type","checkbox","name","feature5","value",""],[1,"acr-listing-feature-icon","flaticon-garage"],["formControlName","cctv","type","checkbox","name","feature6","value",""],[1,"acr-listing-feature-icon","flaticon-eye"],[1,"custom-control","custom-checkbox"],["formControlName","terms","type","checkbox","id","termsAndConditions",1,"custom-control-input"],["for","termsAndConditions",1,"custom-control-label"],["type","submit","name","submit",1,"btn-custom",3,"disabled"],[2,"color","red"],[4,"ngIf"],[1,"list-group-item"],[1,"col-sm-4"],["alt","","srcset","",2,"display","block","max-width","230px","max-height","95px","width","auto","height","auto","border-radius","8px","border","1px solid lightgrey","image-rendering","auto","image-rendering","crisp-edges","image-rendering","pixelated","/* safari seems to support, but seems deprecated and does the same thing as the others. */\n                            image-rendering","-webkit-optimize-contrast",3,"src"],[1,"col-sm-5"],[3,"href"],[2,"font-size","10px","color","lightgray!important"],[1,"col-sm-1"],[1,"form-check","form-check-inline"],["type","checkbox","id","inlineCheckbox1","value","option1",1,"form-check-input",3,"change"],[1,"col-sm-2"],[1,"btn","btn-danger","btn-sm",2,"float","right",3,"click"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ul",4)(5,"li",5)(6,"a",6)(7,"span"),e._uU(8,"01"),e.qZA(),e._uU(9," Basic Information"),e.qZA()(),e.TgZ(10,"li",5)(11,"a",7)(12,"span"),e._uU(13,"02"),e.qZA(),e._uU(14," Gallery"),e.qZA()(),e.TgZ(15,"li",5)(16,"a",8)(17,"span"),e._uU(18,"03"),e.qZA(),e._uU(19," Location"),e.qZA()(),e.TgZ(20,"li",5)(21,"a",9)(22,"span"),e._uU(23,"04"),e.qZA(),e._uU(24," Features"),e.qZA()()()(),e.TgZ(25,"div",10)(26,"form",11),e.NdJ("ngSubmit",function(){return s.submit()}),e.TgZ(27,"div",12)(28,"div",13)(29,"div",2)(30,"div",14)(31,"label"),e._uU(32,"Property Description"),e.qZA(),e._UZ(33,"textarea",15),e.YNc(34,pp,2,1,"div",16),e.qZA(),e.TgZ(35,"div",17)(36,"label"),e._uU(37,"Property Name"),e.qZA(),e._UZ(38,"input",18),e.YNc(39,_p,2,1,"div",16),e.qZA(),e.TgZ(40,"div",17)(41,"label"),e._uU(42,"No. of people property can accomodate"),e.qZA(),e._UZ(43,"input",19),e.YNc(44,vp,2,1,"div",16),e.qZA(),e.TgZ(45,"div",20)(46,"label"),e._uU(47,"Property Type"),e.qZA(),e.TgZ(48,"select",21)(49,"option",22),e._uU(50,"Office Space"),e.qZA(),e.TgZ(51,"option",23),e._uU(52,"Event Space"),e.qZA()(),e.YNc(53,bp,2,1,"div",16),e.qZA(),e.TgZ(54,"div",17)(55,"label"),e._uU(56,"Property Price"),e.qZA(),e.TgZ(57,"div",24)(58,"div",25)(59,"span",26),e._uU(60,"Kes"),e.qZA()(),e._UZ(61,"input",27),e.qZA(),e.YNc(62,Tp,2,1,"div",16),e.qZA(),e.TgZ(63,"div",14)(64,"label"),e._uU(65,"Property Space (Acres)"),e.qZA(),e._UZ(66,"input",28),e.YNc(67,Ap,2,1,"div",16),e.qZA()()(),e.TgZ(68,"div",29)(69,"div")(70,"h4",30),e._uU(71," Pick and/or upload images of the property "),e.qZA(),e.TgZ(72,"span",31),e._uU(73,"*You can upload up only up to 5 images for your listing"),e.qZA(),e.TgZ(74,"span",31),e._uU(75,"*Your images should have a height below 600px"),e.qZA(),e.TgZ(76,"span",31),e._uU(77,"*Your first upload will serve as the thumbnail for the "),e.qZA(),e.TgZ(78,"span",31),e._uU(79,"*Listing images should be atleast 620x480 in dimensions"),e.qZA()(),e.TgZ(80,"div",32),e._UZ(81,"app-upload-form"),e.qZA(),e.TgZ(82,"div",33)(83,"div",34)(84,"div",35),e._uU(85,"List of Files"),e.qZA(),e.TgZ(86,"ul",36),e.YNc(87,wp,17,6,"li",37),e.qZA()()()(),e.TgZ(88,"div",38)(89,"div",39),e._UZ(90,"div",40,41),e.qZA(),e.TgZ(92,"div",42)(93,"span",31),e._uU(94,"Drag and drop the marker to identify your "),e.TgZ(95,"b"),e._uU(96,"Latitude"),e.qZA(),e._uU(97," and "),e.TgZ(98,"b"),e._uU(99,"Longitude"),e.qZA()()(),e.TgZ(100,"div",2)(101,"div",14)(102,"label"),e._uU(103,"Full Address"),e.qZA(),e._UZ(104,"input",43),e.YNc(105,Sp,2,1,"div",16),e.qZA(),e.TgZ(106,"div",14)(107,"label"),e._uU(108,"County"),e.qZA(),e._UZ(109,"input",44),e.YNc(110,Ip,2,1,"div",16),e.qZA(),e.TgZ(111,"div",17)(112,"label"),e._uU(113,"Longitude"),e.qZA(),e._UZ(114,"input",45),e.YNc(115,Up,2,1,"div",16),e.qZA(),e.TgZ(116,"div",17)(117,"label"),e._uU(118,"Latitude"),e.qZA(),e._UZ(119,"input",46,47),e.YNc(121,qp,2,1,"div",16),e.qZA()()(),e.TgZ(122,"div",48)(123,"div",2)(124,"div",49)(125,"label",50),e._UZ(126,"input",51)(127,"i",52)(128,"i",53),e._uU(129," Back up generator "),e.qZA()(),e.TgZ(130,"div",49)(131,"label",50),e._UZ(132,"input",54)(133,"i",52)(134,"i",55),e._uU(135," Fibre Internet "),e.qZA()(),e.TgZ(136,"div",49)(137,"label",50),e._UZ(138,"input",56)(139,"i",52)(140,"i",57),e._uU(141," Lift / Elevator "),e.qZA()(),e.TgZ(142,"div",49)(143,"label",50),e._UZ(144,"input",58)(145,"i",52)(146,"i",59),e._uU(147," Aircon "),e.qZA()(),e.TgZ(148,"div",49)(149,"label",50),e._UZ(150,"input",60)(151,"i",52)(152,"i",61),e._uU(153," Parking "),e.qZA()(),e.TgZ(154,"div",49)(155,"label",50),e._UZ(156,"input",62)(157,"i",52)(158,"i",63),e._uU(159," CCTV "),e.qZA()()(),e.TgZ(160,"div",42)(161,"div",64),e._UZ(162,"input",65),e.TgZ(163,"label",66),e._uU(164,"I Agree to the terms & Conditions of Property Submission"),e.qZA()(),e.YNc(165,Pp,2,1,"div",16),e.qZA(),e.TgZ(166,"button",67),e._uU(167,"Submit Listing"),e.qZA()()()()()()()()),2&t&&(e.xp6(26),e.Q6J("formGroup",s.form),e.xp6(8),e.Q6J("ngIf",s.f.description.touched&&s.f.description.invalid),e.xp6(5),e.Q6J("ngIf",s.f.name.touched&&s.f.name.invalid),e.xp6(5),e.Q6J("ngIf",s.f.accomodate.touched&&s.f.accomodate.invalid),e.xp6(9),e.Q6J("ngIf",s.f.type.touched&&s.f.type.invalid),e.xp6(9),e.Q6J("ngIf",s.f.price.touched&&s.f.price.invalid),e.xp6(5),e.Q6J("ngIf",s.f.size.touched&&s.f.size.invalid),e.xp6(20),e.Q6J("ngForOf",s.fileUploads),e.xp6(17),e.s9C("value",s.address),e.xp6(1),e.Q6J("ngIf",s.f.fullAddress.touched&&s.f.fullAddress.invalid),e.xp6(4),e.s9C("value",s.county),e.xp6(1),e.Q6J("ngIf",s.f.county.touched&&s.f.county.invalid),e.xp6(4),e.Q6J("value",s.lngVal),e.xp6(1),e.Q6J("ngIf",s.f.longitude.touched&&s.f.longitude.invalid),e.xp6(4),e.Q6J("value",s.latVal),e.xp6(2),e.Q6J("ngIf",s.f.latitude.touched&&s.f.latitude.invalid),e.xp6(44),e.Q6J("ngIf",s.f.terms.touched&&s.f.terms.invalid),e.xp6(1),e.Q6J("disabled",s.form.invalid))},directives:[h._Y,h.JL,h.sg,h.Fj,h.JJ,h.u,A.O5,h.wV,h.EJ,h.YN,h.Kr,Ki,A.sg,h.Wl],pipes:[A.uU],styles:[""]}),i})();const Op=["lat"],Oo=function(){return["/listings/submit-land"]},Do=function(){return["/listings/submit-homes"]},Mo=function(){return["/listings/submit-spaces"]},Mp=[{path:"",component:ts},{path:"grid",component:fa},{path:"list",component:ka},{path:"map",component:ts},{path:"submit-page",component:Wo,canActivate:[st.a]},{path:"submit",component:(()=>{class i{constructor(t,s,r){this.auth=t,this.mapServe=s,this.uploadService=r,this.images=[],this.form=new h.cw({description:new h.NI("",h.kI.required),name:new h.NI("",h.kI.required),status:new h.NI("",h.kI.required),type:new h.NI("",h.kI.required),price:new h.NI("",h.kI.required),size:new h.NI("",h.kI.required),gallery:new h.NI(""),fullAddress:new h.NI(""),county:new h.NI(""),longitude:new h.NI(""),latitude:new h.NI(""),title_deed:new h.NI(""),electricity:new h.NI(""),water:new h.NI(""),fenced:new h.NI(""),next_to_road:new h.NI(""),view:new h.NI(""),terms:new h.NI("",h.kI.required),uploader_id:new h.NI(""),uploaded:new h.NI(""),uploader_photoURL:new h.NI(""),uploader_displayName:new h.NI("")}),this.form.patchValue({lngVal:this.lngVal,latVal:this.latVal,fullAddress:this.address,county:this.address}),this.uploadService.getFiles().subscribe(o=>{this.fileUploads=o})}ngOnInit(){}ngAfterViewInit(){R.accessToken=Se.N.mapbox.accessToken,this.map=new R.Map({style:"mapbox://styles/mapbox/light-v10",center:[36.82,-1.38],zoom:11.5,pitch:45,container:"mapEl",antialias:!0});var t=new R.Marker({draggable:!0}).setLngLat([36.82588315391189,-1.3848034891855718]).addTo(this.map);this.lngVal=36.82,this.latVal=1.38,t.on("dragend",()=>{var r=t.getLngLat();r=t.getLngLat(),this.latVal=r.lng,this.lngVal=r.lat,this.mapServe.getAddress(r.lng,r.lat).subscribe(o=>{this.address=o.features[0].place_name,this.county=o.features[0].context[1].text})}),this.map.on("load",()=>{for(var o,r=this.map.getStyle().layers,a=0;a<r.length;a++)if("symbol"===r[a].type){o=r[a].id;break}this.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:15,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},o)}),console.log("user data",this.auth.userData)}deleteFileUpload(t){this.uploadService.deleteFile(t)}include(t){var s,r,o;if(this.imageExists(t.id)){const a=null===(s=this.images)||void 0===s?void 0:s.indexOf(t);-1!==a&&(null===(r=this.images)||void 0===r||r.splice(a,1))}else this.imageExists(t.id)||null===(o=this.images)||void 0===o||o.push(t)}imageExists(t){var s;return null===(s=this.images)||void 0===s?void 0:s.some(function(r){return r.id===t})}setLat(t){this.latVal=t}get f(){return this.form.controls}submit(){this.form.patchValue({fullAddress:this.address,county:this.county,longitude:this.lngVal,latitude:this.latVal,gallery:this.images,uploader_id:this.auth.userData.uid,uploaded:this.auth.ts,uploader_photoURL:this.auth.userData.photoURL,uploader_displayName:this.auth.userData.displayName}),this.auth.createListing(this.form.value)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_e.e),e.Y36(Pt),e.Y36(Rt))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-submit"]],viewQuery:function(t,s){if(1&t&&e.Gf(Op,5),2&t){let r;e.iGM(r=e.CRH())&&(s.lat=r.first)}},inputs:{fileUpload:"fileUpload"},decls:38,vars:12,consts:[[1,"section","section-padding"],[1,"container"],[1,"section-title-wrap","section-header"],[1,"custom-primary"],[1,"title"],[1,"row"],[1,"col-lg-4","col-md-6"],[1,"acr-category"],[1,"acr-category-thumb"],[1,"flaticon-company"],[3,"routerLink"],["src","./../../../assets/img/categories/duplex.jpg","alt","category"],[1,"acr-category-body"],[1,"flaticon-house"],["src","./../../../assets/img/categories/residential.jpg","alt","category"],[1,"flaticon-garage"],["src","./../../../assets/img/categories/commercial.jpg","alt","category"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),e._uU(4,"Categories"),e.qZA(),e.TgZ(5,"h2",4),e._uU(6,"Upload By Category"),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8),e._UZ(11,"i",9),e.TgZ(12,"a",10),e._UZ(13,"img",11),e.qZA(),e.TgZ(14,"div",12)(15,"h5")(16,"a",10),e._uU(17,"Land"),e.qZA()()()()()(),e.TgZ(18,"div",6)(19,"div",7)(20,"div",8),e._UZ(21,"i",13),e.TgZ(22,"a",10),e._UZ(23,"img",14),e.qZA(),e.TgZ(24,"div",12)(25,"h5")(26,"a",10),e._uU(27,"Homes"),e.qZA()()()()()(),e.TgZ(28,"div",6)(29,"div",7)(30,"div",8),e._UZ(31,"i",15),e.TgZ(32,"a",10),e._UZ(33,"img",16),e.qZA(),e.TgZ(34,"div",12)(35,"h5")(36,"a",10),e._uU(37,"Commercial Spaces"),e.qZA()()()()()()()()()),2&t&&(e.xp6(12),e.Q6J("routerLink",e.DdM(6,Oo)),e.xp6(4),e.Q6J("routerLink",e.DdM(7,Oo)),e.xp6(6),e.Q6J("routerLink",e.DdM(8,Do)),e.xp6(4),e.Q6J("routerLink",e.DdM(9,Do)),e.xp6(6),e.Q6J("routerLink",e.DdM(10,Mo)),e.xp6(4),e.Q6J("routerLink",e.DdM(11,Mo)))},directives:[ue.yS],styles:[""]}),i})(),canActivate:[st.a]},{path:"submit-land",component:dp,canActivate:[st.a]},{path:"submit-homes",component:Ff,canActivate:[st.a]},{path:"submit-spaces",component:Rp,canActivate:[st.a]},{path:"details/:id",component:Va}];let Fp=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[ue.Bz.forChild(Mp)],ue.Bz]}),i})();var Qp=y(4466);let Hp=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[Pt],imports:[[A.ez,Fp,Ro.JF,h.UX,Qp.m]]}),i})()}}]);